(()=>{"use strict";const o=function(o){let s=0,t=!1;return{shipLength:o,numberOfHits:s,isSunk:function(){return s>=o&&(t=!0,!0)},hit:function(){s+=1},coords:[],length:o,sunk:t}},s=function(o,s){let t=[],e=[],r=[[[" "],[" "],[" "],[" "],[" "],[" "],[" "],[" "],[" "],[" "]],[[" "],[" "],[" "],[" "],[" "],[" "],[" "],[" "],[" "],[" "]],[[" "],[" "],[" "],[" "],[" "],[" "],[" "],[" "],[" "],[" "]],[[" "],[" "],[" "],[" "],[" "],[" "],[" "],[" "],[" "],[" "]],[[" "],[" "],[" "],[" "],[" "],[" "],[" "],[" "],[" "],[" "]],[[" "],[" "],[" "],[" "],[" "],[" "],[" "],[" "],[" "],[" "]],[[" "],[" "],[" "],[" "],[" "],[" "],[" "],[" "],[" "],[" "]],[[" "],[" "],[" "],[" "],[" "],[" "],[" "],[" "],[" "],[" "]],[[" "],[" "],[" "],[" "],[" "],[" "],[" "],[" "],[" "],[" "]],[[" "],[" "],[" "],[" "],[" "],[" "],[" "],[" "],[" "],[" "]]];return{board:r,horizontal:function(o,s,t){for(let e=0;e<o.shipLength;e++){let r=[s,e+t];o.coords.push(r)}},vertical:function(o,s,t){for(let e=0;e<o.shipLength;e++){let r=[e+s,t];o.coords.push(r)}},missedCoords:[],currentShips:[],allSunk:function(){return 5==t.length&&(alert("DONE!"),!0)},getPotentialMoves:function(){for(let o=0;o<10;o++)for(let s=0;s<10;s++)e.push([s,o])},potentialMoves:e,removeAllInstances:function(o,s){for(let t=o.length;t--;)o[t][0]==s[0]&&o[t][1]==s[1]&&o.splice(t,1)},drawBoard:function(){const o=document.getElementsByClassName("container")[0];let s=document.createElement("div");s.classList.add("board-container"),o.appendChild(s);for(let o=0;o<r.length;o++)for(let t=0;t<r.length;t++){let e=document.createElement("div");e.classList.add("individual-square"),e.classList.add(t),e.classList.add(o),s.appendChild(e)," "!=r[o][t]&&e.classList.add("ship")}},drawComputerBoard:function(){const o=document.getElementsByClassName("container")[0];let s=document.createElement("div");s.classList.add("board-container"),o.appendChild(s);for(let o=0;o<r.length;o++)for(let t=0;t<r.length;t++){let e=document.createElement("div");e.classList.add("computer-square"),e.classList.add(t),e.classList.add(o),s.appendChild(e)}},sunkShips:t}},t=function(){let o=[];const s=function(o){let s=(t=o.potentialMoves.length-1,Math.floor(Math.random()*t));var t;let e=o.potentialMoves[s];return console.log("randattack"),e};return{name:"",randomAttack:s,getLegalMoves:function(s){o=[];for(let t=0;t<s.board.length;t++)for(let e=0;e<10;e++)" "==s.board[t][e]&&o.push([t,e])},randomAttack:s,checkMissedCoordsForMatch:function(o,s){let t=!1;availableMoves=[];for(let e=0;e<s.length;e++)o[0]==s[e][0]&&o[1]==s[e][1]?t=!0:availableMoves.push([o[0],o[1]]);return 1==t}}};(function(){let e=t();e.name="playerOne";let r=t();r.name="playerTwo";let n=s(),d=s();n.getPotentialMoves(),d.getPotentialMoves();let c=e;const a=function(o,s,t,r){let a=t[o[1]][o[0]];if(console.log(`coords = ${o}`),0==u(r,o))console.log("Retry bro");else{if(" "==a)c==e?d.missedCoords.push(o):n.missedCoords.push(o),console.log("miss"),i(s),h();else{let t=[];t.push(o[1]),t.push(o[0]),u(a.coords,t)&&(a.hit(),l(s),a.isSunk(),h(),a.isSunk()&&(shipSunk(a),sunkShips.push(a)),console.log("hit"),t=[])}u(r,o)&&function(o,s){for(let t=o.length;t--;)o[t][0]==s[0]&&o[t][1]==s[1]&&o.splice(t,1)}(r,o)}},u=function(o,s){let t=!1;return o.forEach((o=>{o[0]==s[0]&&o[1]==s[1]&&(t=!0)})),1==t},l=function(o){o.classList.add("hit")},i=function(o){o.classList.add("miss")},h=function(){c=c==e?r:e,console.log("swap"),console.log(c)},p=function(o){let s=o.classList,t=s[1],e="oops";return parseInt(s[2]),e=parseInt(s[2])>=0?s[2]:s[1],[t,e]};return{setUpGame:function(){!function(){const s=o(2);s.coords.push([0,0]),s.coords.push([0,1]),n.board[0][0]=s,n.board[0][1]=s;const t=o(3);t.coords.push([1,0]),t.coords.push([1,1]),t.coords.push([1,2]),n.board[1][0]=t,n.board[1][1]=t,n.board[1][2]=t;const e=o(3);e.coords.push([2,0]),e.coords.push([2,1]),e.coords.push([2,2]),n.board[2][0]=e,n.board[2][1]=e,n.board[2][2]=e;const r=o(4);r.coords.push([3,0]),r.coords.push([3,1]),r.coords.push([3,2]),r.coords.push([3,3]),n.board[3][0]=r,n.board[3][1]=r,n.board[3][2]=r,n.board[3][3]=r;const d=o(5);d.coords.push([4,0]),d.coords.push([4,1]),d.coords.push([4,2]),d.coords.push([4,3]),d.coords.push([4,4]),n.board[4][0]=d,n.board[4][1]=d,n.board[4][2]=d,n.board[4][3]=d,n.board[4][4]=d,n.currentShips.push(s),n.currentShips.push(t),n.currentShips.push(e),n.currentShips.push(r),n.currentShips.push(d)}(),function(){const s=o(2);s.coords.push([0,0]),s.coords.push([0,1]),d.board[0][0]=s,d.board[0][1]=s;const t=o(3);t.coords.push([1,0]),t.coords.push([1,1]),t.coords.push([1,2]),d.board[1][0]=t,d.board[1][1]=t,d.board[1][2]=t;const e=o(3);e.coords.push([2,0]),e.coords.push([2,1]),e.coords.push([2,2]),d.board[2][0]=e,d.board[2][1]=e,d.board[2][2]=e;const r=o(4);r.coords.push([3,0]),r.coords.push([3,1]),r.coords.push([3,2]),r.coords.push([3,3]),d.board[3][0]=r,d.board[3][1]=r,d.board[3][2]=r,d.board[3][3]=r;const n=o(5);n.coords.push([4,0]),n.coords.push([4,1]),n.coords.push([4,2]),n.coords.push([4,3]),n.coords.push([4,4]),d.board[4][0]=n,d.board[4][1]=n,d.board[4][2]=n,d.board[4][3]=n,d.board[4][4]=n,d.currentShips.push(s),d.currentShips.push(t),d.currentShips.push(e),d.currentShips.push(r),d.currentShips.push(n)}(),n.drawBoard(),d.drawComputerBoard(),function(){let o=document.getElementsByClassName("computer-square");for(let s=0;s<o.length;s++)o[s].addEventListener("click",(()=>{a(p(o[s]),o[s],d.board,d.potentialMoves)}))}()},p1Gameboard:n,p2Gameboard:d}})().setUpGame()})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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LGNBQ25DLEVDN09ha0MsR0FDUmhCLFciLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9iYXR0bGVzaGlwLy4vc3JjL3NoaXAuanMiLCJ3ZWJwYWNrOi8vYmF0dGxlc2hpcC8uL3NyYy9nYW1lQm9hcmQuanMiLCJ3ZWJwYWNrOi8vYmF0dGxlc2hpcC8uL3NyYy9wbGF5ZXIuanMiLCJ3ZWJwYWNrOi8vYmF0dGxlc2hpcC8uL3NyYy9nYW1lLmpzIiwid2VicGFjazovL2JhdHRsZXNoaXAvLi9zcmMvaW5kZXguanMiXSwic291cmNlc0NvbnRlbnQiOlsiY29uc3QgU2hpcCA9IGZ1bmN0aW9uIChsZW5ndGgpIHtcbiAgY29uc3Qgc2hpcExlbmd0aCA9IGxlbmd0aDtcbiAgbGV0IG51bWJlck9mSGl0cyA9IDA7XG4gIGxldCBzdW5rID0gZmFsc2U7XG4gIGxldCBjb29yZHMgPSBbXTtcblxuICBjb25zdCBoaXQgPSBmdW5jdGlvbiAoKSB7XG4gICAgbnVtYmVyT2ZIaXRzICs9IDE7XG4gIH07XG5cbiAgY29uc3QgaXNTdW5rID0gZnVuY3Rpb24gKCkge1xuICAgIGlmIChudW1iZXJPZkhpdHMgPj0gbGVuZ3RoKSB7XG4gICAgICBzdW5rID0gdHJ1ZTtcbiAgICAgIHJldHVybiB0cnVlO1xuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICB9O1xuXG4gIHJldHVybiB7IHNoaXBMZW5ndGgsIG51bWJlck9mSGl0cywgaXNTdW5rLCBoaXQsIGNvb3JkcywgbGVuZ3RoLCBzdW5rIH07XG59O1xuXG5leHBvcnQgeyBTaGlwIH07XG4iLCJjb25zdCBHYW1lQm9hcmQgPSBmdW5jdGlvbiAocGxheWVyT25lLCBwbGF5ZXJUd28pIHtcbiAgbGV0IHNoaXBQbGFjZW1lbnRNb2RlID0gXCJob3Jpem9udGFsXCI7XG4gIGxldCBjdXJyZW50U2hpcHMgPSBbXTtcbiAgbGV0IHN1bmtTaGlwcyA9IFtdO1xuICBjb25zdCBtaXNzZWRDb29yZHMgPSBbXTtcbiAgbGV0IHBvdGVudGlhbE1vdmVzID0gW107XG4gIGxldCBjdXJyZW50UGxheWVyID0gcGxheWVyT25lO1xuXG4gIGxldCBib2FyZCA9IFtcbiAgICBbW1wiIFwiXSwgW1wiIFwiXSwgW1wiIFwiXSwgW1wiIFwiXSwgW1wiIFwiXSwgW1wiIFwiXSwgW1wiIFwiXSwgW1wiIFwiXSwgW1wiIFwiXSwgW1wiIFwiXV0sXG4gICAgW1tcIiBcIl0sIFtcIiBcIl0sIFtcIiBcIl0sIFtcIiBcIl0sIFtcIiBcIl0sIFtcIiBcIl0sIFtcIiBcIl0sIFtcIiBcIl0sIFtcIiBcIl0sIFtcIiBcIl1dLFxuICAgIFtbXCIgXCJdLCBbXCIgXCJdLCBbXCIgXCJdLCBbXCIgXCJdLCBbXCIgXCJdLCBbXCIgXCJdLCBbXCIgXCJdLCBbXCIgXCJdLCBbXCIgXCJdLCBbXCIgXCJdXSxcbiAgICBbW1wiIFwiXSwgW1wiIFwiXSwgW1wiIFwiXSwgW1wiIFwiXSwgW1wiIFwiXSwgW1wiIFwiXSwgW1wiIFwiXSwgW1wiIFwiXSwgW1wiIFwiXSwgW1wiIFwiXV0sXG4gICAgW1tcIiBcIl0sIFtcIiBcIl0sIFtcIiBcIl0sIFtcIiBcIl0sIFtcIiBcIl0sIFtcIiBcIl0sIFtcIiBcIl0sIFtcIiBcIl0sIFtcIiBcIl0sIFtcIiBcIl1dLFxuICAgIFtbXCIgXCJdLCBbXCIgXCJdLCBbXCIgXCJdLCBbXCIgXCJdLCBbXCIgXCJdLCBbXCIgXCJdLCBbXCIgXCJdLCBbXCIgXCJdLCBbXCIgXCJdLCBbXCIgXCJdXSxcbiAgICBbW1wiIFwiXSwgW1wiIFwiXSwgW1wiIFwiXSwgW1wiIFwiXSwgW1wiIFwiXSwgW1wiIFwiXSwgW1wiIFwiXSwgW1wiIFwiXSwgW1wiIFwiXSwgW1wiIFwiXV0sXG4gICAgW1tcIiBcIl0sIFtcIiBcIl0sIFtcIiBcIl0sIFtcIiBcIl0sIFtcIiBcIl0sIFtcIiBcIl0sIFtcIiBcIl0sIFtcIiBcIl0sIFtcIiBcIl0sIFtcIiBcIl1dLFxuICAgIFtbXCIgXCJdLCBbXCIgXCJdLCBbXCIgXCJdLCBbXCIgXCJdLCBbXCIgXCJdLCBbXCIgXCJdLCBbXCIgXCJdLCBbXCIgXCJdLCBbXCIgXCJdLCBbXCIgXCJdXSxcbiAgICBbW1wiIFwiXSwgW1wiIFwiXSwgW1wiIFwiXSwgW1wiIFwiXSwgW1wiIFwiXSwgW1wiIFwiXSwgW1wiIFwiXSwgW1wiIFwiXSwgW1wiIFwiXSwgW1wiIFwiXV0sXG4gIF07XG5cbiAgY29uc3QgZ2V0UG90ZW50aWFsTW92ZXMgPSBmdW5jdGlvbiAoKSB7XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCAxMDsgaSsrKSB7XG4gICAgICBmb3IgKGxldCBhID0gMDsgYSA8IDEwOyBhKyspIHtcbiAgICAgICAgcG90ZW50aWFsTW92ZXMucHVzaChbYSwgaV0pO1xuICAgICAgfVxuICAgIH1cbiAgfTtcblxuICAvLyBjb25zdCBzZXRVcENsaWNrVG9IaXQgPSBmdW5jdGlvbiAoKSB7XG4gIC8vICAgbGV0IHNxdWFyZXMgPSBkb2N1bWVudC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKFwiY29tcHV0ZXItc3F1YXJlXCIpO1xuICAvLyAgIGZvciAobGV0IGkgPSAwOyBpIDwgc3F1YXJlcy5sZW5ndGg7IGkrKykge1xuICAvLyAgICAgc3F1YXJlc1tpXS5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICAvLyAgICAgICByZWNlaXZlQXR0YWNrKGNsYXNzVG9Db29yZHMoc3F1YXJlc1tpXSksIHNxdWFyZXNbaV0pO1xuICAvLyAgICAgfSk7XG4gIC8vICAgfVxuICAvLyB9O1xuXG4gIC8vIGNvbnN0IGRpc2FibGVDbGljayA9IGZ1bmN0aW9uICgpIHtcbiAgLy8gICBsZXQgc3F1YXJlcyA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoXCJjb21wdXRlci1zcXVhcmVcIik7XG4gIC8vICAgZm9yIChsZXQgaSA9IDA7IGkgPCBzcXVhcmVzLmxlbmd0aDsgaSsrKSB7XG4gIC8vICAgICBzcXVhcmVzW2ldLmNsYXNzTGlzdC5hZGQoXCJkaXNhYmxlZFwiKTtcbiAgLy8gICB9XG4gIC8vIH07XG5cbiAgLy8gY29uc3QgZW5hYmxlQ2xpY2sgPSBmdW5jdGlvbiAoKSB7XG4gIC8vICAgbGV0IHNxdWFyZXMgPSBkb2N1bWVudC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKFwiY29tcHV0ZXItc3F1YXJlXCIpO1xuICAvLyAgIGZvciAobGV0IGkgPSAwOyBpIDwgc3F1YXJlcy5sZW5ndGg7IGkrKykge1xuICAvLyAgICAgc3F1YXJlc1tpXS5jbGFzc0xpc3QucmVtb3ZlKFwiZGlzYWJsZWRcIik7XG4gIC8vICAgfVxuICAvLyB9O1xuXG4gIGNvbnN0IGhvcml6b250YWwgPSBmdW5jdGlvbiAoc2hpcCwgc3RhcnRSb3dDb29yZHMsIHN0YXJ0Q29sdW1uQ29vcmRzKSB7XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBzaGlwLnNoaXBMZW5ndGg7IGkrKykge1xuICAgICAgbGV0IGN1cnJlbnRDb29yZCA9IFtzdGFydFJvd0Nvb3JkcywgaSArIHN0YXJ0Q29sdW1uQ29vcmRzXTtcbiAgICAgIHNoaXAuY29vcmRzLnB1c2goY3VycmVudENvb3JkKTtcbiAgICB9XG4gIH07XG5cbiAgY29uc3QgdmVydGljYWwgPSBmdW5jdGlvbiAoc2hpcCwgc3RhcnRSb3dDb29yZHMsIHN0YXJ0Q29sdW1uQ29vcmRzKSB7XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBzaGlwLnNoaXBMZW5ndGg7IGkrKykge1xuICAgICAgbGV0IGN1cnJlbnRDb29yZCA9IFtpICsgc3RhcnRSb3dDb29yZHMsIHN0YXJ0Q29sdW1uQ29vcmRzXTtcbiAgICAgIHNoaXAuY29vcmRzLnB1c2goY3VycmVudENvb3JkKTtcbiAgICB9XG4gIH07XG5cbiAgY29uc3QgcGxhY2VTaGlwID0gZnVuY3Rpb24gKHNoaXApIHtcbiAgICBzaGlwLmNvb3Jkcy5mb3JFYWNoKChjb29yZCkgPT4ge1xuICAgICAgbGV0IG91dGVyID0gY29vcmRbMF07XG4gICAgICBsZXQgaW5uZXIgPSBjb29yZFsxXTtcbiAgICAgIGJvYXJkW291dGVyXVtpbm5lcl0gPSBzaGlwO1xuICAgIH0pO1xuICB9O1xuXG4gIGNvbnN0IHNldFNoaXBQb3NpdGlvbiA9IGZ1bmN0aW9uIChzaGlwLCBzdGFydFJvd0Nvb3Jkcywgc3RhcnRDb2x1bW5Db29yZHMpIHtcbiAgICBpZiAoc2hpcFBsYWNlbWVudE1vZGUgPT0gXCJob3Jpem9udGFsXCIpIHtcbiAgICAgIGhvcml6b250YWwoc2hpcCwgc3RhcnRSb3dDb29yZHMsIHN0YXJ0Q29sdW1uQ29vcmRzKTtcbiAgICB9IGVsc2UgaWYgKHNoaXBQbGFjZW1lbnRNb2RlID09IFwidmVydGljYWxcIikge1xuICAgICAgdmVydGljYWwoc2hpcCwgc3RhcnRSb3dDb29yZHMsIHN0YXJ0Q29sdW1uQ29vcmRzKTtcbiAgICB9XG4gIH07XG5cbiAgZnVuY3Rpb24gcmVtb3ZlQWxsSW5zdGFuY2VzKGFyciwgaXRlbSkge1xuICAgIGZvciAobGV0IGkgPSBhcnIubGVuZ3RoOyBpLS07ICkge1xuICAgICAgaWYgKGFycltpXVswXSA9PSBpdGVtWzBdICYmIGFycltpXVsxXSA9PSBpdGVtWzFdKSBhcnIuc3BsaWNlKGksIDEpO1xuICAgIH1cbiAgfVxuXG4gIGNvbnN0IHNoaXBTdW5rID0gZnVuY3Rpb24gKHNoaXApIHtcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IHNoaXAuY29vcmRzLmxlbmd0aDsgaSsrKSB7XG4gICAgICBsZXQgeCA9IHNoaXAuY29vcmRzW2ldWzBdO1xuICAgICAgbGV0IHkgPSBzaGlwLmNvb3Jkc1tpXVsxXTtcbiAgICB9XG4gIH07XG5cbiAgY29uc3QgYWxsU3VuayA9IGZ1bmN0aW9uICgpIHtcbiAgICBpZiAoc3Vua1NoaXBzLmxlbmd0aCA9PSA1KSB7XG4gICAgICBhbGVydChcIkRPTkUhXCIpO1xuICAgICAgcmV0dXJuIHRydWU7XG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gIH07XG5cbiAgY29uc3QgZHJhd0JvYXJkID0gZnVuY3Rpb24gKCkge1xuICAgIGNvbnN0IGNvbnRhaW5lciA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoXCJjb250YWluZXJcIilbMF07XG4gICAgbGV0IGJvYXJkQ29udGFpbmVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcbiAgICBib2FyZENvbnRhaW5lci5jbGFzc0xpc3QuYWRkKFwiYm9hcmQtY29udGFpbmVyXCIpO1xuICAgIGNvbnRhaW5lci5hcHBlbmRDaGlsZChib2FyZENvbnRhaW5lcik7XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBib2FyZC5sZW5ndGg7IGkrKykge1xuICAgICAgZm9yIChsZXQgYSA9IDA7IGEgPCBib2FyZC5sZW5ndGg7IGErKykge1xuICAgICAgICBsZXQgaW5kaXZpZHVhbFNxdWFyZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XG4gICAgICAgIGluZGl2aWR1YWxTcXVhcmUuY2xhc3NMaXN0LmFkZChcImluZGl2aWR1YWwtc3F1YXJlXCIpO1xuICAgICAgICBpbmRpdmlkdWFsU3F1YXJlLmNsYXNzTGlzdC5hZGQoYSk7IC8vIHhcbiAgICAgICAgaW5kaXZpZHVhbFNxdWFyZS5jbGFzc0xpc3QuYWRkKGkpOyAvLyB5XG4gICAgICAgIGJvYXJkQ29udGFpbmVyLmFwcGVuZENoaWxkKGluZGl2aWR1YWxTcXVhcmUpO1xuICAgICAgICBpZiAoYm9hcmRbaV1bYV0gIT0gXCIgXCIpIHtcbiAgICAgICAgICBpbmRpdmlkdWFsU3F1YXJlLmNsYXNzTGlzdC5hZGQoXCJzaGlwXCIpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICB9O1xuXG4gIGNvbnN0IGRyYXdDb21wdXRlckJvYXJkID0gZnVuY3Rpb24gKCkge1xuICAgIGNvbnN0IGNvbnRhaW5lciA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoXCJjb250YWluZXJcIilbMF07XG4gICAgbGV0IGJvYXJkQ29udGFpbmVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcbiAgICBib2FyZENvbnRhaW5lci5jbGFzc0xpc3QuYWRkKFwiYm9hcmQtY29udGFpbmVyXCIpO1xuICAgIGNvbnRhaW5lci5hcHBlbmRDaGlsZChib2FyZENvbnRhaW5lcik7XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBib2FyZC5sZW5ndGg7IGkrKykge1xuICAgICAgZm9yIChsZXQgYSA9IDA7IGEgPCBib2FyZC5sZW5ndGg7IGErKykge1xuICAgICAgICBsZXQgaW5kaXZpZHVhbFNxdWFyZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XG4gICAgICAgIGluZGl2aWR1YWxTcXVhcmUuY2xhc3NMaXN0LmFkZChcImNvbXB1dGVyLXNxdWFyZVwiKTtcbiAgICAgICAgaW5kaXZpZHVhbFNxdWFyZS5jbGFzc0xpc3QuYWRkKGEpOyAvLyB4XG4gICAgICAgIGluZGl2aWR1YWxTcXVhcmUuY2xhc3NMaXN0LmFkZChpKTsgLy8geVxuICAgICAgICBib2FyZENvbnRhaW5lci5hcHBlbmRDaGlsZChpbmRpdmlkdWFsU3F1YXJlKTtcbiAgICAgIH1cbiAgICB9XG4gIH07XG5cbiAgcmV0dXJuIHtcbiAgICBib2FyZCxcbiAgICBob3Jpem9udGFsLFxuICAgIHZlcnRpY2FsLFxuICAgIG1pc3NlZENvb3JkcyxcbiAgICBjdXJyZW50U2hpcHMsXG4gICAgYWxsU3VuayxcbiAgICBnZXRQb3RlbnRpYWxNb3ZlcyxcbiAgICBwb3RlbnRpYWxNb3ZlcyxcbiAgICByZW1vdmVBbGxJbnN0YW5jZXMsXG4gICAgZHJhd0JvYXJkLFxuICAgIGRyYXdDb21wdXRlckJvYXJkLFxuICAgIHN1bmtTaGlwcyxcbiAgfTtcbn07XG5cbmV4cG9ydCB7IEdhbWVCb2FyZCB9O1xuXG4vLyBjb25zdCBjaGVja05lc3RlZEFycmF5ID0gZnVuY3Rpb24gKGFycmF5LCBjb29yZHMpIHtcbi8vICAgbGV0IG1hdGNoID0gZmFsc2U7XG4vLyAgIGZvciAobGV0IGkgPSAwOyBpIDwgYXJyYXkubGVuZ3RoOyBpKyspIHtcbi8vICAgICBpZiAoYXJyYXlbaV0uaW5jbHVkZXMoY29vcmRzWzBdKSAmJiBhcnJheVtpXS5pbmNsdWRlcyhjb29yZHNbMV0pKSB7XG4vLyAgICAgICBtYXRjaCA9IHRydWU7XG4vLyAgICAgfVxuLy8gICB9XG4vLyAgIHJldHVybiBtYXRjaDtcbi8vIH07XG4iLCJpbXBvcnQgeyBHYW1lQm9hcmQgfSBmcm9tIFwiLi9nYW1lQm9hcmRcIjtcblxuY29uc3QgUGxheWVyID0gZnVuY3Rpb24gKCkge1xuICBjb25zdCBuYW1lID0gXCJcIjtcbiAgbGV0IGxlZ2FsTW92ZXMgPSBbXTtcbiAgLy8gbGV0IHByZXZpb3VzTW92ZXMgPSBbXTtcbiAgLy8gbGV0IGF2YWlsYWJsZU1vdmVzID0gW107XG5cbiAgY29uc3QgZ2V0TGVnYWxNb3ZlcyA9IGZ1bmN0aW9uIChvcHBvbmVudEdhbWVib2FyZCkge1xuICAgIGxlZ2FsTW92ZXMgPSBbXTtcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IG9wcG9uZW50R2FtZWJvYXJkLmJvYXJkLmxlbmd0aDsgaSsrKSB7XG4gICAgICBmb3IgKGxldCBhID0gMDsgYSA8IDEwOyBhKyspIHtcbiAgICAgICAgaWYgKG9wcG9uZW50R2FtZWJvYXJkLmJvYXJkW2ldW2FdID09IFwiIFwiKSB7XG4gICAgICAgICAgbGVnYWxNb3Zlcy5wdXNoKFtpLCBhXSk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gIH07XG5cbiAgY29uc3QgY2hlY2tNaXNzZWRDb29yZHNGb3JNYXRjaCA9IGZ1bmN0aW9uIChcbiAgICBjb29yZHMsXG4gICAgb3Bwb25lbnRHYW1lYm9hcmRNaXNzZWRDb29yZHNBcnJheVxuICApIHtcbiAgICBsZXQgbWF0Y2ggPSBmYWxzZTtcbiAgICBhdmFpbGFibGVNb3ZlcyA9IFtdO1xuXG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBvcHBvbmVudEdhbWVib2FyZE1pc3NlZENvb3Jkc0FycmF5Lmxlbmd0aDsgaSsrKSB7XG4gICAgICBpZiAoXG4gICAgICAgIGNvb3Jkc1swXSA9PSBvcHBvbmVudEdhbWVib2FyZE1pc3NlZENvb3Jkc0FycmF5W2ldWzBdICYmXG4gICAgICAgIGNvb3Jkc1sxXSA9PSBvcHBvbmVudEdhbWVib2FyZE1pc3NlZENvb3Jkc0FycmF5W2ldWzFdXG4gICAgICApIHtcbiAgICAgICAgbWF0Y2ggPSB0cnVlO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgYXZhaWxhYmxlTW92ZXMucHVzaChbY29vcmRzWzBdLCBjb29yZHNbMV1dKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICBpZiAobWF0Y2ggPT0gdHJ1ZSkge1xuICAgICAgcmV0dXJuIHRydWU7XG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gIH07XG5cbiAgZnVuY3Rpb24gZ2V0UmFuZG9tSW50KG1heCkge1xuICAgIHJldHVybiBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiBtYXgpO1xuICB9XG5cbiAgY29uc3QgcmFuZG9tQXR0YWNrID0gZnVuY3Rpb24gKG9wcG9uZW50R2FtZWJvYXJkKSB7XG4gICAgbGV0IHJhbmRvbUluZGV4ID0gZ2V0UmFuZG9tSW50KG9wcG9uZW50R2FtZWJvYXJkLnBvdGVudGlhbE1vdmVzLmxlbmd0aCAtIDEpO1xuICAgIGxldCByYW5kb21Nb3ZlID0gb3Bwb25lbnRHYW1lYm9hcmQucG90ZW50aWFsTW92ZXNbcmFuZG9tSW5kZXhdO1xuICAgIGNvbnNvbGUubG9nKFwicmFuZGF0dGFja1wiKTtcbiAgICByZXR1cm4gcmFuZG9tTW92ZTtcbiAgfTtcblxuICByZXR1cm4ge1xuICAgIG5hbWUsXG4gICAgcmFuZG9tQXR0YWNrLFxuICAgIGdldExlZ2FsTW92ZXMsXG4gICAgcmFuZG9tQXR0YWNrLFxuICAgIGNoZWNrTWlzc2VkQ29vcmRzRm9yTWF0Y2gsXG4gIH07XG59O1xuXG5leHBvcnQgeyBQbGF5ZXIgfTtcbiIsImltcG9ydCB7IFNoaXAgfSBmcm9tIFwiLi9zaGlwXCI7XG5pbXBvcnQgeyBHYW1lQm9hcmQgfSBmcm9tIFwiLi9nYW1lQm9hcmRcIjtcbmltcG9ydCB7IFBsYXllciB9IGZyb20gXCIuL3BsYXllclwiO1xuXG4vLyBuZWVkIHRvIGNoYW5nZSBpZHMgb24gZWFjaCBnYW1lYm9hcmRcbi8vIGFkZCBpbiBzd2Fwc1xuLy8gZG9udCBhbGxvdyBhdHRhY2tpbmcgb3duIGdhbWVib2FyZFxuLy8gbWFrZSBjb21wdXRlciBtYWtlIG1vdmUgb24gaXRzIGdvXG4vL3NldCB0aW1lb3V0IHRvIGRlbGF5IG1vdmVcbi8vIGRpc3BsYXkgY2hhbmdlXG4vLyBlbmQgYXQgd2luXG5cbmNvbnN0IEdhbWUgPSBmdW5jdGlvbiAoKSB7XG4gIGxldCBwbGF5ZXJPbmUgPSBQbGF5ZXIoKTtcbiAgcGxheWVyT25lLm5hbWUgPSBcInBsYXllck9uZVwiO1xuICBsZXQgcGxheWVyVHdvID0gUGxheWVyKCk7XG4gIHBsYXllclR3by5uYW1lID0gXCJwbGF5ZXJUd29cIjtcbiAgbGV0IHAxR2FtZWJvYXJkID0gR2FtZUJvYXJkKHBsYXllck9uZSwgcGxheWVyVHdvKTtcbiAgbGV0IHAyR2FtZWJvYXJkID0gR2FtZUJvYXJkKHBsYXllck9uZSwgcGxheWVyVHdvKTtcbiAgcDFHYW1lYm9hcmQuZ2V0UG90ZW50aWFsTW92ZXMoKTtcbiAgcDJHYW1lYm9hcmQuZ2V0UG90ZW50aWFsTW92ZXMoKTtcbiAgbGV0IHdpbiA9IGZhbHNlO1xuICBsZXQgY3VycmVudFBsYXllciA9IHBsYXllck9uZTtcblxuICBjb25zdCBzZXRVcFBsYXllck9uZVNoaXBzID0gZnVuY3Rpb24gKCkge1xuICAgIC8vIHAxR2FtZWJvYXJkID0gR2FtZUJvYXJkKCk7XG4gICAgY29uc3QgcDFzaGlwMiA9IFNoaXAoMik7XG4gICAgcDFzaGlwMi5jb29yZHMucHVzaChbMCwgMF0pO1xuICAgIHAxc2hpcDIuY29vcmRzLnB1c2goWzAsIDFdKTtcbiAgICBwMUdhbWVib2FyZC5ib2FyZFswXVswXSA9IHAxc2hpcDI7XG4gICAgcDFHYW1lYm9hcmQuYm9hcmRbMF1bMV0gPSBwMXNoaXAyO1xuICAgIGNvbnN0IHAxc2hpcDNhID0gU2hpcCgzKTtcbiAgICAvLyBjb25zb2xlLmxvZyhgYWJjJHtwMXNoaXAzYS5sZW5ndGh9YCk7XG5cbiAgICBwMXNoaXAzYS5jb29yZHMucHVzaChbMSwgMF0pO1xuICAgIHAxc2hpcDNhLmNvb3Jkcy5wdXNoKFsxLCAxXSk7XG4gICAgcDFzaGlwM2EuY29vcmRzLnB1c2goWzEsIDJdKTtcbiAgICBwMUdhbWVib2FyZC5ib2FyZFsxXVswXSA9IHAxc2hpcDNhO1xuICAgIHAxR2FtZWJvYXJkLmJvYXJkWzFdWzFdID0gcDFzaGlwM2E7XG4gICAgcDFHYW1lYm9hcmQuYm9hcmRbMV1bMl0gPSBwMXNoaXAzYTtcbiAgICBjb25zdCBwMXNoaXAzYiA9IFNoaXAoMyk7XG4gICAgcDFzaGlwM2IuY29vcmRzLnB1c2goWzIsIDBdKTtcbiAgICBwMXNoaXAzYi5jb29yZHMucHVzaChbMiwgMV0pO1xuICAgIHAxc2hpcDNiLmNvb3Jkcy5wdXNoKFsyLCAyXSk7XG4gICAgcDFHYW1lYm9hcmQuYm9hcmRbMl1bMF0gPSBwMXNoaXAzYjtcbiAgICBwMUdhbWVib2FyZC5ib2FyZFsyXVsxXSA9IHAxc2hpcDNiO1xuICAgIHAxR2FtZWJvYXJkLmJvYXJkWzJdWzJdID0gcDFzaGlwM2I7XG4gICAgY29uc3QgcDFzaGlwNCA9IFNoaXAoNCk7XG4gICAgcDFzaGlwNC5jb29yZHMucHVzaChbMywgMF0pO1xuICAgIHAxc2hpcDQuY29vcmRzLnB1c2goWzMsIDFdKTtcbiAgICBwMXNoaXA0LmNvb3Jkcy5wdXNoKFszLCAyXSk7XG4gICAgcDFzaGlwNC5jb29yZHMucHVzaChbMywgM10pO1xuICAgIHAxR2FtZWJvYXJkLmJvYXJkWzNdWzBdID0gcDFzaGlwNDtcbiAgICBwMUdhbWVib2FyZC5ib2FyZFszXVsxXSA9IHAxc2hpcDQ7XG4gICAgcDFHYW1lYm9hcmQuYm9hcmRbM11bMl0gPSBwMXNoaXA0O1xuICAgIHAxR2FtZWJvYXJkLmJvYXJkWzNdWzNdID0gcDFzaGlwNDtcbiAgICBjb25zdCBwMXNoaXA1ID0gU2hpcCg1KTtcbiAgICBwMXNoaXA1LmNvb3Jkcy5wdXNoKFs0LCAwXSk7XG4gICAgcDFzaGlwNS5jb29yZHMucHVzaChbNCwgMV0pO1xuICAgIHAxc2hpcDUuY29vcmRzLnB1c2goWzQsIDJdKTtcbiAgICBwMXNoaXA1LmNvb3Jkcy5wdXNoKFs0LCAzXSk7XG4gICAgcDFzaGlwNS5jb29yZHMucHVzaChbNCwgNF0pO1xuICAgIHAxR2FtZWJvYXJkLmJvYXJkWzRdWzBdID0gcDFzaGlwNTtcbiAgICBwMUdhbWVib2FyZC5ib2FyZFs0XVsxXSA9IHAxc2hpcDU7XG4gICAgcDFHYW1lYm9hcmQuYm9hcmRbNF1bMl0gPSBwMXNoaXA1O1xuICAgIHAxR2FtZWJvYXJkLmJvYXJkWzRdWzNdID0gcDFzaGlwNTtcbiAgICBwMUdhbWVib2FyZC5ib2FyZFs0XVs0XSA9IHAxc2hpcDU7XG4gICAgcDFHYW1lYm9hcmQuY3VycmVudFNoaXBzLnB1c2gocDFzaGlwMik7XG4gICAgcDFHYW1lYm9hcmQuY3VycmVudFNoaXBzLnB1c2gocDFzaGlwM2EpO1xuICAgIHAxR2FtZWJvYXJkLmN1cnJlbnRTaGlwcy5wdXNoKHAxc2hpcDNiKTtcbiAgICBwMUdhbWVib2FyZC5jdXJyZW50U2hpcHMucHVzaChwMXNoaXA0KTtcbiAgICBwMUdhbWVib2FyZC5jdXJyZW50U2hpcHMucHVzaChwMXNoaXA1KTtcbiAgfTtcblxuICBjb25zdCBzZXRVcFBsYXllclR3b1NoaXBzID0gZnVuY3Rpb24gKCkge1xuICAgIGNvbnN0IHAyc2hpcDIgPSBTaGlwKDIpO1xuICAgIHAyc2hpcDIuY29vcmRzLnB1c2goWzAsIDBdKTtcbiAgICBwMnNoaXAyLmNvb3Jkcy5wdXNoKFswLCAxXSk7XG4gICAgcDJHYW1lYm9hcmQuYm9hcmRbMF1bMF0gPSBwMnNoaXAyO1xuICAgIHAyR2FtZWJvYXJkLmJvYXJkWzBdWzFdID0gcDJzaGlwMjtcbiAgICBjb25zdCBwMnNoaXAzYSA9IFNoaXAoMyk7XG4gICAgcDJzaGlwM2EuY29vcmRzLnB1c2goWzEsIDBdKTtcbiAgICBwMnNoaXAzYS5jb29yZHMucHVzaChbMSwgMV0pO1xuICAgIHAyc2hpcDNhLmNvb3Jkcy5wdXNoKFsxLCAyXSk7XG4gICAgcDJHYW1lYm9hcmQuYm9hcmRbMV1bMF0gPSBwMnNoaXAzYTtcbiAgICBwMkdhbWVib2FyZC5ib2FyZFsxXVsxXSA9IHAyc2hpcDNhO1xuICAgIHAyR2FtZWJvYXJkLmJvYXJkWzFdWzJdID0gcDJzaGlwM2E7XG4gICAgY29uc3QgcDJzaGlwM2IgPSBTaGlwKDMpO1xuICAgIHAyc2hpcDNiLmNvb3Jkcy5wdXNoKFsyLCAwXSk7XG4gICAgcDJzaGlwM2IuY29vcmRzLnB1c2goWzIsIDFdKTtcbiAgICBwMnNoaXAzYi5jb29yZHMucHVzaChbMiwgMl0pO1xuICAgIHAyR2FtZWJvYXJkLmJvYXJkWzJdWzBdID0gcDJzaGlwM2I7XG4gICAgcDJHYW1lYm9hcmQuYm9hcmRbMl1bMV0gPSBwMnNoaXAzYjtcbiAgICBwMkdhbWVib2FyZC5ib2FyZFsyXVsyXSA9IHAyc2hpcDNiO1xuICAgIGNvbnN0IHAyc2hpcDQgPSBTaGlwKDQpO1xuICAgIHAyc2hpcDQuY29vcmRzLnB1c2goWzMsIDBdKTtcbiAgICBwMnNoaXA0LmNvb3Jkcy5wdXNoKFszLCAxXSk7XG4gICAgcDJzaGlwNC5jb29yZHMucHVzaChbMywgMl0pO1xuICAgIHAyc2hpcDQuY29vcmRzLnB1c2goWzMsIDNdKTtcbiAgICBwMkdhbWVib2FyZC5ib2FyZFszXVswXSA9IHAyc2hpcDQ7XG4gICAgcDJHYW1lYm9hcmQuYm9hcmRbM11bMV0gPSBwMnNoaXA0O1xuICAgIHAyR2FtZWJvYXJkLmJvYXJkWzNdWzJdID0gcDJzaGlwNDtcbiAgICBwMkdhbWVib2FyZC5ib2FyZFszXVszXSA9IHAyc2hpcDQ7XG4gICAgY29uc3QgcDJzaGlwNSA9IFNoaXAoNSk7XG4gICAgcDJzaGlwNS5jb29yZHMucHVzaChbNCwgMF0pO1xuICAgIHAyc2hpcDUuY29vcmRzLnB1c2goWzQsIDFdKTtcbiAgICBwMnNoaXA1LmNvb3Jkcy5wdXNoKFs0LCAyXSk7XG4gICAgcDJzaGlwNS5jb29yZHMucHVzaChbNCwgM10pO1xuICAgIHAyc2hpcDUuY29vcmRzLnB1c2goWzQsIDRdKTtcbiAgICBwMkdhbWVib2FyZC5ib2FyZFs0XVswXSA9IHAyc2hpcDU7XG4gICAgcDJHYW1lYm9hcmQuYm9hcmRbNF1bMV0gPSBwMnNoaXA1O1xuICAgIHAyR2FtZWJvYXJkLmJvYXJkWzRdWzJdID0gcDJzaGlwNTtcbiAgICBwMkdhbWVib2FyZC5ib2FyZFs0XVszXSA9IHAyc2hpcDU7XG4gICAgcDJHYW1lYm9hcmQuYm9hcmRbNF1bNF0gPSBwMnNoaXA1O1xuXG4gICAgcDJHYW1lYm9hcmQuY3VycmVudFNoaXBzLnB1c2gocDJzaGlwMik7XG4gICAgcDJHYW1lYm9hcmQuY3VycmVudFNoaXBzLnB1c2gocDJzaGlwM2EpO1xuICAgIHAyR2FtZWJvYXJkLmN1cnJlbnRTaGlwcy5wdXNoKHAyc2hpcDNiKTtcbiAgICBwMkdhbWVib2FyZC5jdXJyZW50U2hpcHMucHVzaChwMnNoaXA0KTtcbiAgICBwMkdhbWVib2FyZC5jdXJyZW50U2hpcHMucHVzaChwMnNoaXA1KTtcbiAgfTtcblxuICBjb25zdCByZWNlaXZlQXR0YWNrID0gZnVuY3Rpb24gKGNvb3Jkcywgc3F1YXJlLCBib2FyZCwgcG90ZW50aWFsTW92ZXMpIHtcbiAgICBsZXQgc2hpcCA9IGJvYXJkW2Nvb3Jkc1sxXV1bY29vcmRzWzBdXTsgLy8geCBhbmQgeSBtdXN0IGJlIHN3YXBwZWQgZm9yIGdhbWUgYm9hcmRcblxuICAgIC8vIGlmIG5vdCBhIGxlZ2FsIG1vdmUsIHJldHJ5XG4gICAgY29uc29sZS5sb2coYGNvb3JkcyA9ICR7Y29vcmRzfWApO1xuICAgIGlmIChtYXRjaE1vdmUocG90ZW50aWFsTW92ZXMsIGNvb3JkcykgPT0gZmFsc2UpIHtcbiAgICAgIGNvbnNvbGUubG9nKFwiUmV0cnkgYnJvXCIpO1xuICAgIH0gZWxzZSB7XG4gICAgICBpZiAoc2hpcCA9PSBcIiBcIikge1xuICAgICAgICBpZiAoY3VycmVudFBsYXllciA9PSBwbGF5ZXJPbmUpIHtcbiAgICAgICAgICBwMkdhbWVib2FyZC5taXNzZWRDb29yZHMucHVzaChjb29yZHMpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHAxR2FtZWJvYXJkLm1pc3NlZENvb3Jkcy5wdXNoKGNvb3Jkcyk7XG4gICAgICAgIH1cbiAgICAgICAgY29uc29sZS5sb2coXCJtaXNzXCIpO1xuICAgICAgICBkaXNwbGF5TWlzcyhzcXVhcmUpO1xuICAgICAgICBzd2FwUGxheWVyKCk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBsZXQgc3dhcHBlZENvb3JkcyA9IFtdO1xuICAgICAgICBzd2FwcGVkQ29vcmRzLnB1c2goY29vcmRzWzFdKTtcbiAgICAgICAgc3dhcHBlZENvb3Jkcy5wdXNoKGNvb3Jkc1swXSk7XG4gICAgICAgIGlmIChtYXRjaE1vdmUoc2hpcC5jb29yZHMsIHN3YXBwZWRDb29yZHMpKSB7XG4gICAgICAgICAgc2hpcC5oaXQoKTtcbiAgICAgICAgICBkaXNwbGF5SGl0KHNxdWFyZSk7XG4gICAgICAgICAgc2hpcC5pc1N1bmsoKTtcbiAgICAgICAgICBzd2FwUGxheWVyKCk7IC8vIHN3YXBcbiAgICAgICAgICBpZiAoc2hpcC5pc1N1bmsoKSkge1xuICAgICAgICAgICAgc2hpcFN1bmsoc2hpcCk7XG4gICAgICAgICAgICBzdW5rU2hpcHMucHVzaChzaGlwKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgLy8gYWxsU3VuaygpOyAvLyBhZGQgYmFjayBpblxuICAgICAgICAgIGNvbnNvbGUubG9nKFwiaGl0XCIpO1xuICAgICAgICAgIHN3YXBwZWRDb29yZHMgPSBbXTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgaWYgKG1hdGNoTW92ZShwb3RlbnRpYWxNb3ZlcywgY29vcmRzKSkge1xuICAgICAgICByZW1vdmVBbGxJbnN0YW5jZXMocG90ZW50aWFsTW92ZXMsIGNvb3Jkcyk7IC8vIG5lZWQgdG8gY29kZSB0aGlzXG4gICAgICB9XG4gICAgfVxuICB9O1xuXG4gIGZ1bmN0aW9uIHJlbW92ZUFsbEluc3RhbmNlcyhhcnIsIGl0ZW0pIHtcbiAgICBmb3IgKGxldCBpID0gYXJyLmxlbmd0aDsgaS0tOyApIHtcbiAgICAgIGlmIChhcnJbaV1bMF0gPT0gaXRlbVswXSAmJiBhcnJbaV1bMV0gPT0gaXRlbVsxXSkgYXJyLnNwbGljZShpLCAxKTtcbiAgICB9XG4gIH1cblxuICBjb25zdCBtYXRjaE1vdmUgPSBmdW5jdGlvbiAoYXJyYXlUb0ZpbmRNYXRjaCwgY29vcmRzKSB7XG4gICAgbGV0IG1hdGNoID0gZmFsc2U7XG4gICAgYXJyYXlUb0ZpbmRNYXRjaC5mb3JFYWNoKChtb3ZlKSA9PiB7XG4gICAgICBpZiAobW92ZVswXSA9PSBjb29yZHNbMF0gJiYgbW92ZVsxXSA9PSBjb29yZHNbMV0pIHtcbiAgICAgICAgLy8gY29uc29sZS5sb2coXCJ0cnVlXCIpO1xuICAgICAgICBtYXRjaCA9IHRydWU7XG4gICAgICB9XG4gICAgfSk7XG5cbiAgICBpZiAobWF0Y2ggPT0gdHJ1ZSkge1xuICAgICAgcmV0dXJuIHRydWU7XG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gIH07XG5cbiAgY29uc3Qgc2V0VXBDbGlja1RvSGl0ID0gZnVuY3Rpb24gKCkge1xuICAgIGxldCBzcXVhcmVzID0gZG9jdW1lbnQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZShcImNvbXB1dGVyLXNxdWFyZVwiKTtcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IHNxdWFyZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgIHNxdWFyZXNbaV0uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgICAgICAgcmVjZWl2ZUF0dGFjayhcbiAgICAgICAgICBjbGFzc1RvQ29vcmRzKHNxdWFyZXNbaV0pLFxuICAgICAgICAgIHNxdWFyZXNbaV0sXG4gICAgICAgICAgcDJHYW1lYm9hcmQuYm9hcmQsXG4gICAgICAgICAgcDJHYW1lYm9hcmQucG90ZW50aWFsTW92ZXNcbiAgICAgICAgKTtcbiAgICAgIH0pO1xuICAgIH1cbiAgfTtcblxuICBjb25zdCBkaXNwbGF5SGl0ID0gZnVuY3Rpb24gKHNxdWFyZSkge1xuICAgIHNxdWFyZS5jbGFzc0xpc3QuYWRkKFwiaGl0XCIpO1xuICB9O1xuXG4gIGNvbnN0IGRpc3BsYXlNaXNzID0gZnVuY3Rpb24gKHNxdWFyZSkge1xuICAgIHNxdWFyZS5jbGFzc0xpc3QuYWRkKFwibWlzc1wiKTtcbiAgfTtcblxuICBjb25zdCBkaXNhYmxlQ2xpY2sgPSBmdW5jdGlvbiAoKSB7XG4gICAgbGV0IHNxdWFyZXMgPSBkb2N1bWVudC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKFwiY29tcHV0ZXItc3F1YXJlXCIpO1xuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgc3F1YXJlcy5sZW5ndGg7IGkrKykge1xuICAgICAgc3F1YXJlc1tpXS5jbGFzc0xpc3QuYWRkKFwiZGlzYWJsZWRcIik7XG4gICAgfVxuICB9O1xuXG4gIGNvbnN0IGVuYWJsZUNsaWNrID0gZnVuY3Rpb24gKCkge1xuICAgIGxldCBzcXVhcmVzID0gZG9jdW1lbnQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZShcImNvbXB1dGVyLXNxdWFyZVwiKTtcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IHNxdWFyZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgIHNxdWFyZXNbaV0uY2xhc3NMaXN0LnJlbW92ZShcImRpc2FibGVkXCIpO1xuICAgIH1cbiAgfTtcblxuICBjb25zdCBzd2FwUGxheWVyID0gZnVuY3Rpb24gKCkge1xuICAgIGlmIChjdXJyZW50UGxheWVyID09IHBsYXllck9uZSkge1xuICAgICAgLy8gZGlzYWJsZUNsaWNrKCk7XG4gICAgICBjdXJyZW50UGxheWVyID0gcGxheWVyVHdvO1xuICAgICAgLy8gY3VycmVudFBsYXllci5yYW5kb21BdHRhY2soKTtcbiAgICB9IGVsc2Uge1xuICAgICAgLy8gZW5hYmxlQ2xpY2soKTtcbiAgICAgIGN1cnJlbnRQbGF5ZXIgPSBwbGF5ZXJPbmU7XG4gICAgfVxuICAgIGNvbnNvbGUubG9nKFwic3dhcFwiKTtcbiAgICBjb25zb2xlLmxvZyhjdXJyZW50UGxheWVyKTtcbiAgfTtcblxuICBjb25zdCBjbGFzc1RvQ29vcmRzID0gZnVuY3Rpb24gKGluZGl2aWR1YWxTcXVhcmUpIHtcbiAgICBsZXQgY2xhc3NlcyA9IGluZGl2aWR1YWxTcXVhcmUuY2xhc3NMaXN0O1xuICAgIGxldCB4ID0gY2xhc3Nlc1sxXTtcbiAgICBsZXQgeSA9IFwib29wc1wiOyAvLyB0byBzdG9wIGVycm9yc1xuICAgIGxldCB0ZW1wID0gcGFyc2VJbnQoY2xhc3Nlc1syXSk7XG4gICAgaWYgKHBhcnNlSW50KGNsYXNzZXNbMl0pID49IDApIHtcbiAgICAgIHkgPSBjbGFzc2VzWzJdO1xuICAgIH0gZWxzZSB7XG4gICAgICB5ID0gY2xhc3Nlc1sxXTtcbiAgICB9XG4gICAgcmV0dXJuIFt4LCB5XTtcbiAgfTtcblxuICBjb25zdCBzZXRVcEdhbWUgPSBmdW5jdGlvbiAoKSB7XG4gICAgc2V0VXBQbGF5ZXJPbmVTaGlwcygpO1xuICAgIHNldFVwUGxheWVyVHdvU2hpcHMoKTtcbiAgICBwMUdhbWVib2FyZC5kcmF3Qm9hcmQoKTtcbiAgICBwMkdhbWVib2FyZC5kcmF3Q29tcHV0ZXJCb2FyZCgpO1xuICAgIHNldFVwQ2xpY2tUb0hpdCgpO1xuICB9O1xuXG4gIHJldHVybiB7IHNldFVwR2FtZSwgcDFHYW1lYm9hcmQsIHAyR2FtZWJvYXJkIH07XG59O1xuXG5leHBvcnQgeyBHYW1lIH07XG4iLCJpbXBvcnQgeyBTaGlwIH0gZnJvbSBcIi4vc2hpcFwiO1xuaW1wb3J0IHsgR2FtZUJvYXJkIH0gZnJvbSBcIi4vZ2FtZUJvYXJkXCI7XG5pbXBvcnQgeyBQbGF5ZXIgfSBmcm9tIFwiLi9wbGF5ZXJcIjtcbmltcG9ydCB7IEdhbWUgfSBmcm9tIFwiLi9nYW1lXCI7XG5cbi8vIGNvbnN0IGdiMSA9IEdhbWVCb2FyZCgpO1xuLy8gY29uc3QgZ2IyID0gR2FtZUJvYXJkKCk7XG5cbi8vIC8vIGNvbnN0IGdhbWUgPSBHYW1lKCk7XG4vLyAvLyBjb25zdCBwbGF5ZXIgPSBQbGF5ZXIoKTtcbi8vIC8vIGNvbnN0IHNoaXAgPSBTaGlwKCk7XG4vLyAvLyBzaGlwLmNvb3Jkcy5wdXNoKFswLCAxXSk7XG4vLyAvLyBnYi5nZXRQb3RlbnRpYWxNb3ZlcygpO1xuLy8gLy8gbGV0IG1vdmVzID0gZ2IucG90ZW50aWFsTW92ZXM7XG4vLyAvLyBjb25zb2xlLmxvZyhnYi5wb3RlbnRpYWxNb3Zlcy5sZW5ndGgpIDtcbi8vIC8vIGdiLnJlY2VpdmVBdHRhY2soc2hpcCwgWzAsIDNdKTtcbi8vIC8vIGNvbnNvbGUubG9nKGdiLnBvdGVudGlhbE1vdmVzLmxlbmd0aCk7XG4vLyBnYjEuZHJhd0JvYXJkKCk7XG4vLyBnYjIuZHJhd0JvYXJkKCk7XG5jb25zdCBnYW1lID0gR2FtZSgpO1xuZ2FtZS5zZXRVcEdhbWUoKTtcblxuLy8gZ2FtZS5wMUdhbWVib2FyZC5kcmF3Qm9hcmQoKTtcbi8vIGdhbWUucDJHYW1lYm9hcmQuZHJhd0NvbXB1dGVyQm9hcmQoKTtcbi8vIGdhbWUucDFHYW1lYm9hcmQuc2V0VXBDbGlja1RvSGl0KCk7XG4vLyBnYW1lLnAyR2FtZWJvYXJkLnNldFVwQ2xpY2tUb0hpdCgpO1xuIl0sIm5hbWVzIjpbIlNoaXAiLCJsZW5ndGgiLCJudW1iZXJPZkhpdHMiLCJzdW5rIiwic2hpcExlbmd0aCIsImlzU3VuayIsImhpdCIsImNvb3JkcyIsIkdhbWVCb2FyZCIsInBsYXllck9uZSIsInBsYXllclR3byIsInN1bmtTaGlwcyIsInBvdGVudGlhbE1vdmVzIiwiYm9hcmQiLCJob3Jpem9udGFsIiwic2hpcCIsInN0YXJ0Um93Q29vcmRzIiwic3RhcnRDb2x1bW5Db29yZHMiLCJpIiwiY3VycmVudENvb3JkIiwicHVzaCIsInZlcnRpY2FsIiwibWlzc2VkQ29vcmRzIiwiY3VycmVudFNoaXBzIiwiYWxsU3VuayIsImFsZXJ0IiwiZ2V0UG90ZW50aWFsTW92ZXMiLCJhIiwicmVtb3ZlQWxsSW5zdGFuY2VzIiwiYXJyIiwiaXRlbSIsInNwbGljZSIsImRyYXdCb2FyZCIsImNvbnRhaW5lciIsImRvY3VtZW50IiwiZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSIsImJvYXJkQ29udGFpbmVyIiwiY3JlYXRlRWxlbWVudCIsImNsYXNzTGlzdCIsImFkZCIsImFwcGVuZENoaWxkIiwiaW5kaXZpZHVhbFNxdWFyZSIsImRyYXdDb21wdXRlckJvYXJkIiwiUGxheWVyIiwibGVnYWxNb3ZlcyIsInJhbmRvbUF0dGFjayIsIm9wcG9uZW50R2FtZWJvYXJkIiwicmFuZG9tSW5kZXgiLCJtYXgiLCJNYXRoIiwiZmxvb3IiLCJyYW5kb20iLCJyYW5kb21Nb3ZlIiwiY29uc29sZSIsImxvZyIsIm5hbWUiLCJnZXRMZWdhbE1vdmVzIiwiY2hlY2tNaXNzZWRDb29yZHNGb3JNYXRjaCIsIm9wcG9uZW50R2FtZWJvYXJkTWlzc2VkQ29vcmRzQXJyYXkiLCJtYXRjaCIsImF2YWlsYWJsZU1vdmVzIiwicDFHYW1lYm9hcmQiLCJwMkdhbWVib2FyZCIsImN1cnJlbnRQbGF5ZXIiLCJyZWNlaXZlQXR0YWNrIiwic3F1YXJlIiwibWF0Y2hNb3ZlIiwiZGlzcGxheU1pc3MiLCJzd2FwUGxheWVyIiwic3dhcHBlZENvb3JkcyIsImRpc3BsYXlIaXQiLCJzaGlwU3VuayIsImFycmF5VG9GaW5kTWF0Y2giLCJmb3JFYWNoIiwibW92ZSIsImNsYXNzVG9Db29yZHMiLCJjbGFzc2VzIiwieCIsInkiLCJwYXJzZUludCIsInNldFVwR2FtZSIsInAxc2hpcDIiLCJwMXNoaXAzYSIsInAxc2hpcDNiIiwicDFzaGlwNCIsInAxc2hpcDUiLCJzZXRVcFBsYXllck9uZVNoaXBzIiwicDJzaGlwMiIsInAyc2hpcDNhIiwicDJzaGlwM2IiLCJwMnNoaXA0IiwicDJzaGlwNSIsInNldFVwUGxheWVyVHdvU2hpcHMiLCJzcXVhcmVzIiwiYWRkRXZlbnRMaXN0ZW5lciIsInNldFVwQ2xpY2tUb0hpdCIsIkdhbWUiXSwic291cmNlUm9vdCI6IiJ9