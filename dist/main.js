(()=>{"use strict";const o=function(o){let s=0,t=!1;return{shipLength:o,numberOfHits:s,isSunk:function(){return s>=o&&(t=!0,!0)},hit:function(){s+=1},coords:[],length:o,sunk:t}},s=function(o,s){let t=[],e=[[[" "],[" "],[" "],[" "],[" "],[" "],[" "],[" "],[" "],[" "]],[[" "],[" "],[" "],[" "],[" "],[" "],[" "],[" "],[" "],[" "]],[[" "],[" "],[" "],[" "],[" "],[" "],[" "],[" "],[" "],[" "]],[[" "],[" "],[" "],[" "],[" "],[" "],[" "],[" "],[" "],[" "]],[[" "],[" "],[" "],[" "],[" "],[" "],[" "],[" "],[" "],[" "]],[[" "],[" "],[" "],[" "],[" "],[" "],[" "],[" "],[" "],[" "]],[[" "],[" "],[" "],[" "],[" "],[" "],[" "],[" "],[" "],[" "]],[[" "],[" "],[" "],[" "],[" "],[" "],[" "],[" "],[" "],[" "]],[[" "],[" "],[" "],[" "],[" "],[" "],[" "],[" "],[" "],[" "]],[[" "],[" "],[" "],[" "],[" "],[" "],[" "],[" "],[" "],[" "]]];return{board:e,horizontal:function(o,s,t){for(let e=0;e<o.shipLength;e++){let r=[s,e+t];o.coords.push(r)}},vertical:function(o,s,t){for(let e=0;e<o.shipLength;e++){let r=[e+s,t];o.coords.push(r)}},missedCoords:[],currentShips:[],allSunk,getPotentialMoves:function(){for(let o=0;o<10;o++)for(let s=0;s<10;s++)t.push([s,o])},potentialMoves:t,drawBoard:function(){const o=document.getElementsByClassName("container")[0];let s=document.createElement("div");s.classList.add("board-container"),o.appendChild(s);for(let o=0;o<e.length;o++)for(let t=0;t<e.length;t++){let r=document.createElement("div");r.classList.add("individual-square"),r.classList.add(t),r.classList.add(o),s.appendChild(r)," "!=e[o][t]&&r.classList.add("ship")}},drawComputerBoard:function(){const o=document.getElementsByClassName("container")[0];let s=document.createElement("div");s.classList.add("board-container"),o.appendChild(s);for(let o=0;o<e.length;o++)for(let t=0;t<e.length;t++){let e=document.createElement("div");e.classList.add("computer-square"),e.classList.add(t),e.classList.add(o),s.appendChild(e)}},sunkShips:[]}},t=function(){let o=[];const s=function(o){console.log("random attack");let s=(t=o.potentialMoves.length-1,Math.floor(Math.random()*t));var t;return o.potentialMoves[s]};return{name:"",randomAttack:s,getLegalMoves:function(s){o=[];for(let t=0;t<s.board.length;t++)for(let e=0;e<10;e++)" "==s.board[t][e]&&o.push([t,e])},randomAttack:s,checkMissedCoordsForMatch:function(o,s){let t=!1;availableMoves=[];for(let e=0;e<s.length;e++)o[0]==s[e][0]&&o[1]==s[e][1]?t=!0:availableMoves.push([o[0],o[1]]);return 1==t}}};(function(){let e=t();e.name="playerOne";let r=t();r.name="playerTwo";let n=s(),d=s();n.getPotentialMoves(),d.getPotentialMoves();let a=e;const c=function(o,s,t,r){let c=t[o[1]][o[0]];if(console.log(`coords = ${o}`),0==i(r,o))console.log("Retry bro");else{if(" "==c)a==e?d.missedCoords.push(o):n.missedCoords.push(o),console.log("miss"),p(s),m();else{let t=[];t.push(o[1]),t.push(o[0]),i(c.coords,t)&&(c.hit(),h(s),c.isSunk(),c.isSunk()&&(u(c),a==e?d.sunkShips.push(c):n.sunkShips.push(c)),console.log("hit"),t=[],m())}i(r,o)&&function(o,s){for(let t=o.length;t--;)o[t][0]==s[0]&&o[t][1]==s[1]&&o.splice(t,1)}(r,o)}},u=function(o){for(let s=0;s<o.coords.length;s++){let t=o.coords[s][1],e=o.coords[s][0];l([t,e]).classList.add("sunk")}},l=function(o){let s=o[0],t=o[1],e="";e=a==r?document.getElementsByClassName("individual-square"):document.getElementsByClassName("computer-square");for(let o=0;o<e.length;o++){let r=f(e[o]);if(s==r[0]&&t==r[1]){let s=e[o];return console.log(s),s}}},i=function(o,s){let t=!1;return o.forEach((o=>{o[0]==s[0]&&o[1]==s[1]&&(t=!0)})),1==t},h=function(o){o.classList.add("hit")},p=function(o){o.classList.add("miss")},m=function(){if((5==n.sunkShips.length||5==d.sunkShips.length)&&alert("DONE!"),a==e){!function(){let o=document.getElementsByClassName("computer-square");for(let s=0;s<o.length;s++)o[s].classList.add("disabled")}(),a=r;let o=a.randomAttack(n),s=l(o);c(o,s,n.board,n.potentialMoves)}else!function(){let o=document.getElementsByClassName("computer-square");for(let s=0;s<o.length;s++)o[s].classList.remove("disabled")}(),a=e;console.log("swap"),console.log(a)},f=function(o){let s=o.classList,t=s[1],e="oops";return parseInt(s[2]),e=parseInt(s[2])>=0?s[2]:s[1],[t,e]};return{setUpGame:function(){!function(){const s=o(2);s.coords.push([0,0]),s.coords.push([0,1]),n.board[0][0]=s,n.board[0][1]=s;const t=o(3);t.coords.push([1,0]),t.coords.push([1,1]),t.coords.push([1,2]),n.board[1][0]=t,n.board[1][1]=t,n.board[1][2]=t;const e=o(3);e.coords.push([2,0]),e.coords.push([2,1]),e.coords.push([2,2]),n.board[2][0]=e,n.board[2][1]=e,n.board[2][2]=e;const r=o(4);r.coords.push([3,0]),r.coords.push([3,1]),r.coords.push([3,2]),r.coords.push([3,3]),n.board[3][0]=r,n.board[3][1]=r,n.board[3][2]=r,n.board[3][3]=r;const d=o(5);d.coords.push([4,0]),d.coords.push([4,1]),d.coords.push([4,2]),d.coords.push([4,3]),d.coords.push([4,4]),n.board[4][0]=d,n.board[4][1]=d,n.board[4][2]=d,n.board[4][3]=d,n.board[4][4]=d,n.currentShips.push(s),n.currentShips.push(t),n.currentShips.push(e),n.currentShips.push(r),n.currentShips.push(d)}(),function(){const s=o(2);s.coords.push([0,0]),s.coords.push([0,1]),d.board[0][0]=s,d.board[0][1]=s;const t=o(3);t.coords.push([1,0]),t.coords.push([1,1]),t.coords.push([1,2]),d.board[1][0]=t,d.board[1][1]=t,d.board[1][2]=t;const e=o(3);e.coords.push([2,0]),e.coords.push([2,1]),e.coords.push([2,2]),d.board[2][0]=e,d.board[2][1]=e,d.board[2][2]=e;const r=o(4);r.coords.push([3,0]),r.coords.push([3,1]),r.coords.push([3,2]),r.coords.push([3,3]),d.board[3][0]=r,d.board[3][1]=r,d.board[3][2]=r,d.board[3][3]=r;const n=o(5);n.coords.push([4,0]),n.coords.push([4,1]),n.coords.push([4,2]),n.coords.push([4,3]),n.coords.push([4,4]),d.board[4][0]=n,d.board[4][1]=n,d.board[4][2]=n,d.board[4][3]=n,d.board[4][4]=n,d.currentShips.push(s),d.currentShips.push(t),d.currentShips.push(e),d.currentShips.push(r),d.currentShips.push(n)}(),n.drawBoard(),d.drawComputerBoard(),function(){let o=document.getElementsByClassName("computer-square");for(let s=0;s<o.length;s++)o[s].addEventListener("click",(()=>{c(f(o[s]),o[s],d.board,d.potentialMoves)}))}()},p1Gameboard:n,p2Gameboard:d}})().setUpGame()})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibWFpbi5qcyIsIm1hcHBpbmdzIjoibUJBQUEsTUFBTUEsRUFBTyxTQUFVQyxHQUVyQixJQUFJQyxFQUFlLEVBQ2ZDLEdBQU8sRUFnQlgsTUFBTyxDQUFFQyxXQWxCVUgsRUFrQkVDLGVBQWNHLE9BVHBCLFdBQ2IsT0FBSUgsR0FBZ0JELElBQ2xCRSxHQUFPLEdBQ0EsRUFJWCxFQUUyQ0csSUFiL0IsV0FDVkosR0FBZ0IsQ0FDbEIsRUFXZ0RLLE9BZm5DLEdBZTJDTixTQUFRRSxPQUNsRSxFQ3BCTUssRUFBWSxTQUFVQyxFQUFXQyxHQUtyQyxJQUFJQyxFQUFpQixHQUdqQkMsRUFBUSxDQUNWLENBQUMsQ0FBQyxLQUFNLENBQUMsS0FBTSxDQUFDLEtBQU0sQ0FBQyxLQUFNLENBQUMsS0FBTSxDQUFDLEtBQU0sQ0FBQyxLQUFNLENBQUMsS0FBTSxDQUFDLEtBQU0sQ0FBQyxNQUNqRSxDQUFDLENBQUMsS0FBTSxDQUFDLEtBQU0sQ0FBQyxLQUFNLENBQUMsS0FBTSxDQUFDLEtBQU0sQ0FBQyxLQUFNLENBQUMsS0FBTSxDQUFDLEtBQU0sQ0FBQyxLQUFNLENBQUMsTUFDakUsQ0FBQyxDQUFDLEtBQU0sQ0FBQyxLQUFNLENBQUMsS0FBTSxDQUFDLEtBQU0sQ0FBQyxLQUFNLENBQUMsS0FBTSxDQUFDLEtBQU0sQ0FBQyxLQUFNLENBQUMsS0FBTSxDQUFDLE1BQ2pFLENBQUMsQ0FBQyxLQUFNLENBQUMsS0FBTSxDQUFDLEtBQU0sQ0FBQyxLQUFNLENBQUMsS0FBTSxDQUFDLEtBQU0sQ0FBQyxLQUFNLENBQUMsS0FBTSxDQUFDLEtBQU0sQ0FBQyxNQUNqRSxDQUFDLENBQUMsS0FBTSxDQUFDLEtBQU0sQ0FBQyxLQUFNLENBQUMsS0FBTSxDQUFDLEtBQU0sQ0FBQyxLQUFNLENBQUMsS0FBTSxDQUFDLEtBQU0sQ0FBQyxLQUFNLENBQUMsTUFDakUsQ0FBQyxDQUFDLEtBQU0sQ0FBQyxLQUFNLENBQUMsS0FBTSxDQUFDLEtBQU0sQ0FBQyxLQUFNLENBQUMsS0FBTSxDQUFDLEtBQU0sQ0FBQyxLQUFNLENBQUMsS0FBTSxDQUFDLE1BQ2pFLENBQUMsQ0FBQyxLQUFNLENBQUMsS0FBTSxDQUFDLEtBQU0sQ0FBQyxLQUFNLENBQUMsS0FBTSxDQUFDLEtBQU0sQ0FBQyxLQUFNLENBQUMsS0FBTSxDQUFDLEtBQU0sQ0FBQyxNQUNqRSxDQUFDLENBQUMsS0FBTSxDQUFDLEtBQU0sQ0FBQyxLQUFNLENBQUMsS0FBTSxDQUFDLEtBQU0sQ0FBQyxLQUFNLENBQUMsS0FBTSxDQUFDLEtBQU0sQ0FBQyxLQUFNLENBQUMsTUFDakUsQ0FBQyxDQUFDLEtBQU0sQ0FBQyxLQUFNLENBQUMsS0FBTSxDQUFDLEtBQU0sQ0FBQyxLQUFNLENBQUMsS0FBTSxDQUFDLEtBQU0sQ0FBQyxLQUFNLENBQUMsS0FBTSxDQUFDLE1BQ2pFLENBQUMsQ0FBQyxLQUFNLENBQUMsS0FBTSxDQUFDLEtBQU0sQ0FBQyxLQUFNLENBQUMsS0FBTSxDQUFDLEtBQU0sQ0FBQyxLQUFNLENBQUMsS0FBTSxDQUFDLEtBQU0sQ0FBQyxPQW1HbkUsTUFBTyxDQUNMQSxRQUNBQyxXQW5FaUIsU0FBVUMsRUFBTUMsRUFBZ0JDLEdBQ2pELElBQUssSUFBSUMsRUFBSSxFQUFHQSxFQUFJSCxFQUFLVixXQUFZYSxJQUFLLENBQ3hDLElBQUlDLEVBQWUsQ0FBQ0gsRUFBZ0JFLEVBQUlELEdBQ3hDRixFQUFLUCxPQUFPWSxLQUFLRCxFQUNuQixDQUNGLEVBK0RFRSxTQTdEZSxTQUFVTixFQUFNQyxFQUFnQkMsR0FDL0MsSUFBSyxJQUFJQyxFQUFJLEVBQUdBLEVBQUlILEVBQUtWLFdBQVlhLElBQUssQ0FDeEMsSUFBSUMsRUFBZSxDQUFDRCxFQUFJRixFQUFnQkMsR0FDeENGLEVBQUtQLE9BQU9ZLEtBQUtELEVBQ25CLENBQ0YsRUF5REVHLGFBckhtQixHQXNIbkJDLGFBeEhpQixHQXlIakJDLFFBQ0FDLGtCQXZHd0IsV0FDeEIsSUFBSyxJQUFJUCxFQUFJLEVBQUdBLEVBQUksR0FBSUEsSUFDdEIsSUFBSyxJQUFJUSxFQUFJLEVBQUdBLEVBQUksR0FBSUEsSUFDdEJkLEVBQWVRLEtBQUssQ0FBQ00sRUFBR1IsR0FHOUIsRUFrR0VOLGlCQUNBZSxVQTVDZ0IsV0FDaEIsTUFBTUMsRUFBWUMsU0FBU0MsdUJBQXVCLGFBQWEsR0FDL0QsSUFBSUMsRUFBaUJGLFNBQVNHLGNBQWMsT0FDNUNELEVBQWVFLFVBQVVDLElBQUksbUJBQzdCTixFQUFVTyxZQUFZSixHQUN0QixJQUFLLElBQUliLEVBQUksRUFBR0EsRUFBSUwsRUFBTVgsT0FBUWdCLElBQ2hDLElBQUssSUFBSVEsRUFBSSxFQUFHQSxFQUFJYixFQUFNWCxPQUFRd0IsSUFBSyxDQUNyQyxJQUFJVSxFQUFtQlAsU0FBU0csY0FBYyxPQUM5Q0ksRUFBaUJILFVBQVVDLElBQUkscUJBQy9CRSxFQUFpQkgsVUFBVUMsSUFBSVIsR0FDL0JVLEVBQWlCSCxVQUFVQyxJQUFJaEIsR0FDL0JhLEVBQWVJLFlBQVlDLEdBQ1IsS0FBZnZCLEVBQU1LLEdBQUdRLElBQ1hVLEVBQWlCSCxVQUFVQyxJQUFJLE9BRW5DLENBRUosRUE0QkVHLGtCQTFCd0IsV0FDeEIsTUFBTVQsRUFBWUMsU0FBU0MsdUJBQXVCLGFBQWEsR0FDL0QsSUFBSUMsRUFBaUJGLFNBQVNHLGNBQWMsT0FDNUNELEVBQWVFLFVBQVVDLElBQUksbUJBQzdCTixFQUFVTyxZQUFZSixHQUN0QixJQUFLLElBQUliLEVBQUksRUFBR0EsRUFBSUwsRUFBTVgsT0FBUWdCLElBQ2hDLElBQUssSUFBSVEsRUFBSSxFQUFHQSxFQUFJYixFQUFNWCxPQUFRd0IsSUFBSyxDQUNyQyxJQUFJVSxFQUFtQlAsU0FBU0csY0FBYyxPQUM5Q0ksRUFBaUJILFVBQVVDLElBQUksbUJBQy9CRSxFQUFpQkgsVUFBVUMsSUFBSVIsR0FDL0JVLEVBQWlCSCxVQUFVQyxJQUFJaEIsR0FDL0JhLEVBQWVJLFlBQVlDLEVBQzdCLENBRUosRUFhRUUsVUE3SGMsR0ErSGxCLEVDaElNQyxFQUFTLFdBRWIsSUFBSUMsRUFBYSxHQTRDakIsTUFBTUMsRUFBZSxTQUFVQyxHQUM3QkMsUUFBUUMsSUFBSSxpQkFDWixJQUFJQyxHQU5nQkMsRUFNV0osRUFBa0I5QixlQUFlVixPQUFTLEVBTGxFNkMsS0FBS0MsTUFBTUQsS0FBS0UsU0FBV0gsSUFEcEMsSUFBc0JBLEVBUXBCLE9BRGlCSixFQUFrQjlCLGVBQWVpQyxFQUVwRCxFQUVBLE1BQU8sQ0FDTEssS0FyRFcsR0FzRFhULGVBQ0FVLGNBbERvQixTQUFVVCxHQUM5QkYsRUFBYSxHQUNiLElBQUssSUFBSXRCLEVBQUksRUFBR0EsRUFBSXdCLEVBQWtCN0IsTUFBTVgsT0FBUWdCLElBQ2xELElBQUssSUFBSVEsRUFBSSxFQUFHQSxFQUFJLEdBQUlBLElBQ2UsS0FBakNnQixFQUFrQjdCLE1BQU1LLEdBQUdRLElBQzdCYyxFQUFXcEIsS0FBSyxDQUFDRixFQUFHUSxHQUk1QixFQTBDRWUsZUFDQVcsMEJBekNnQyxTQUNoQzVDLEVBQ0E2QyxHQUVBLElBQUlDLEdBQVEsRUFDWkMsZUFBaUIsR0FFakIsSUFBSyxJQUFJckMsRUFBSSxFQUFHQSxFQUFJbUMsRUFBbUNuRCxPQUFRZ0IsSUFFM0RWLEVBQU8sSUFBTTZDLEVBQW1DbkMsR0FBRyxJQUNuRFYsRUFBTyxJQUFNNkMsRUFBbUNuQyxHQUFHLEdBRW5Eb0MsR0FBUSxFQUVSQyxlQUFlbkMsS0FBSyxDQUFDWixFQUFPLEdBQUlBLEVBQU8sS0FJM0MsT0FBYSxHQUFUOEMsQ0FLTixFQW9CRixHQ2xEYSxXQUNYLElBQUk1QyxFQUFZNkIsSUFDaEI3QixFQUFVd0MsS0FBTyxZQUNqQixJQUFJdkMsRUFBWTRCLElBQ2hCNUIsRUFBVXVDLEtBQU8sWUFDakIsSUFBSU0sRUFBYy9DLElBQ2RnRCxFQUFjaEQsSUFDbEIrQyxFQUFZL0Isb0JBQ1pnQyxFQUFZaEMsb0JBQ1osSUFDSWlDLEVBQWdCaEQsRUFFcEIsTUFrR01pRCxFQUFnQixTQUFVbkQsRUFBUW9ELEVBQVEvQyxFQUFPRCxHQUNyRCxJQUFJRyxFQUFPRixFQUFNTCxFQUFPLElBQUlBLEVBQU8sSUFJbkMsR0FEQW1DLFFBQVFDLElBQUksWUFBWXBDLEtBQ2lCLEdBQXJDcUQsRUFBVWpELEVBQWdCSixHQUM1Qm1DLFFBQVFDLElBQUksaUJBQ1AsQ0FDTCxHQUFZLEtBQVI3QixFQUNFMkMsR0FBaUJoRCxFQUNuQitDLEVBQVluQyxhQUFhRixLQUFLWixHQUU5QmdELEVBQVlsQyxhQUFhRixLQUFLWixHQUVoQ21DLFFBQVFDLElBQUksUUFDWmtCLEVBQVlGLEdBQ1pHLFFBQ0ssQ0FDTCxJQUFJQyxFQUFnQixHQUNwQkEsRUFBYzVDLEtBQUtaLEVBQU8sSUFDMUJ3RCxFQUFjNUMsS0FBS1osRUFBTyxJQUN0QnFELEVBQVU5QyxFQUFLUCxPQUFRd0QsS0FDekJqRCxFQUFLUixNQUNMMEQsRUFBV0wsR0FDWDdDLEVBQUtULFNBQ0RTLEVBQUtULFdBQ1A0RCxFQUFTbkQsR0FDTDJDLEdBQWlCaEQsRUFDbkIrQyxFQUFZbkIsVUFBVWxCLEtBQUtMLEdBRTNCeUMsRUFBWWxCLFVBQVVsQixLQUFLTCxJQUcvQjRCLFFBQVFDLElBQUksT0FDWm9CLEVBQWdCLEdBQ2hCRCxJQUVKLENBQ0lGLEVBQVVqRCxFQUFnQkosSUFNbEMsU0FBNEIyRCxFQUFLQyxHQUMvQixJQUFLLElBQUlsRCxFQUFJaUQsRUFBSWpFLE9BQVFnQixLQUNuQmlELEVBQUlqRCxHQUFHLElBQU1rRCxFQUFLLElBQU1ELEVBQUlqRCxHQUFHLElBQU1rRCxFQUFLLElBQUlELEVBQUlFLE9BQU9uRCxFQUFHLEVBRXBFLENBVE1vRCxDQUFtQjFELEVBQWdCSixFQUV2QyxDQUNGLEVBUU0wRCxFQUFXLFNBQVVuRCxHQUN6QixJQUFLLElBQUlHLEVBQUksRUFBR0EsRUFBSUgsRUFBS1AsT0FBT04sT0FBUWdCLElBQUssQ0FDM0MsSUFBSXFELEVBQUl4RCxFQUFLUCxPQUFPVSxHQUFHLEdBQ25Cc0QsRUFBSXpELEVBQUtQLE9BQU9VLEdBQUcsR0FDVnVELEVBQWUsQ0FBQ0YsRUFBR0MsSUFDekJ2QyxVQUFVQyxJQUFJLE9BQ3ZCLENBQ0YsRUFFTXVDLEVBQWlCLFNBQVVqRSxHQUMvQixJQUFJa0UsRUFBTWxFLEVBQU8sR0FDYm1FLEVBQU1uRSxFQUFPLEdBQ2JvRSxFQUFVLEdBRVpBLEVBREVsQixHQUFpQi9DLEVBQ1RrQixTQUFTQyx1QkFBdUIscUJBRWhDRCxTQUFTQyx1QkFBdUIsbUJBRTVDLElBQUssSUFBSVosRUFBSSxFQUFHQSxFQUFJMEQsRUFBUTFFLE9BQVFnQixJQUFLLENBQ3ZDLElBQUkyRCxFQUFxQkMsRUFBY0YsRUFBUTFELElBQy9DLEdBQUl3RCxHQUFPRyxFQUFtQixJQUFNRixHQUFPRSxFQUFtQixHQUFJLENBQ2hFLElBQUlFLEVBQWlCSCxFQUFRMUQsR0FFN0IsT0FEQXlCLFFBQVFDLElBQUltQyxHQUNMQSxDQUNULENBQ0YsQ0FDRixFQUVNbEIsRUFBWSxTQUFVbUIsRUFBa0J4RSxHQUM1QyxJQUFJOEMsR0FBUSxFQVFaLE9BUEEwQixFQUFpQkMsU0FBU0MsSUFDcEJBLEVBQUssSUFBTTFFLEVBQU8sSUFBTTBFLEVBQUssSUFBTTFFLEVBQU8sS0FFNUM4QyxHQUFRLEVBQ1YsSUFHVyxHQUFUQSxDQUtOLEVBZ0JNVyxFQUFhLFNBQVVMLEdBQzNCQSxFQUFPM0IsVUFBVUMsSUFBSSxNQUN2QixFQUVNNEIsRUFBYyxTQUFVRixHQUM1QkEsRUFBTzNCLFVBQVVDLElBQUksT0FDdkIsRUE0Qk02QixFQUFhLFdBRWpCLElBWmtDLEdBQWhDUCxFQUFZbEIsVUFBVXBDLFFBQ1UsR0FBaEN1RCxFQUFZbkIsVUFBVXBDLFNBRXRCaUYsTUFBTSxTQVNKekIsR0FBaUJoRCxFQUFXLEVBNUJiLFdBQ25CLElBQUlrRSxFQUFVL0MsU0FBU0MsdUJBQXVCLG1CQUM5QyxJQUFLLElBQUlaLEVBQUksRUFBR0EsRUFBSTBELEVBQVExRSxPQUFRZ0IsSUFDbEMwRCxFQUFRMUQsR0FBR2UsVUFBVUMsSUFBSSxXQUU3QixDQXdCSWtELEdBQ0ExQixFQUFnQi9DLEVBQ2hCLElBQUkwRSxFQUFlM0IsRUFBY2pCLGFBQWFlLEdBQzFDSSxFQUFTYSxFQUFlWSxHQUU1QjFCLEVBQ0UwQixFQUNBekIsRUFDQUosRUFBWTNDLE1BQ1oyQyxFQUFZNUMsZUFFaEIsTUFqQ2tCLFdBQ2xCLElBQUlnRSxFQUFVL0MsU0FBU0MsdUJBQXVCLG1CQUM5QyxJQUFLLElBQUlaLEVBQUksRUFBR0EsRUFBSTBELEVBQVExRSxPQUFRZ0IsSUFDbEMwRCxFQUFRMUQsR0FBR2UsVUFBVXFELE9BQU8sV0FFaEMsQ0E2QklDLEdBQ0E3QixFQUFnQmhELEVBRWxCaUMsUUFBUUMsSUFBSSxRQUNaRCxRQUFRQyxJQUFJYyxFQUNkLEVBRU1vQixFQUFnQixTQUFVMUMsR0FDOUIsSUFBSW9ELEVBQVVwRCxFQUFpQkgsVUFDM0JzQyxFQUFJaUIsRUFBUSxHQUNaaEIsRUFBSSxPQU9SLE9BTldpQixTQUFTRCxFQUFRLElBRTFCaEIsRUFERWlCLFNBQVNELEVBQVEsS0FBTyxFQUN0QkEsRUFBUSxHQUVSQSxFQUFRLEdBRVAsQ0FBQ2pCLEVBQUdDLEVBQ2IsRUFVQSxNQUFPLENBQUVrQixVQVJTLFlBblJVLFdBRTFCLE1BQU1DLEVBQVUxRixFQUFLLEdBQ3JCMEYsRUFBUW5GLE9BQU9ZLEtBQUssQ0FBQyxFQUFHLElBQ3hCdUUsRUFBUW5GLE9BQU9ZLEtBQUssQ0FBQyxFQUFHLElBQ3hCb0MsRUFBWTNDLE1BQU0sR0FBRyxHQUFLOEUsRUFDMUJuQyxFQUFZM0MsTUFBTSxHQUFHLEdBQUs4RSxFQUMxQixNQUFNQyxFQUFXM0YsRUFBSyxHQUd0QjJGLEVBQVNwRixPQUFPWSxLQUFLLENBQUMsRUFBRyxJQUN6QndFLEVBQVNwRixPQUFPWSxLQUFLLENBQUMsRUFBRyxJQUN6QndFLEVBQVNwRixPQUFPWSxLQUFLLENBQUMsRUFBRyxJQUN6Qm9DLEVBQVkzQyxNQUFNLEdBQUcsR0FBSytFLEVBQzFCcEMsRUFBWTNDLE1BQU0sR0FBRyxHQUFLK0UsRUFDMUJwQyxFQUFZM0MsTUFBTSxHQUFHLEdBQUsrRSxFQUMxQixNQUFNQyxFQUFXNUYsRUFBSyxHQUN0QjRGLEVBQVNyRixPQUFPWSxLQUFLLENBQUMsRUFBRyxJQUN6QnlFLEVBQVNyRixPQUFPWSxLQUFLLENBQUMsRUFBRyxJQUN6QnlFLEVBQVNyRixPQUFPWSxLQUFLLENBQUMsRUFBRyxJQUN6Qm9DLEVBQVkzQyxNQUFNLEdBQUcsR0FBS2dGLEVBQzFCckMsRUFBWTNDLE1BQU0sR0FBRyxHQUFLZ0YsRUFDMUJyQyxFQUFZM0MsTUFBTSxHQUFHLEdBQUtnRixFQUMxQixNQUFNQyxFQUFVN0YsRUFBSyxHQUNyQjZGLEVBQVF0RixPQUFPWSxLQUFLLENBQUMsRUFBRyxJQUN4QjBFLEVBQVF0RixPQUFPWSxLQUFLLENBQUMsRUFBRyxJQUN4QjBFLEVBQVF0RixPQUFPWSxLQUFLLENBQUMsRUFBRyxJQUN4QjBFLEVBQVF0RixPQUFPWSxLQUFLLENBQUMsRUFBRyxJQUN4Qm9DLEVBQVkzQyxNQUFNLEdBQUcsR0FBS2lGLEVBQzFCdEMsRUFBWTNDLE1BQU0sR0FBRyxHQUFLaUYsRUFDMUJ0QyxFQUFZM0MsTUFBTSxHQUFHLEdBQUtpRixFQUMxQnRDLEVBQVkzQyxNQUFNLEdBQUcsR0FBS2lGLEVBQzFCLE1BQU1DLEVBQVU5RixFQUFLLEdBQ3JCOEYsRUFBUXZGLE9BQU9ZLEtBQUssQ0FBQyxFQUFHLElBQ3hCMkUsRUFBUXZGLE9BQU9ZLEtBQUssQ0FBQyxFQUFHLElBQ3hCMkUsRUFBUXZGLE9BQU9ZLEtBQUssQ0FBQyxFQUFHLElBQ3hCMkUsRUFBUXZGLE9BQU9ZLEtBQUssQ0FBQyxFQUFHLElBQ3hCMkUsRUFBUXZGLE9BQU9ZLEtBQUssQ0FBQyxFQUFHLElBQ3hCb0MsRUFBWTNDLE1BQU0sR0FBRyxHQUFLa0YsRUFDMUJ2QyxFQUFZM0MsTUFBTSxHQUFHLEdBQUtrRixFQUMxQnZDLEVBQVkzQyxNQUFNLEdBQUcsR0FBS2tGLEVBQzFCdkMsRUFBWTNDLE1BQU0sR0FBRyxHQUFLa0YsRUFDMUJ2QyxFQUFZM0MsTUFBTSxHQUFHLEdBQUtrRixFQUMxQnZDLEVBQVlqQyxhQUFhSCxLQUFLdUUsR0FDOUJuQyxFQUFZakMsYUFBYUgsS0FBS3dFLEdBQzlCcEMsRUFBWWpDLGFBQWFILEtBQUt5RSxHQUM5QnJDLEVBQVlqQyxhQUFhSCxLQUFLMEUsR0FDOUJ0QyxFQUFZakMsYUFBYUgsS0FBSzJFLEVBQ2hDLENBb09FQyxHQWxPMEIsV0FDMUIsTUFBTUMsRUFBVWhHLEVBQUssR0FDckJnRyxFQUFRekYsT0FBT1ksS0FBSyxDQUFDLEVBQUcsSUFDeEI2RSxFQUFRekYsT0FBT1ksS0FBSyxDQUFDLEVBQUcsSUFDeEJxQyxFQUFZNUMsTUFBTSxHQUFHLEdBQUtvRixFQUMxQnhDLEVBQVk1QyxNQUFNLEdBQUcsR0FBS29GLEVBQzFCLE1BQU1DLEVBQVdqRyxFQUFLLEdBQ3RCaUcsRUFBUzFGLE9BQU9ZLEtBQUssQ0FBQyxFQUFHLElBQ3pCOEUsRUFBUzFGLE9BQU9ZLEtBQUssQ0FBQyxFQUFHLElBQ3pCOEUsRUFBUzFGLE9BQU9ZLEtBQUssQ0FBQyxFQUFHLElBQ3pCcUMsRUFBWTVDLE1BQU0sR0FBRyxHQUFLcUYsRUFDMUJ6QyxFQUFZNUMsTUFBTSxHQUFHLEdBQUtxRixFQUMxQnpDLEVBQVk1QyxNQUFNLEdBQUcsR0FBS3FGLEVBQzFCLE1BQU1DLEVBQVdsRyxFQUFLLEdBQ3RCa0csRUFBUzNGLE9BQU9ZLEtBQUssQ0FBQyxFQUFHLElBQ3pCK0UsRUFBUzNGLE9BQU9ZLEtBQUssQ0FBQyxFQUFHLElBQ3pCK0UsRUFBUzNGLE9BQU9ZLEtBQUssQ0FBQyxFQUFHLElBQ3pCcUMsRUFBWTVDLE1BQU0sR0FBRyxHQUFLc0YsRUFDMUIxQyxFQUFZNUMsTUFBTSxHQUFHLEdBQUtzRixFQUMxQjFDLEVBQVk1QyxNQUFNLEdBQUcsR0FBS3NGLEVBQzFCLE1BQU1DLEVBQVVuRyxFQUFLLEdBQ3JCbUcsRUFBUTVGLE9BQU9ZLEtBQUssQ0FBQyxFQUFHLElBQ3hCZ0YsRUFBUTVGLE9BQU9ZLEtBQUssQ0FBQyxFQUFHLElBQ3hCZ0YsRUFBUTVGLE9BQU9ZLEtBQUssQ0FBQyxFQUFHLElBQ3hCZ0YsRUFBUTVGLE9BQU9ZLEtBQUssQ0FBQyxFQUFHLElBQ3hCcUMsRUFBWTVDLE1BQU0sR0FBRyxHQUFLdUYsRUFDMUIzQyxFQUFZNUMsTUFBTSxHQUFHLEdBQUt1RixFQUMxQjNDLEVBQVk1QyxNQUFNLEdBQUcsR0FBS3VGLEVBQzFCM0MsRUFBWTVDLE1BQU0sR0FBRyxHQUFLdUYsRUFDMUIsTUFBTUMsRUFBVXBHLEVBQUssR0FDckJvRyxFQUFRN0YsT0FBT1ksS0FBSyxDQUFDLEVBQUcsSUFDeEJpRixFQUFRN0YsT0FBT1ksS0FBSyxDQUFDLEVBQUcsSUFDeEJpRixFQUFRN0YsT0FBT1ksS0FBSyxDQUFDLEVBQUcsSUFDeEJpRixFQUFRN0YsT0FBT1ksS0FBSyxDQUFDLEVBQUcsSUFDeEJpRixFQUFRN0YsT0FBT1ksS0FBSyxDQUFDLEVBQUcsSUFDeEJxQyxFQUFZNUMsTUFBTSxHQUFHLEdBQUt3RixFQUMxQjVDLEVBQVk1QyxNQUFNLEdBQUcsR0FBS3dGLEVBQzFCNUMsRUFBWTVDLE1BQU0sR0FBRyxHQUFLd0YsRUFDMUI1QyxFQUFZNUMsTUFBTSxHQUFHLEdBQUt3RixFQUMxQjVDLEVBQVk1QyxNQUFNLEdBQUcsR0FBS3dGLEVBRTFCNUMsRUFBWWxDLGFBQWFILEtBQUs2RSxHQUM5QnhDLEVBQVlsQyxhQUFhSCxLQUFLOEUsR0FDOUJ6QyxFQUFZbEMsYUFBYUgsS0FBSytFLEdBQzlCMUMsRUFBWWxDLGFBQWFILEtBQUtnRixHQUM5QjNDLEVBQVlsQyxhQUFhSCxLQUFLaUYsRUFDaEMsQ0FxTEVDLEdBQ0E5QyxFQUFZN0IsWUFDWjhCLEVBQVlwQixvQkF2RlUsV0FDdEIsSUFBSXVDLEVBQVUvQyxTQUFTQyx1QkFBdUIsbUJBQzlDLElBQUssSUFBSVosRUFBSSxFQUFHQSxFQUFJMEQsRUFBUTFFLE9BQVFnQixJQUNsQzBELEVBQVExRCxHQUFHcUYsaUJBQWlCLFNBQVMsS0FDbkM1QyxFQUNFbUIsRUFBY0YsRUFBUTFELElBQ3RCMEQsRUFBUTFELEdBQ1J1QyxFQUFZNUMsTUFDWjRDLEVBQVk3QyxlQUNiLEdBR1AsQ0E0RUU0RixFQUNGLEVBRW9CaEQsY0FBYUMsY0FDbkMsRUNqU2FnRCxHQUNSZixXIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vYmF0dGxlc2hpcC8uL3NyYy9zaGlwLmpzIiwid2VicGFjazovL2JhdHRsZXNoaXAvLi9zcmMvZ2FtZUJvYXJkLmpzIiwid2VicGFjazovL2JhdHRsZXNoaXAvLi9zcmMvcGxheWVyLmpzIiwid2VicGFjazovL2JhdHRsZXNoaXAvLi9zcmMvZ2FtZS5qcyIsIndlYnBhY2s6Ly9iYXR0bGVzaGlwLy4vc3JjL2luZGV4LmpzIl0sInNvdXJjZXNDb250ZW50IjpbImNvbnN0IFNoaXAgPSBmdW5jdGlvbiAobGVuZ3RoKSB7XG4gIGNvbnN0IHNoaXBMZW5ndGggPSBsZW5ndGg7XG4gIGxldCBudW1iZXJPZkhpdHMgPSAwO1xuICBsZXQgc3VuayA9IGZhbHNlO1xuICBsZXQgY29vcmRzID0gW107XG5cbiAgY29uc3QgaGl0ID0gZnVuY3Rpb24gKCkge1xuICAgIG51bWJlck9mSGl0cyArPSAxO1xuICB9O1xuXG4gIGNvbnN0IGlzU3VuayA9IGZ1bmN0aW9uICgpIHtcbiAgICBpZiAobnVtYmVyT2ZIaXRzID49IGxlbmd0aCkge1xuICAgICAgc3VuayA9IHRydWU7XG4gICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9IGVsc2Uge1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgfTtcblxuICByZXR1cm4geyBzaGlwTGVuZ3RoLCBudW1iZXJPZkhpdHMsIGlzU3VuaywgaGl0LCBjb29yZHMsIGxlbmd0aCwgc3VuayB9O1xufTtcblxuZXhwb3J0IHsgU2hpcCB9O1xuIiwiY29uc3QgR2FtZUJvYXJkID0gZnVuY3Rpb24gKHBsYXllck9uZSwgcGxheWVyVHdvKSB7XG4gIGxldCBzaGlwUGxhY2VtZW50TW9kZSA9IFwiaG9yaXpvbnRhbFwiO1xuICBsZXQgY3VycmVudFNoaXBzID0gW107XG4gIGxldCBzdW5rU2hpcHMgPSBbXTtcbiAgY29uc3QgbWlzc2VkQ29vcmRzID0gW107XG4gIGxldCBwb3RlbnRpYWxNb3ZlcyA9IFtdO1xuICBsZXQgY3VycmVudFBsYXllciA9IHBsYXllck9uZTtcblxuICBsZXQgYm9hcmQgPSBbXG4gICAgW1tcIiBcIl0sIFtcIiBcIl0sIFtcIiBcIl0sIFtcIiBcIl0sIFtcIiBcIl0sIFtcIiBcIl0sIFtcIiBcIl0sIFtcIiBcIl0sIFtcIiBcIl0sIFtcIiBcIl1dLFxuICAgIFtbXCIgXCJdLCBbXCIgXCJdLCBbXCIgXCJdLCBbXCIgXCJdLCBbXCIgXCJdLCBbXCIgXCJdLCBbXCIgXCJdLCBbXCIgXCJdLCBbXCIgXCJdLCBbXCIgXCJdXSxcbiAgICBbW1wiIFwiXSwgW1wiIFwiXSwgW1wiIFwiXSwgW1wiIFwiXSwgW1wiIFwiXSwgW1wiIFwiXSwgW1wiIFwiXSwgW1wiIFwiXSwgW1wiIFwiXSwgW1wiIFwiXV0sXG4gICAgW1tcIiBcIl0sIFtcIiBcIl0sIFtcIiBcIl0sIFtcIiBcIl0sIFtcIiBcIl0sIFtcIiBcIl0sIFtcIiBcIl0sIFtcIiBcIl0sIFtcIiBcIl0sIFtcIiBcIl1dLFxuICAgIFtbXCIgXCJdLCBbXCIgXCJdLCBbXCIgXCJdLCBbXCIgXCJdLCBbXCIgXCJdLCBbXCIgXCJdLCBbXCIgXCJdLCBbXCIgXCJdLCBbXCIgXCJdLCBbXCIgXCJdXSxcbiAgICBbW1wiIFwiXSwgW1wiIFwiXSwgW1wiIFwiXSwgW1wiIFwiXSwgW1wiIFwiXSwgW1wiIFwiXSwgW1wiIFwiXSwgW1wiIFwiXSwgW1wiIFwiXSwgW1wiIFwiXV0sXG4gICAgW1tcIiBcIl0sIFtcIiBcIl0sIFtcIiBcIl0sIFtcIiBcIl0sIFtcIiBcIl0sIFtcIiBcIl0sIFtcIiBcIl0sIFtcIiBcIl0sIFtcIiBcIl0sIFtcIiBcIl1dLFxuICAgIFtbXCIgXCJdLCBbXCIgXCJdLCBbXCIgXCJdLCBbXCIgXCJdLCBbXCIgXCJdLCBbXCIgXCJdLCBbXCIgXCJdLCBbXCIgXCJdLCBbXCIgXCJdLCBbXCIgXCJdXSxcbiAgICBbW1wiIFwiXSwgW1wiIFwiXSwgW1wiIFwiXSwgW1wiIFwiXSwgW1wiIFwiXSwgW1wiIFwiXSwgW1wiIFwiXSwgW1wiIFwiXSwgW1wiIFwiXSwgW1wiIFwiXV0sXG4gICAgW1tcIiBcIl0sIFtcIiBcIl0sIFtcIiBcIl0sIFtcIiBcIl0sIFtcIiBcIl0sIFtcIiBcIl0sIFtcIiBcIl0sIFtcIiBcIl0sIFtcIiBcIl0sIFtcIiBcIl1dLFxuICBdO1xuXG4gIGNvbnN0IGdldFBvdGVudGlhbE1vdmVzID0gZnVuY3Rpb24gKCkge1xuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgMTA7IGkrKykge1xuICAgICAgZm9yIChsZXQgYSA9IDA7IGEgPCAxMDsgYSsrKSB7XG4gICAgICAgIHBvdGVudGlhbE1vdmVzLnB1c2goW2EsIGldKTtcbiAgICAgIH1cbiAgICB9XG4gIH07XG5cbiAgLy8gY29uc3Qgc2V0VXBDbGlja1RvSGl0ID0gZnVuY3Rpb24gKCkge1xuICAvLyAgIGxldCBzcXVhcmVzID0gZG9jdW1lbnQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZShcImNvbXB1dGVyLXNxdWFyZVwiKTtcbiAgLy8gICBmb3IgKGxldCBpID0gMDsgaSA8IHNxdWFyZXMubGVuZ3RoOyBpKyspIHtcbiAgLy8gICAgIHNxdWFyZXNbaV0uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgLy8gICAgICAgcmVjZWl2ZUF0dGFjayhjbGFzc1RvQ29vcmRzKHNxdWFyZXNbaV0pLCBzcXVhcmVzW2ldKTtcbiAgLy8gICAgIH0pO1xuICAvLyAgIH1cbiAgLy8gfTtcblxuICAvLyBjb25zdCBkaXNhYmxlQ2xpY2sgPSBmdW5jdGlvbiAoKSB7XG4gIC8vICAgbGV0IHNxdWFyZXMgPSBkb2N1bWVudC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKFwiY29tcHV0ZXItc3F1YXJlXCIpO1xuICAvLyAgIGZvciAobGV0IGkgPSAwOyBpIDwgc3F1YXJlcy5sZW5ndGg7IGkrKykge1xuICAvLyAgICAgc3F1YXJlc1tpXS5jbGFzc0xpc3QuYWRkKFwiZGlzYWJsZWRcIik7XG4gIC8vICAgfVxuICAvLyB9O1xuXG4gIC8vIGNvbnN0IGVuYWJsZUNsaWNrID0gZnVuY3Rpb24gKCkge1xuICAvLyAgIGxldCBzcXVhcmVzID0gZG9jdW1lbnQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZShcImNvbXB1dGVyLXNxdWFyZVwiKTtcbiAgLy8gICBmb3IgKGxldCBpID0gMDsgaSA8IHNxdWFyZXMubGVuZ3RoOyBpKyspIHtcbiAgLy8gICAgIHNxdWFyZXNbaV0uY2xhc3NMaXN0LnJlbW92ZShcImRpc2FibGVkXCIpO1xuICAvLyAgIH1cbiAgLy8gfTtcblxuICBjb25zdCBob3Jpem9udGFsID0gZnVuY3Rpb24gKHNoaXAsIHN0YXJ0Um93Q29vcmRzLCBzdGFydENvbHVtbkNvb3Jkcykge1xuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgc2hpcC5zaGlwTGVuZ3RoOyBpKyspIHtcbiAgICAgIGxldCBjdXJyZW50Q29vcmQgPSBbc3RhcnRSb3dDb29yZHMsIGkgKyBzdGFydENvbHVtbkNvb3Jkc107XG4gICAgICBzaGlwLmNvb3Jkcy5wdXNoKGN1cnJlbnRDb29yZCk7XG4gICAgfVxuICB9O1xuXG4gIGNvbnN0IHZlcnRpY2FsID0gZnVuY3Rpb24gKHNoaXAsIHN0YXJ0Um93Q29vcmRzLCBzdGFydENvbHVtbkNvb3Jkcykge1xuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgc2hpcC5zaGlwTGVuZ3RoOyBpKyspIHtcbiAgICAgIGxldCBjdXJyZW50Q29vcmQgPSBbaSArIHN0YXJ0Um93Q29vcmRzLCBzdGFydENvbHVtbkNvb3Jkc107XG4gICAgICBzaGlwLmNvb3Jkcy5wdXNoKGN1cnJlbnRDb29yZCk7XG4gICAgfVxuICB9O1xuXG4gIGNvbnN0IHBsYWNlU2hpcCA9IGZ1bmN0aW9uIChzaGlwKSB7XG4gICAgc2hpcC5jb29yZHMuZm9yRWFjaCgoY29vcmQpID0+IHtcbiAgICAgIGxldCBvdXRlciA9IGNvb3JkWzBdO1xuICAgICAgbGV0IGlubmVyID0gY29vcmRbMV07XG4gICAgICBib2FyZFtvdXRlcl1baW5uZXJdID0gc2hpcDtcbiAgICB9KTtcbiAgfTtcblxuICBjb25zdCBzZXRTaGlwUG9zaXRpb24gPSBmdW5jdGlvbiAoc2hpcCwgc3RhcnRSb3dDb29yZHMsIHN0YXJ0Q29sdW1uQ29vcmRzKSB7XG4gICAgaWYgKHNoaXBQbGFjZW1lbnRNb2RlID09IFwiaG9yaXpvbnRhbFwiKSB7XG4gICAgICBob3Jpem9udGFsKHNoaXAsIHN0YXJ0Um93Q29vcmRzLCBzdGFydENvbHVtbkNvb3Jkcyk7XG4gICAgfSBlbHNlIGlmIChzaGlwUGxhY2VtZW50TW9kZSA9PSBcInZlcnRpY2FsXCIpIHtcbiAgICAgIHZlcnRpY2FsKHNoaXAsIHN0YXJ0Um93Q29vcmRzLCBzdGFydENvbHVtbkNvb3Jkcyk7XG4gICAgfVxuICB9O1xuXG4gIGNvbnN0IGRyYXdCb2FyZCA9IGZ1bmN0aW9uICgpIHtcbiAgICBjb25zdCBjb250YWluZXIgPSBkb2N1bWVudC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKFwiY29udGFpbmVyXCIpWzBdO1xuICAgIGxldCBib2FyZENvbnRhaW5lciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XG4gICAgYm9hcmRDb250YWluZXIuY2xhc3NMaXN0LmFkZChcImJvYXJkLWNvbnRhaW5lclwiKTtcbiAgICBjb250YWluZXIuYXBwZW5kQ2hpbGQoYm9hcmRDb250YWluZXIpO1xuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgYm9hcmQubGVuZ3RoOyBpKyspIHtcbiAgICAgIGZvciAobGV0IGEgPSAwOyBhIDwgYm9hcmQubGVuZ3RoOyBhKyspIHtcbiAgICAgICAgbGV0IGluZGl2aWR1YWxTcXVhcmUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xuICAgICAgICBpbmRpdmlkdWFsU3F1YXJlLmNsYXNzTGlzdC5hZGQoXCJpbmRpdmlkdWFsLXNxdWFyZVwiKTtcbiAgICAgICAgaW5kaXZpZHVhbFNxdWFyZS5jbGFzc0xpc3QuYWRkKGEpOyAvLyB4XG4gICAgICAgIGluZGl2aWR1YWxTcXVhcmUuY2xhc3NMaXN0LmFkZChpKTsgLy8geVxuICAgICAgICBib2FyZENvbnRhaW5lci5hcHBlbmRDaGlsZChpbmRpdmlkdWFsU3F1YXJlKTtcbiAgICAgICAgaWYgKGJvYXJkW2ldW2FdICE9IFwiIFwiKSB7XG4gICAgICAgICAgaW5kaXZpZHVhbFNxdWFyZS5jbGFzc0xpc3QuYWRkKFwic2hpcFwiKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgfTtcblxuICBjb25zdCBkcmF3Q29tcHV0ZXJCb2FyZCA9IGZ1bmN0aW9uICgpIHtcbiAgICBjb25zdCBjb250YWluZXIgPSBkb2N1bWVudC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKFwiY29udGFpbmVyXCIpWzBdO1xuICAgIGxldCBib2FyZENvbnRhaW5lciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XG4gICAgYm9hcmRDb250YWluZXIuY2xhc3NMaXN0LmFkZChcImJvYXJkLWNvbnRhaW5lclwiKTtcbiAgICBjb250YWluZXIuYXBwZW5kQ2hpbGQoYm9hcmRDb250YWluZXIpO1xuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgYm9hcmQubGVuZ3RoOyBpKyspIHtcbiAgICAgIGZvciAobGV0IGEgPSAwOyBhIDwgYm9hcmQubGVuZ3RoOyBhKyspIHtcbiAgICAgICAgbGV0IGluZGl2aWR1YWxTcXVhcmUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xuICAgICAgICBpbmRpdmlkdWFsU3F1YXJlLmNsYXNzTGlzdC5hZGQoXCJjb21wdXRlci1zcXVhcmVcIik7XG4gICAgICAgIGluZGl2aWR1YWxTcXVhcmUuY2xhc3NMaXN0LmFkZChhKTsgLy8geFxuICAgICAgICBpbmRpdmlkdWFsU3F1YXJlLmNsYXNzTGlzdC5hZGQoaSk7IC8vIHlcbiAgICAgICAgYm9hcmRDb250YWluZXIuYXBwZW5kQ2hpbGQoaW5kaXZpZHVhbFNxdWFyZSk7XG4gICAgICB9XG4gICAgfVxuICB9O1xuXG4gIHJldHVybiB7XG4gICAgYm9hcmQsXG4gICAgaG9yaXpvbnRhbCxcbiAgICB2ZXJ0aWNhbCxcbiAgICBtaXNzZWRDb29yZHMsXG4gICAgY3VycmVudFNoaXBzLFxuICAgIGFsbFN1bmssXG4gICAgZ2V0UG90ZW50aWFsTW92ZXMsXG4gICAgcG90ZW50aWFsTW92ZXMsXG4gICAgZHJhd0JvYXJkLFxuICAgIGRyYXdDb21wdXRlckJvYXJkLFxuICAgIHN1bmtTaGlwcyxcbiAgfTtcbn07XG5cbmV4cG9ydCB7IEdhbWVCb2FyZCB9O1xuXG4vLyBjb25zdCBjaGVja05lc3RlZEFycmF5ID0gZnVuY3Rpb24gKGFycmF5LCBjb29yZHMpIHtcbi8vICAgbGV0IG1hdGNoID0gZmFsc2U7XG4vLyAgIGZvciAobGV0IGkgPSAwOyBpIDwgYXJyYXkubGVuZ3RoOyBpKyspIHtcbi8vICAgICBpZiAoYXJyYXlbaV0uaW5jbHVkZXMoY29vcmRzWzBdKSAmJiBhcnJheVtpXS5pbmNsdWRlcyhjb29yZHNbMV0pKSB7XG4vLyAgICAgICBtYXRjaCA9IHRydWU7XG4vLyAgICAgfVxuLy8gICB9XG4vLyAgIHJldHVybiBtYXRjaDtcbi8vIH07XG4iLCJpbXBvcnQgeyBHYW1lQm9hcmQgfSBmcm9tIFwiLi9nYW1lQm9hcmRcIjtcblxuY29uc3QgUGxheWVyID0gZnVuY3Rpb24gKCkge1xuICBjb25zdCBuYW1lID0gXCJcIjtcbiAgbGV0IGxlZ2FsTW92ZXMgPSBbXTtcbiAgLy8gbGV0IHByZXZpb3VzTW92ZXMgPSBbXTtcbiAgLy8gbGV0IGF2YWlsYWJsZU1vdmVzID0gW107XG5cbiAgY29uc3QgZ2V0TGVnYWxNb3ZlcyA9IGZ1bmN0aW9uIChvcHBvbmVudEdhbWVib2FyZCkge1xuICAgIGxlZ2FsTW92ZXMgPSBbXTtcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IG9wcG9uZW50R2FtZWJvYXJkLmJvYXJkLmxlbmd0aDsgaSsrKSB7XG4gICAgICBmb3IgKGxldCBhID0gMDsgYSA8IDEwOyBhKyspIHtcbiAgICAgICAgaWYgKG9wcG9uZW50R2FtZWJvYXJkLmJvYXJkW2ldW2FdID09IFwiIFwiKSB7XG4gICAgICAgICAgbGVnYWxNb3Zlcy5wdXNoKFtpLCBhXSk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gIH07XG5cbiAgY29uc3QgY2hlY2tNaXNzZWRDb29yZHNGb3JNYXRjaCA9IGZ1bmN0aW9uIChcbiAgICBjb29yZHMsXG4gICAgb3Bwb25lbnRHYW1lYm9hcmRNaXNzZWRDb29yZHNBcnJheVxuICApIHtcbiAgICBsZXQgbWF0Y2ggPSBmYWxzZTtcbiAgICBhdmFpbGFibGVNb3ZlcyA9IFtdO1xuXG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBvcHBvbmVudEdhbWVib2FyZE1pc3NlZENvb3Jkc0FycmF5Lmxlbmd0aDsgaSsrKSB7XG4gICAgICBpZiAoXG4gICAgICAgIGNvb3Jkc1swXSA9PSBvcHBvbmVudEdhbWVib2FyZE1pc3NlZENvb3Jkc0FycmF5W2ldWzBdICYmXG4gICAgICAgIGNvb3Jkc1sxXSA9PSBvcHBvbmVudEdhbWVib2FyZE1pc3NlZENvb3Jkc0FycmF5W2ldWzFdXG4gICAgICApIHtcbiAgICAgICAgbWF0Y2ggPSB0cnVlO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgYXZhaWxhYmxlTW92ZXMucHVzaChbY29vcmRzWzBdLCBjb29yZHNbMV1dKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICBpZiAobWF0Y2ggPT0gdHJ1ZSkge1xuICAgICAgcmV0dXJuIHRydWU7XG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gIH07XG5cbiAgZnVuY3Rpb24gZ2V0UmFuZG9tSW50KG1heCkge1xuICAgIHJldHVybiBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiBtYXgpO1xuICB9XG5cbiAgY29uc3QgcmFuZG9tQXR0YWNrID0gZnVuY3Rpb24gKG9wcG9uZW50R2FtZWJvYXJkKSB7XG4gICAgY29uc29sZS5sb2coXCJyYW5kb20gYXR0YWNrXCIpO1xuICAgIGxldCByYW5kb21JbmRleCA9IGdldFJhbmRvbUludChvcHBvbmVudEdhbWVib2FyZC5wb3RlbnRpYWxNb3Zlcy5sZW5ndGggLSAxKTtcbiAgICBsZXQgcmFuZG9tTW92ZSA9IG9wcG9uZW50R2FtZWJvYXJkLnBvdGVudGlhbE1vdmVzW3JhbmRvbUluZGV4XTtcbiAgICByZXR1cm4gcmFuZG9tTW92ZTtcbiAgfTtcblxuICByZXR1cm4ge1xuICAgIG5hbWUsXG4gICAgcmFuZG9tQXR0YWNrLFxuICAgIGdldExlZ2FsTW92ZXMsXG4gICAgcmFuZG9tQXR0YWNrLFxuICAgIGNoZWNrTWlzc2VkQ29vcmRzRm9yTWF0Y2gsXG4gIH07XG59O1xuXG5leHBvcnQgeyBQbGF5ZXIgfTtcbiIsImltcG9ydCB7IFNoaXAgfSBmcm9tIFwiLi9zaGlwXCI7XG5pbXBvcnQgeyBHYW1lQm9hcmQgfSBmcm9tIFwiLi9nYW1lQm9hcmRcIjtcbmltcG9ydCB7IFBsYXllciB9IGZyb20gXCIuL3BsYXllclwiO1xuXG4vLyBuZWVkIHRvIGNoYW5nZSBpZHMgb24gZWFjaCBnYW1lYm9hcmRcbi8vIGFkZCBpbiBzd2Fwc1xuLy8gZG9udCBhbGxvdyBhdHRhY2tpbmcgb3duIGdhbWVib2FyZFxuLy8gbWFrZSBjb21wdXRlciBtYWtlIG1vdmUgb24gaXRzIGdvXG4vL3NldCB0aW1lb3V0IHRvIGRlbGF5IG1vdmVcbi8vIGRpc3BsYXkgY2hhbmdlXG4vLyBlbmQgYXQgd2luXG5cbmNvbnN0IEdhbWUgPSBmdW5jdGlvbiAoKSB7XG4gIGxldCBwbGF5ZXJPbmUgPSBQbGF5ZXIoKTtcbiAgcGxheWVyT25lLm5hbWUgPSBcInBsYXllck9uZVwiO1xuICBsZXQgcGxheWVyVHdvID0gUGxheWVyKCk7XG4gIHBsYXllclR3by5uYW1lID0gXCJwbGF5ZXJUd29cIjtcbiAgbGV0IHAxR2FtZWJvYXJkID0gR2FtZUJvYXJkKHBsYXllck9uZSwgcGxheWVyVHdvKTtcbiAgbGV0IHAyR2FtZWJvYXJkID0gR2FtZUJvYXJkKHBsYXllck9uZSwgcGxheWVyVHdvKTtcbiAgcDFHYW1lYm9hcmQuZ2V0UG90ZW50aWFsTW92ZXMoKTtcbiAgcDJHYW1lYm9hcmQuZ2V0UG90ZW50aWFsTW92ZXMoKTtcbiAgbGV0IHdpbiA9IGZhbHNlO1xuICBsZXQgY3VycmVudFBsYXllciA9IHBsYXllck9uZTtcblxuICBjb25zdCBzZXRVcFBsYXllck9uZVNoaXBzID0gZnVuY3Rpb24gKCkge1xuICAgIC8vIHAxR2FtZWJvYXJkID0gR2FtZUJvYXJkKCk7XG4gICAgY29uc3QgcDFzaGlwMiA9IFNoaXAoMik7XG4gICAgcDFzaGlwMi5jb29yZHMucHVzaChbMCwgMF0pO1xuICAgIHAxc2hpcDIuY29vcmRzLnB1c2goWzAsIDFdKTtcbiAgICBwMUdhbWVib2FyZC5ib2FyZFswXVswXSA9IHAxc2hpcDI7XG4gICAgcDFHYW1lYm9hcmQuYm9hcmRbMF1bMV0gPSBwMXNoaXAyO1xuICAgIGNvbnN0IHAxc2hpcDNhID0gU2hpcCgzKTtcbiAgICAvLyBjb25zb2xlLmxvZyhgYWJjJHtwMXNoaXAzYS5sZW5ndGh9YCk7XG5cbiAgICBwMXNoaXAzYS5jb29yZHMucHVzaChbMSwgMF0pO1xuICAgIHAxc2hpcDNhLmNvb3Jkcy5wdXNoKFsxLCAxXSk7XG4gICAgcDFzaGlwM2EuY29vcmRzLnB1c2goWzEsIDJdKTtcbiAgICBwMUdhbWVib2FyZC5ib2FyZFsxXVswXSA9IHAxc2hpcDNhO1xuICAgIHAxR2FtZWJvYXJkLmJvYXJkWzFdWzFdID0gcDFzaGlwM2E7XG4gICAgcDFHYW1lYm9hcmQuYm9hcmRbMV1bMl0gPSBwMXNoaXAzYTtcbiAgICBjb25zdCBwMXNoaXAzYiA9IFNoaXAoMyk7XG4gICAgcDFzaGlwM2IuY29vcmRzLnB1c2goWzIsIDBdKTtcbiAgICBwMXNoaXAzYi5jb29yZHMucHVzaChbMiwgMV0pO1xuICAgIHAxc2hpcDNiLmNvb3Jkcy5wdXNoKFsyLCAyXSk7XG4gICAgcDFHYW1lYm9hcmQuYm9hcmRbMl1bMF0gPSBwMXNoaXAzYjtcbiAgICBwMUdhbWVib2FyZC5ib2FyZFsyXVsxXSA9IHAxc2hpcDNiO1xuICAgIHAxR2FtZWJvYXJkLmJvYXJkWzJdWzJdID0gcDFzaGlwM2I7XG4gICAgY29uc3QgcDFzaGlwNCA9IFNoaXAoNCk7XG4gICAgcDFzaGlwNC5jb29yZHMucHVzaChbMywgMF0pO1xuICAgIHAxc2hpcDQuY29vcmRzLnB1c2goWzMsIDFdKTtcbiAgICBwMXNoaXA0LmNvb3Jkcy5wdXNoKFszLCAyXSk7XG4gICAgcDFzaGlwNC5jb29yZHMucHVzaChbMywgM10pO1xuICAgIHAxR2FtZWJvYXJkLmJvYXJkWzNdWzBdID0gcDFzaGlwNDtcbiAgICBwMUdhbWVib2FyZC5ib2FyZFszXVsxXSA9IHAxc2hpcDQ7XG4gICAgcDFHYW1lYm9hcmQuYm9hcmRbM11bMl0gPSBwMXNoaXA0O1xuICAgIHAxR2FtZWJvYXJkLmJvYXJkWzNdWzNdID0gcDFzaGlwNDtcbiAgICBjb25zdCBwMXNoaXA1ID0gU2hpcCg1KTtcbiAgICBwMXNoaXA1LmNvb3Jkcy5wdXNoKFs0LCAwXSk7XG4gICAgcDFzaGlwNS5jb29yZHMucHVzaChbNCwgMV0pO1xuICAgIHAxc2hpcDUuY29vcmRzLnB1c2goWzQsIDJdKTtcbiAgICBwMXNoaXA1LmNvb3Jkcy5wdXNoKFs0LCAzXSk7XG4gICAgcDFzaGlwNS5jb29yZHMucHVzaChbNCwgNF0pO1xuICAgIHAxR2FtZWJvYXJkLmJvYXJkWzRdWzBdID0gcDFzaGlwNTtcbiAgICBwMUdhbWVib2FyZC5ib2FyZFs0XVsxXSA9IHAxc2hpcDU7XG4gICAgcDFHYW1lYm9hcmQuYm9hcmRbNF1bMl0gPSBwMXNoaXA1O1xuICAgIHAxR2FtZWJvYXJkLmJvYXJkWzRdWzNdID0gcDFzaGlwNTtcbiAgICBwMUdhbWVib2FyZC5ib2FyZFs0XVs0XSA9IHAxc2hpcDU7XG4gICAgcDFHYW1lYm9hcmQuY3VycmVudFNoaXBzLnB1c2gocDFzaGlwMik7XG4gICAgcDFHYW1lYm9hcmQuY3VycmVudFNoaXBzLnB1c2gocDFzaGlwM2EpO1xuICAgIHAxR2FtZWJvYXJkLmN1cnJlbnRTaGlwcy5wdXNoKHAxc2hpcDNiKTtcbiAgICBwMUdhbWVib2FyZC5jdXJyZW50U2hpcHMucHVzaChwMXNoaXA0KTtcbiAgICBwMUdhbWVib2FyZC5jdXJyZW50U2hpcHMucHVzaChwMXNoaXA1KTtcbiAgfTtcblxuICBjb25zdCBzZXRVcFBsYXllclR3b1NoaXBzID0gZnVuY3Rpb24gKCkge1xuICAgIGNvbnN0IHAyc2hpcDIgPSBTaGlwKDIpO1xuICAgIHAyc2hpcDIuY29vcmRzLnB1c2goWzAsIDBdKTtcbiAgICBwMnNoaXAyLmNvb3Jkcy5wdXNoKFswLCAxXSk7XG4gICAgcDJHYW1lYm9hcmQuYm9hcmRbMF1bMF0gPSBwMnNoaXAyO1xuICAgIHAyR2FtZWJvYXJkLmJvYXJkWzBdWzFdID0gcDJzaGlwMjtcbiAgICBjb25zdCBwMnNoaXAzYSA9IFNoaXAoMyk7XG4gICAgcDJzaGlwM2EuY29vcmRzLnB1c2goWzEsIDBdKTtcbiAgICBwMnNoaXAzYS5jb29yZHMucHVzaChbMSwgMV0pO1xuICAgIHAyc2hpcDNhLmNvb3Jkcy5wdXNoKFsxLCAyXSk7XG4gICAgcDJHYW1lYm9hcmQuYm9hcmRbMV1bMF0gPSBwMnNoaXAzYTtcbiAgICBwMkdhbWVib2FyZC5ib2FyZFsxXVsxXSA9IHAyc2hpcDNhO1xuICAgIHAyR2FtZWJvYXJkLmJvYXJkWzFdWzJdID0gcDJzaGlwM2E7XG4gICAgY29uc3QgcDJzaGlwM2IgPSBTaGlwKDMpO1xuICAgIHAyc2hpcDNiLmNvb3Jkcy5wdXNoKFsyLCAwXSk7XG4gICAgcDJzaGlwM2IuY29vcmRzLnB1c2goWzIsIDFdKTtcbiAgICBwMnNoaXAzYi5jb29yZHMucHVzaChbMiwgMl0pO1xuICAgIHAyR2FtZWJvYXJkLmJvYXJkWzJdWzBdID0gcDJzaGlwM2I7XG4gICAgcDJHYW1lYm9hcmQuYm9hcmRbMl1bMV0gPSBwMnNoaXAzYjtcbiAgICBwMkdhbWVib2FyZC5ib2FyZFsyXVsyXSA9IHAyc2hpcDNiO1xuICAgIGNvbnN0IHAyc2hpcDQgPSBTaGlwKDQpO1xuICAgIHAyc2hpcDQuY29vcmRzLnB1c2goWzMsIDBdKTtcbiAgICBwMnNoaXA0LmNvb3Jkcy5wdXNoKFszLCAxXSk7XG4gICAgcDJzaGlwNC5jb29yZHMucHVzaChbMywgMl0pO1xuICAgIHAyc2hpcDQuY29vcmRzLnB1c2goWzMsIDNdKTtcbiAgICBwMkdhbWVib2FyZC5ib2FyZFszXVswXSA9IHAyc2hpcDQ7XG4gICAgcDJHYW1lYm9hcmQuYm9hcmRbM11bMV0gPSBwMnNoaXA0O1xuICAgIHAyR2FtZWJvYXJkLmJvYXJkWzNdWzJdID0gcDJzaGlwNDtcbiAgICBwMkdhbWVib2FyZC5ib2FyZFszXVszXSA9IHAyc2hpcDQ7XG4gICAgY29uc3QgcDJzaGlwNSA9IFNoaXAoNSk7XG4gICAgcDJzaGlwNS5jb29yZHMucHVzaChbNCwgMF0pO1xuICAgIHAyc2hpcDUuY29vcmRzLnB1c2goWzQsIDFdKTtcbiAgICBwMnNoaXA1LmNvb3Jkcy5wdXNoKFs0LCAyXSk7XG4gICAgcDJzaGlwNS5jb29yZHMucHVzaChbNCwgM10pO1xuICAgIHAyc2hpcDUuY29vcmRzLnB1c2goWzQsIDRdKTtcbiAgICBwMkdhbWVib2FyZC5ib2FyZFs0XVswXSA9IHAyc2hpcDU7XG4gICAgcDJHYW1lYm9hcmQuYm9hcmRbNF1bMV0gPSBwMnNoaXA1O1xuICAgIHAyR2FtZWJvYXJkLmJvYXJkWzRdWzJdID0gcDJzaGlwNTtcbiAgICBwMkdhbWVib2FyZC5ib2FyZFs0XVszXSA9IHAyc2hpcDU7XG4gICAgcDJHYW1lYm9hcmQuYm9hcmRbNF1bNF0gPSBwMnNoaXA1O1xuXG4gICAgcDJHYW1lYm9hcmQuY3VycmVudFNoaXBzLnB1c2gocDJzaGlwMik7XG4gICAgcDJHYW1lYm9hcmQuY3VycmVudFNoaXBzLnB1c2gocDJzaGlwM2EpO1xuICAgIHAyR2FtZWJvYXJkLmN1cnJlbnRTaGlwcy5wdXNoKHAyc2hpcDNiKTtcbiAgICBwMkdhbWVib2FyZC5jdXJyZW50U2hpcHMucHVzaChwMnNoaXA0KTtcbiAgICBwMkdhbWVib2FyZC5jdXJyZW50U2hpcHMucHVzaChwMnNoaXA1KTtcbiAgfTtcblxuICBjb25zdCByZWNlaXZlQXR0YWNrID0gZnVuY3Rpb24gKGNvb3Jkcywgc3F1YXJlLCBib2FyZCwgcG90ZW50aWFsTW92ZXMpIHtcbiAgICBsZXQgc2hpcCA9IGJvYXJkW2Nvb3Jkc1sxXV1bY29vcmRzWzBdXTsgLy8geCBhbmQgeSBtdXN0IGJlIHN3YXBwZWQgZm9yIGdhbWUgYm9hcmRcblxuICAgIC8vIGlmIG5vdCBhIGxlZ2FsIG1vdmUsIHJldHJ5XG4gICAgY29uc29sZS5sb2coYGNvb3JkcyA9ICR7Y29vcmRzfWApO1xuICAgIGlmIChtYXRjaE1vdmUocG90ZW50aWFsTW92ZXMsIGNvb3JkcykgPT0gZmFsc2UpIHtcbiAgICAgIGNvbnNvbGUubG9nKFwiUmV0cnkgYnJvXCIpO1xuICAgIH0gZWxzZSB7XG4gICAgICBpZiAoc2hpcCA9PSBcIiBcIikge1xuICAgICAgICBpZiAoY3VycmVudFBsYXllciA9PSBwbGF5ZXJPbmUpIHtcbiAgICAgICAgICBwMkdhbWVib2FyZC5taXNzZWRDb29yZHMucHVzaChjb29yZHMpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHAxR2FtZWJvYXJkLm1pc3NlZENvb3Jkcy5wdXNoKGNvb3Jkcyk7XG4gICAgICAgIH1cbiAgICAgICAgY29uc29sZS5sb2coXCJtaXNzXCIpO1xuICAgICAgICBkaXNwbGF5TWlzcyhzcXVhcmUpO1xuICAgICAgICBzd2FwUGxheWVyKCk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBsZXQgc3dhcHBlZENvb3JkcyA9IFtdO1xuICAgICAgICBzd2FwcGVkQ29vcmRzLnB1c2goY29vcmRzWzFdKTtcbiAgICAgICAgc3dhcHBlZENvb3Jkcy5wdXNoKGNvb3Jkc1swXSk7XG4gICAgICAgIGlmIChtYXRjaE1vdmUoc2hpcC5jb29yZHMsIHN3YXBwZWRDb29yZHMpKSB7XG4gICAgICAgICAgc2hpcC5oaXQoKTtcbiAgICAgICAgICBkaXNwbGF5SGl0KHNxdWFyZSk7XG4gICAgICAgICAgc2hpcC5pc1N1bmsoKTtcbiAgICAgICAgICBpZiAoc2hpcC5pc1N1bmsoKSkge1xuICAgICAgICAgICAgc2hpcFN1bmsoc2hpcCk7XG4gICAgICAgICAgICBpZiAoY3VycmVudFBsYXllciA9PSBwbGF5ZXJPbmUpIHtcbiAgICAgICAgICAgICAgcDJHYW1lYm9hcmQuc3Vua1NoaXBzLnB1c2goc2hpcCk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICBwMUdhbWVib2FyZC5zdW5rU2hpcHMucHVzaChzaGlwKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgICAgY29uc29sZS5sb2coXCJoaXRcIik7XG4gICAgICAgICAgc3dhcHBlZENvb3JkcyA9IFtdO1xuICAgICAgICAgIHN3YXBQbGF5ZXIoKTsgLy8gc3dhcFxuICAgICAgICB9XG4gICAgICB9XG4gICAgICBpZiAobWF0Y2hNb3ZlKHBvdGVudGlhbE1vdmVzLCBjb29yZHMpKSB7XG4gICAgICAgIHJlbW92ZUFsbEluc3RhbmNlcyhwb3RlbnRpYWxNb3ZlcywgY29vcmRzKTsgLy8gbmVlZCB0byBjb2RlIHRoaXNcbiAgICAgIH1cbiAgICB9XG4gIH07XG5cbiAgZnVuY3Rpb24gcmVtb3ZlQWxsSW5zdGFuY2VzKGFyciwgaXRlbSkge1xuICAgIGZvciAobGV0IGkgPSBhcnIubGVuZ3RoOyBpLS07ICkge1xuICAgICAgaWYgKGFycltpXVswXSA9PSBpdGVtWzBdICYmIGFycltpXVsxXSA9PSBpdGVtWzFdKSBhcnIuc3BsaWNlKGksIDEpO1xuICAgIH1cbiAgfVxuXG4gIGNvbnN0IHNoaXBTdW5rID0gZnVuY3Rpb24gKHNoaXApIHtcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IHNoaXAuY29vcmRzLmxlbmd0aDsgaSsrKSB7XG4gICAgICBsZXQgeCA9IHNoaXAuY29vcmRzW2ldWzFdO1xuICAgICAgbGV0IHkgPSBzaGlwLmNvb3Jkc1tpXVswXTtcbiAgICAgIGxldCBzcXVhcmUgPSBjb29yZHNUb1NxdWFyZShbeCwgeV0pO1xuICAgICAgc3F1YXJlLmNsYXNzTGlzdC5hZGQoXCJzdW5rXCIpO1xuICAgIH1cbiAgfTtcblxuICBjb25zdCBjb29yZHNUb1NxdWFyZSA9IGZ1bmN0aW9uIChjb29yZHMpIHtcbiAgICBsZXQgY29YID0gY29vcmRzWzBdO1xuICAgIGxldCBjb1kgPSBjb29yZHNbMV07XG4gICAgbGV0IHNxdWFyZXMgPSBcIlwiO1xuICAgIGlmIChjdXJyZW50UGxheWVyID09IHBsYXllclR3bykge1xuICAgICAgc3F1YXJlcyA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoXCJpbmRpdmlkdWFsLXNxdWFyZVwiKTtcbiAgICB9IGVsc2Uge1xuICAgICAgc3F1YXJlcyA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoXCJjb21wdXRlci1zcXVhcmVcIik7XG4gICAgfVxuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgc3F1YXJlcy5sZW5ndGg7IGkrKykge1xuICAgICAgbGV0IHJhbmRvbUF0dGFja0Nvb3JkcyA9IGNsYXNzVG9Db29yZHMoc3F1YXJlc1tpXSk7XG4gICAgICBpZiAoY29YID09IHJhbmRvbUF0dGFja0Nvb3Jkc1swXSAmJiBjb1kgPT0gcmFuZG9tQXR0YWNrQ29vcmRzWzFdKSB7XG4gICAgICAgIGxldCBzcXVhcmVUb0F0dGFjayA9IHNxdWFyZXNbaV07XG4gICAgICAgIGNvbnNvbGUubG9nKHNxdWFyZVRvQXR0YWNrKTtcbiAgICAgICAgcmV0dXJuIHNxdWFyZVRvQXR0YWNrO1xuICAgICAgfVxuICAgIH1cbiAgfTtcblxuICBjb25zdCBtYXRjaE1vdmUgPSBmdW5jdGlvbiAoYXJyYXlUb0ZpbmRNYXRjaCwgY29vcmRzKSB7XG4gICAgbGV0IG1hdGNoID0gZmFsc2U7XG4gICAgYXJyYXlUb0ZpbmRNYXRjaC5mb3JFYWNoKChtb3ZlKSA9PiB7XG4gICAgICBpZiAobW92ZVswXSA9PSBjb29yZHNbMF0gJiYgbW92ZVsxXSA9PSBjb29yZHNbMV0pIHtcbiAgICAgICAgLy8gY29uc29sZS5sb2coXCJ0cnVlXCIpO1xuICAgICAgICBtYXRjaCA9IHRydWU7XG4gICAgICB9XG4gICAgfSk7XG5cbiAgICBpZiAobWF0Y2ggPT0gdHJ1ZSkge1xuICAgICAgcmV0dXJuIHRydWU7XG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gIH07XG5cbiAgY29uc3Qgc2V0VXBDbGlja1RvSGl0ID0gZnVuY3Rpb24gKCkge1xuICAgIGxldCBzcXVhcmVzID0gZG9jdW1lbnQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZShcImNvbXB1dGVyLXNxdWFyZVwiKTtcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IHNxdWFyZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgIHNxdWFyZXNbaV0uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgICAgICAgcmVjZWl2ZUF0dGFjayhcbiAgICAgICAgICBjbGFzc1RvQ29vcmRzKHNxdWFyZXNbaV0pLFxuICAgICAgICAgIHNxdWFyZXNbaV0sXG4gICAgICAgICAgcDJHYW1lYm9hcmQuYm9hcmQsXG4gICAgICAgICAgcDJHYW1lYm9hcmQucG90ZW50aWFsTW92ZXNcbiAgICAgICAgKTtcbiAgICAgIH0pO1xuICAgIH1cbiAgfTtcblxuICBjb25zdCBkaXNwbGF5SGl0ID0gZnVuY3Rpb24gKHNxdWFyZSkge1xuICAgIHNxdWFyZS5jbGFzc0xpc3QuYWRkKFwiaGl0XCIpO1xuICB9O1xuXG4gIGNvbnN0IGRpc3BsYXlNaXNzID0gZnVuY3Rpb24gKHNxdWFyZSkge1xuICAgIHNxdWFyZS5jbGFzc0xpc3QuYWRkKFwibWlzc1wiKTtcbiAgfTtcblxuICBjb25zdCBkaXNhYmxlQ2xpY2sgPSBmdW5jdGlvbiAoKSB7XG4gICAgbGV0IHNxdWFyZXMgPSBkb2N1bWVudC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKFwiY29tcHV0ZXItc3F1YXJlXCIpO1xuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgc3F1YXJlcy5sZW5ndGg7IGkrKykge1xuICAgICAgc3F1YXJlc1tpXS5jbGFzc0xpc3QuYWRkKFwiZGlzYWJsZWRcIik7XG4gICAgfVxuICB9O1xuXG4gIGNvbnN0IGVuYWJsZUNsaWNrID0gZnVuY3Rpb24gKCkge1xuICAgIGxldCBzcXVhcmVzID0gZG9jdW1lbnQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZShcImNvbXB1dGVyLXNxdWFyZVwiKTtcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IHNxdWFyZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgIHNxdWFyZXNbaV0uY2xhc3NMaXN0LnJlbW92ZShcImRpc2FibGVkXCIpO1xuICAgIH1cbiAgfTtcblxuICBjb25zdCBhbGxTdW5rID0gZnVuY3Rpb24gKCkge1xuICAgIGlmIChcbiAgICAgIHAxR2FtZWJvYXJkLnN1bmtTaGlwcy5sZW5ndGggPT0gNSB8fFxuICAgICAgcDJHYW1lYm9hcmQuc3Vua1NoaXBzLmxlbmd0aCA9PSA1XG4gICAgKSB7XG4gICAgICBhbGVydChcIkRPTkUhXCIpO1xuICAgICAgcmV0dXJuIHRydWU7XG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gIH07XG5cbiAgY29uc3Qgc3dhcFBsYXllciA9IGZ1bmN0aW9uICgpIHtcbiAgICBhbGxTdW5rKCk7XG4gICAgaWYgKGN1cnJlbnRQbGF5ZXIgPT0gcGxheWVyT25lKSB7XG4gICAgICBkaXNhYmxlQ2xpY2soKTtcbiAgICAgIGN1cnJlbnRQbGF5ZXIgPSBwbGF5ZXJUd287XG4gICAgICBsZXQgcmFuZG9tQ29vcmRzID0gY3VycmVudFBsYXllci5yYW5kb21BdHRhY2socDFHYW1lYm9hcmQpO1xuICAgICAgbGV0IHNxdWFyZSA9IGNvb3Jkc1RvU3F1YXJlKHJhbmRvbUNvb3Jkcyk7XG5cbiAgICAgIHJlY2VpdmVBdHRhY2soXG4gICAgICAgIHJhbmRvbUNvb3JkcyxcbiAgICAgICAgc3F1YXJlLFxuICAgICAgICBwMUdhbWVib2FyZC5ib2FyZCxcbiAgICAgICAgcDFHYW1lYm9hcmQucG90ZW50aWFsTW92ZXNcbiAgICAgICk7XG4gICAgfSBlbHNlIHtcbiAgICAgIGVuYWJsZUNsaWNrKCk7XG4gICAgICBjdXJyZW50UGxheWVyID0gcGxheWVyT25lO1xuICAgIH1cbiAgICBjb25zb2xlLmxvZyhcInN3YXBcIik7XG4gICAgY29uc29sZS5sb2coY3VycmVudFBsYXllcik7XG4gIH07XG5cbiAgY29uc3QgY2xhc3NUb0Nvb3JkcyA9IGZ1bmN0aW9uIChpbmRpdmlkdWFsU3F1YXJlKSB7XG4gICAgbGV0IGNsYXNzZXMgPSBpbmRpdmlkdWFsU3F1YXJlLmNsYXNzTGlzdDtcbiAgICBsZXQgeCA9IGNsYXNzZXNbMV07XG4gICAgbGV0IHkgPSBcIm9vcHNcIjsgLy8gdG8gc3RvcCBlcnJvcnNcbiAgICBsZXQgdGVtcCA9IHBhcnNlSW50KGNsYXNzZXNbMl0pO1xuICAgIGlmIChwYXJzZUludChjbGFzc2VzWzJdKSA+PSAwKSB7XG4gICAgICB5ID0gY2xhc3Nlc1syXTtcbiAgICB9IGVsc2Uge1xuICAgICAgeSA9IGNsYXNzZXNbMV07XG4gICAgfVxuICAgIHJldHVybiBbeCwgeV07XG4gIH07XG5cbiAgY29uc3Qgc2V0VXBHYW1lID0gZnVuY3Rpb24gKCkge1xuICAgIHNldFVwUGxheWVyT25lU2hpcHMoKTtcbiAgICBzZXRVcFBsYXllclR3b1NoaXBzKCk7XG4gICAgcDFHYW1lYm9hcmQuZHJhd0JvYXJkKCk7XG4gICAgcDJHYW1lYm9hcmQuZHJhd0NvbXB1dGVyQm9hcmQoKTtcbiAgICBzZXRVcENsaWNrVG9IaXQoKTtcbiAgfTtcblxuICByZXR1cm4geyBzZXRVcEdhbWUsIHAxR2FtZWJvYXJkLCBwMkdhbWVib2FyZCB9O1xufTtcblxuZXhwb3J0IHsgR2FtZSB9O1xuIiwiaW1wb3J0IHsgU2hpcCB9IGZyb20gXCIuL3NoaXBcIjtcbmltcG9ydCB7IEdhbWVCb2FyZCB9IGZyb20gXCIuL2dhbWVCb2FyZFwiO1xuaW1wb3J0IHsgUGxheWVyIH0gZnJvbSBcIi4vcGxheWVyXCI7XG5pbXBvcnQgeyBHYW1lIH0gZnJvbSBcIi4vZ2FtZVwiO1xuXG4vLyBjb25zdCBnYjEgPSBHYW1lQm9hcmQoKTtcbi8vIGNvbnN0IGdiMiA9IEdhbWVCb2FyZCgpO1xuXG4vLyAvLyBjb25zdCBnYW1lID0gR2FtZSgpO1xuLy8gLy8gY29uc3QgcGxheWVyID0gUGxheWVyKCk7XG4vLyAvLyBjb25zdCBzaGlwID0gU2hpcCgpO1xuLy8gLy8gc2hpcC5jb29yZHMucHVzaChbMCwgMV0pO1xuLy8gLy8gZ2IuZ2V0UG90ZW50aWFsTW92ZXMoKTtcbi8vIC8vIGxldCBtb3ZlcyA9IGdiLnBvdGVudGlhbE1vdmVzO1xuLy8gLy8gY29uc29sZS5sb2coZ2IucG90ZW50aWFsTW92ZXMubGVuZ3RoKSA7XG4vLyAvLyBnYi5yZWNlaXZlQXR0YWNrKHNoaXAsIFswLCAzXSk7XG4vLyAvLyBjb25zb2xlLmxvZyhnYi5wb3RlbnRpYWxNb3Zlcy5sZW5ndGgpO1xuLy8gZ2IxLmRyYXdCb2FyZCgpO1xuLy8gZ2IyLmRyYXdCb2FyZCgpO1xuY29uc3QgZ2FtZSA9IEdhbWUoKTtcbmdhbWUuc2V0VXBHYW1lKCk7XG5cbi8vIGdhbWUucDFHYW1lYm9hcmQuZHJhd0JvYXJkKCk7XG4vLyBnYW1lLnAyR2FtZWJvYXJkLmRyYXdDb21wdXRlckJvYXJkKCk7XG4vLyBnYW1lLnAxR2FtZWJvYXJkLnNldFVwQ2xpY2tUb0hpdCgpO1xuLy8gZ2FtZS5wMkdhbWVib2FyZC5zZXRVcENsaWNrVG9IaXQoKTtcbiJdLCJuYW1lcyI6WyJTaGlwIiwibGVuZ3RoIiwibnVtYmVyT2ZIaXRzIiwic3VuayIsInNoaXBMZW5ndGgiLCJpc1N1bmsiLCJoaXQiLCJjb29yZHMiLCJHYW1lQm9hcmQiLCJwbGF5ZXJPbmUiLCJwbGF5ZXJUd28iLCJwb3RlbnRpYWxNb3ZlcyIsImJvYXJkIiwiaG9yaXpvbnRhbCIsInNoaXAiLCJzdGFydFJvd0Nvb3JkcyIsInN0YXJ0Q29sdW1uQ29vcmRzIiwiaSIsImN1cnJlbnRDb29yZCIsInB1c2giLCJ2ZXJ0aWNhbCIsIm1pc3NlZENvb3JkcyIsImN1cnJlbnRTaGlwcyIsImFsbFN1bmsiLCJnZXRQb3RlbnRpYWxNb3ZlcyIsImEiLCJkcmF3Qm9hcmQiLCJjb250YWluZXIiLCJkb2N1bWVudCIsImdldEVsZW1lbnRzQnlDbGFzc05hbWUiLCJib2FyZENvbnRhaW5lciIsImNyZWF0ZUVsZW1lbnQiLCJjbGFzc0xpc3QiLCJhZGQiLCJhcHBlbmRDaGlsZCIsImluZGl2aWR1YWxTcXVhcmUiLCJkcmF3Q29tcHV0ZXJCb2FyZCIsInN1bmtTaGlwcyIsIlBsYXllciIsImxlZ2FsTW92ZXMiLCJyYW5kb21BdHRhY2siLCJvcHBvbmVudEdhbWVib2FyZCIsImNvbnNvbGUiLCJsb2ciLCJyYW5kb21JbmRleCIsIm1heCIsIk1hdGgiLCJmbG9vciIsInJhbmRvbSIsIm5hbWUiLCJnZXRMZWdhbE1vdmVzIiwiY2hlY2tNaXNzZWRDb29yZHNGb3JNYXRjaCIsIm9wcG9uZW50R2FtZWJvYXJkTWlzc2VkQ29vcmRzQXJyYXkiLCJtYXRjaCIsImF2YWlsYWJsZU1vdmVzIiwicDFHYW1lYm9hcmQiLCJwMkdhbWVib2FyZCIsImN1cnJlbnRQbGF5ZXIiLCJyZWNlaXZlQXR0YWNrIiwic3F1YXJlIiwibWF0Y2hNb3ZlIiwiZGlzcGxheU1pc3MiLCJzd2FwUGxheWVyIiwic3dhcHBlZENvb3JkcyIsImRpc3BsYXlIaXQiLCJzaGlwU3VuayIsImFyciIsIml0ZW0iLCJzcGxpY2UiLCJyZW1vdmVBbGxJbnN0YW5jZXMiLCJ4IiwieSIsImNvb3Jkc1RvU3F1YXJlIiwiY29YIiwiY29ZIiwic3F1YXJlcyIsInJhbmRvbUF0dGFja0Nvb3JkcyIsImNsYXNzVG9Db29yZHMiLCJzcXVhcmVUb0F0dGFjayIsImFycmF5VG9GaW5kTWF0Y2giLCJmb3JFYWNoIiwibW92ZSIsImFsZXJ0IiwiZGlzYWJsZUNsaWNrIiwicmFuZG9tQ29vcmRzIiwicmVtb3ZlIiwiZW5hYmxlQ2xpY2siLCJjbGFzc2VzIiwicGFyc2VJbnQiLCJzZXRVcEdhbWUiLCJwMXNoaXAyIiwicDFzaGlwM2EiLCJwMXNoaXAzYiIsInAxc2hpcDQiLCJwMXNoaXA1Iiwic2V0VXBQbGF5ZXJPbmVTaGlwcyIsInAyc2hpcDIiLCJwMnNoaXAzYSIsInAyc2hpcDNiIiwicDJzaGlwNCIsInAyc2hpcDUiLCJzZXRVcFBsYXllclR3b1NoaXBzIiwiYWRkRXZlbnRMaXN0ZW5lciIsInNldFVwQ2xpY2tUb0hpdCIsIkdhbWUiXSwic291cmNlUm9vdCI6IiJ9