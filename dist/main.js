(()=>{"use strict";const o=function(o){let s=0,t=!1;return{shipLength:o,numberOfHits:s,isSunk:function(){return s>=o&&(t=!0,!0)},hit:function(){s+=1},coords:[],length:o,sunk:t}},s=function(o,s){let t=[],e=[],r=[[[" "],[" "],[" "],[" "],[" "],[" "],[" "],[" "],[" "],[" "]],[[" "],[" "],[" "],[" "],[" "],[" "],[" "],[" "],[" "],[" "]],[[" "],[" "],[" "],[" "],[" "],[" "],[" "],[" "],[" "],[" "]],[[" "],[" "],[" "],[" "],[" "],[" "],[" "],[" "],[" "],[" "]],[[" "],[" "],[" "],[" "],[" "],[" "],[" "],[" "],[" "],[" "]],[[" "],[" "],[" "],[" "],[" "],[" "],[" "],[" "],[" "],[" "]],[[" "],[" "],[" "],[" "],[" "],[" "],[" "],[" "],[" "],[" "]],[[" "],[" "],[" "],[" "],[" "],[" "],[" "],[" "],[" "],[" "]],[[" "],[" "],[" "],[" "],[" "],[" "],[" "],[" "],[" "],[" "]],[[" "],[" "],[" "],[" "],[" "],[" "],[" "],[" "],[" "],[" "]]];return{board:r,horizontal:function(o,s,t){for(let e=0;e<o.shipLength;e++){let r=[s,e+t];o.coords.push(r)}},vertical:function(o,s,t){for(let e=0;e<o.shipLength;e++){let r=[e+s,t];o.coords.push(r)}},missedCoords:[],currentShips:[],allSunk:function(){return 5==t.length&&(alert("DONE!"),!0)},getPotentialMoves:function(){for(let o=0;o<10;o++)for(let s=0;s<10;s++)e.push([s,o])},potentialMoves:e,drawBoard:function(){const o=document.getElementsByClassName("container")[0];let s=document.createElement("div");s.classList.add("board-container"),o.appendChild(s);for(let o=0;o<r.length;o++)for(let t=0;t<r.length;t++){let e=document.createElement("div");e.classList.add("individual-square"),e.classList.add(t),e.classList.add(o),s.appendChild(e)," "!=r[o][t]&&e.classList.add("ship")}},drawComputerBoard:function(){const o=document.getElementsByClassName("container")[0];let s=document.createElement("div");s.classList.add("board-container"),o.appendChild(s);for(let o=0;o<r.length;o++)for(let t=0;t<r.length;t++){let e=document.createElement("div");e.classList.add("computer-square"),e.classList.add(t),e.classList.add(o),s.appendChild(e)}},sunkShips:t}},t=function(){let o=[];const s=function(o){console.log("random attack");let s=(t=o.potentialMoves.length-1,Math.floor(Math.random()*t));var t;return o.potentialMoves[s]};return{name:"",randomAttack:s,getLegalMoves:function(s){o=[];for(let t=0;t<s.board.length;t++)for(let e=0;e<10;e++)" "==s.board[t][e]&&o.push([t,e])},randomAttack:s,checkMissedCoordsForMatch:function(o,s){let t=!1;availableMoves=[];for(let e=0;e<s.length;e++)o[0]==s[e][0]&&o[1]==s[e][1]?t=!0:availableMoves.push([o[0],o[1]]);return 1==t}}};(function(){let e=t();e.name="playerOne";let r=t();r.name="playerTwo";let n=s(),d=s();n.getPotentialMoves(),d.getPotentialMoves();let a=e;const c=function(o,s,t,r){let c=t[o[1]][o[0]];if(console.log(`coords = ${o}`),0==u(r,o))console.log("Retry bro");else{if(" "==c)a==e?d.missedCoords.push(o):n.missedCoords.push(o),console.log("miss"),i(s),h();else{let t=[];t.push(o[1]),t.push(o[0]),u(c.coords,t)&&(c.hit(),l(s),c.isSunk(),c.isSunk()&&(shipSunk(c),sunkShips.push(c)),console.log("hit"),t=[],h())}u(r,o)&&function(o,s){for(let t=o.length;t--;)o[t][0]==s[0]&&o[t][1]==s[1]&&o.splice(t,1)}(r,o)}},u=function(o,s){let t=!1;return o.forEach((o=>{o[0]==s[0]&&o[1]==s[1]&&(t=!0)})),1==t},l=function(o){o.classList.add("hit")},i=function(o){o.classList.add("miss")},h=function(){if(a==e){!function(){let o=document.getElementsByClassName("computer-square");for(let s=0;s<o.length;s++)o[s].classList.add("disabled")}(),a=r;let o=a.randomAttack(n),s=function(o){let s=o[0],t=o[1],e=document.getElementsByClassName("individual-square");for(let o=0;o<e.length;o++){let r=p(e[o]);if(s==r[0]&&t==r[1]){let s=e[o];return console.log(s),s}}}(o);c(o,s,n.board,n.potentialMoves)}else!function(){let o=document.getElementsByClassName("computer-square");for(let s=0;s<o.length;s++)o[s].classList.remove("disabled")}(),a=e;console.log("swap"),console.log(a)},p=function(o){let s=o.classList,t=s[1],e="oops";return parseInt(s[2]),e=parseInt(s[2])>=0?s[2]:s[1],[t,e]};return{setUpGame:function(){!function(){const s=o(2);s.coords.push([0,0]),s.coords.push([0,1]),n.board[0][0]=s,n.board[0][1]=s;const t=o(3);t.coords.push([1,0]),t.coords.push([1,1]),t.coords.push([1,2]),n.board[1][0]=t,n.board[1][1]=t,n.board[1][2]=t;const e=o(3);e.coords.push([2,0]),e.coords.push([2,1]),e.coords.push([2,2]),n.board[2][0]=e,n.board[2][1]=e,n.board[2][2]=e;const r=o(4);r.coords.push([3,0]),r.coords.push([3,1]),r.coords.push([3,2]),r.coords.push([3,3]),n.board[3][0]=r,n.board[3][1]=r,n.board[3][2]=r,n.board[3][3]=r;const d=o(5);d.coords.push([4,0]),d.coords.push([4,1]),d.coords.push([4,2]),d.coords.push([4,3]),d.coords.push([4,4]),n.board[4][0]=d,n.board[4][1]=d,n.board[4][2]=d,n.board[4][3]=d,n.board[4][4]=d,n.currentShips.push(s),n.currentShips.push(t),n.currentShips.push(e),n.currentShips.push(r),n.currentShips.push(d)}(),function(){const s=o(2);s.coords.push([0,0]),s.coords.push([0,1]),d.board[0][0]=s,d.board[0][1]=s;const t=o(3);t.coords.push([1,0]),t.coords.push([1,1]),t.coords.push([1,2]),d.board[1][0]=t,d.board[1][1]=t,d.board[1][2]=t;const e=o(3);e.coords.push([2,0]),e.coords.push([2,1]),e.coords.push([2,2]),d.board[2][0]=e,d.board[2][1]=e,d.board[2][2]=e;const r=o(4);r.coords.push([3,0]),r.coords.push([3,1]),r.coords.push([3,2]),r.coords.push([3,3]),d.board[3][0]=r,d.board[3][1]=r,d.board[3][2]=r,d.board[3][3]=r;const n=o(5);n.coords.push([4,0]),n.coords.push([4,1]),n.coords.push([4,2]),n.coords.push([4,3]),n.coords.push([4,4]),d.board[4][0]=n,d.board[4][1]=n,d.board[4][2]=n,d.board[4][3]=n,d.board[4][4]=n,d.currentShips.push(s),d.currentShips.push(t),d.currentShips.push(e),d.currentShips.push(r),d.currentShips.push(n)}(),n.drawBoard(),d.drawComputerBoard(),function(){let o=document.getElementsByClassName("computer-square");for(let s=0;s<o.length;s++)o[s].addEventListener("click",(()=>{c(p(o[s]),o[s],d.board,d.potentialMoves)}))}()},p1Gameboard:n,p2Gameboard:d}})().setUpGame()})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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M0MsRUFBWTVDLE1BQU0sR0FBRyxHQUFLdUYsRUFDMUIzQyxFQUFZNUMsTUFBTSxHQUFHLEdBQUt1RixFQUMxQjNDLEVBQVk1QyxNQUFNLEdBQUcsR0FBS3VGLEVBQzFCM0MsRUFBWTVDLE1BQU0sR0FBRyxHQUFLdUYsRUFFMUIzQyxFQUFZbEMsYUFBYUgsS0FBSzRFLEdBQzlCdkMsRUFBWWxDLGFBQWFILEtBQUs2RSxHQUM5QnhDLEVBQVlsQyxhQUFhSCxLQUFLOEUsR0FDOUJ6QyxFQUFZbEMsYUFBYUgsS0FBSytFLEdBQzlCMUMsRUFBWWxDLGFBQWFILEtBQUtnRixFQUNoQyxDQXdKRUMsR0FDQTdDLEVBQVk1QixZQUNaNkIsRUFBWW5CLG9CQTFFVSxXQUN0QixJQUFJb0MsRUFBVTVDLFNBQVNDLHVCQUF1QixtQkFDOUMsSUFBSyxJQUFJYixFQUFJLEVBQUdBLEVBQUl3RCxFQUFRekUsT0FBUWlCLElBQ2xDd0QsRUFBUXhELEdBQUdvRixpQkFBaUIsU0FBUyxLQUNuQzNDLEVBQ0VxQixFQUFjTixFQUFReEQsSUFDdEJ3RCxFQUFReEQsR0FDUnVDLEVBQVk1QyxNQUNaNEMsRUFBWTdDLGVBQ2IsR0FHUCxDQStERTJGLEVBQ0YsRUFFb0IvQyxjQUFhQyxjQUNuQyxFQ3BRYStDLEdBQ1JmLFciLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9iYXR0bGVzaGlwLy4vc3JjL3NoaXAuanMiLCJ3ZWJwYWNrOi8vYmF0dGxlc2hpcC8uL3NyYy9nYW1lQm9hcmQuanMiLCJ3ZWJwYWNrOi8vYmF0dGxlc2hpcC8uL3NyYy9wbGF5ZXIuanMiLCJ3ZWJwYWNrOi8vYmF0dGxlc2hpcC8uL3NyYy9nYW1lLmpzIiwid2VicGFjazovL2JhdHRsZXNoaXAvLi9zcmMvaW5kZXguanMiXSwic291cmNlc0NvbnRlbnQiOlsiY29uc3QgU2hpcCA9IGZ1bmN0aW9uIChsZW5ndGgpIHtcbiAgY29uc3Qgc2hpcExlbmd0aCA9IGxlbmd0aDtcbiAgbGV0IG51bWJlck9mSGl0cyA9IDA7XG4gIGxldCBzdW5rID0gZmFsc2U7XG4gIGxldCBjb29yZHMgPSBbXTtcblxuICBjb25zdCBoaXQgPSBmdW5jdGlvbiAoKSB7XG4gICAgbnVtYmVyT2ZIaXRzICs9IDE7XG4gIH07XG5cbiAgY29uc3QgaXNTdW5rID0gZnVuY3Rpb24gKCkge1xuICAgIGlmIChudW1iZXJPZkhpdHMgPj0gbGVuZ3RoKSB7XG4gICAgICBzdW5rID0gdHJ1ZTtcbiAgICAgIHJldHVybiB0cnVlO1xuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICB9O1xuXG4gIHJldHVybiB7IHNoaXBMZW5ndGgsIG51bWJlck9mSGl0cywgaXNTdW5rLCBoaXQsIGNvb3JkcywgbGVuZ3RoLCBzdW5rIH07XG59O1xuXG5leHBvcnQgeyBTaGlwIH07XG4iLCJjb25zdCBHYW1lQm9hcmQgPSBmdW5jdGlvbiAocGxheWVyT25lLCBwbGF5ZXJUd28pIHtcbiAgbGV0IHNoaXBQbGFjZW1lbnRNb2RlID0gXCJob3Jpem9udGFsXCI7XG4gIGxldCBjdXJyZW50U2hpcHMgPSBbXTtcbiAgbGV0IHN1bmtTaGlwcyA9IFtdO1xuICBjb25zdCBtaXNzZWRDb29yZHMgPSBbXTtcbiAgbGV0IHBvdGVudGlhbE1vdmVzID0gW107XG4gIGxldCBjdXJyZW50UGxheWVyID0gcGxheWVyT25lO1xuXG4gIGxldCBib2FyZCA9IFtcbiAgICBbW1wiIFwiXSwgW1wiIFwiXSwgW1wiIFwiXSwgW1wiIFwiXSwgW1wiIFwiXSwgW1wiIFwiXSwgW1wiIFwiXSwgW1wiIFwiXSwgW1wiIFwiXSwgW1wiIFwiXV0sXG4gICAgW1tcIiBcIl0sIFtcIiBcIl0sIFtcIiBcIl0sIFtcIiBcIl0sIFtcIiBcIl0sIFtcIiBcIl0sIFtcIiBcIl0sIFtcIiBcIl0sIFtcIiBcIl0sIFtcIiBcIl1dLFxuICAgIFtbXCIgXCJdLCBbXCIgXCJdLCBbXCIgXCJdLCBbXCIgXCJdLCBbXCIgXCJdLCBbXCIgXCJdLCBbXCIgXCJdLCBbXCIgXCJdLCBbXCIgXCJdLCBbXCIgXCJdXSxcbiAgICBbW1wiIFwiXSwgW1wiIFwiXSwgW1wiIFwiXSwgW1wiIFwiXSwgW1wiIFwiXSwgW1wiIFwiXSwgW1wiIFwiXSwgW1wiIFwiXSwgW1wiIFwiXSwgW1wiIFwiXV0sXG4gICAgW1tcIiBcIl0sIFtcIiBcIl0sIFtcIiBcIl0sIFtcIiBcIl0sIFtcIiBcIl0sIFtcIiBcIl0sIFtcIiBcIl0sIFtcIiBcIl0sIFtcIiBcIl0sIFtcIiBcIl1dLFxuICAgIFtbXCIgXCJdLCBbXCIgXCJdLCBbXCIgXCJdLCBbXCIgXCJdLCBbXCIgXCJdLCBbXCIgXCJdLCBbXCIgXCJdLCBbXCIgXCJdLCBbXCIgXCJdLCBbXCIgXCJdXSxcbiAgICBbW1wiIFwiXSwgW1wiIFwiXSwgW1wiIFwiXSwgW1wiIFwiXSwgW1wiIFwiXSwgW1wiIFwiXSwgW1wiIFwiXSwgW1wiIFwiXSwgW1wiIFwiXSwgW1wiIFwiXV0sXG4gICAgW1tcIiBcIl0sIFtcIiBcIl0sIFtcIiBcIl0sIFtcIiBcIl0sIFtcIiBcIl0sIFtcIiBcIl0sIFtcIiBcIl0sIFtcIiBcIl0sIFtcIiBcIl0sIFtcIiBcIl1dLFxuICAgIFtbXCIgXCJdLCBbXCIgXCJdLCBbXCIgXCJdLCBbXCIgXCJdLCBbXCIgXCJdLCBbXCIgXCJdLCBbXCIgXCJdLCBbXCIgXCJdLCBbXCIgXCJdLCBbXCIgXCJdXSxcbiAgICBbW1wiIFwiXSwgW1wiIFwiXSwgW1wiIFwiXSwgW1wiIFwiXSwgW1wiIFwiXSwgW1wiIFwiXSwgW1wiIFwiXSwgW1wiIFwiXSwgW1wiIFwiXSwgW1wiIFwiXV0sXG4gIF07XG5cbiAgY29uc3QgZ2V0UG90ZW50aWFsTW92ZXMgPSBmdW5jdGlvbiAoKSB7XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCAxMDsgaSsrKSB7XG4gICAgICBmb3IgKGxldCBhID0gMDsgYSA8IDEwOyBhKyspIHtcbiAgICAgICAgcG90ZW50aWFsTW92ZXMucHVzaChbYSwgaV0pO1xuICAgICAgfVxuICAgIH1cbiAgfTtcblxuICAvLyBjb25zdCBzZXRVcENsaWNrVG9IaXQgPSBmdW5jdGlvbiAoKSB7XG4gIC8vICAgbGV0IHNxdWFyZXMgPSBkb2N1bWVudC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKFwiY29tcHV0ZXItc3F1YXJlXCIpO1xuICAvLyAgIGZvciAobGV0IGkgPSAwOyBpIDwgc3F1YXJlcy5sZW5ndGg7IGkrKykge1xuICAvLyAgICAgc3F1YXJlc1tpXS5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICAvLyAgICAgICByZWNlaXZlQXR0YWNrKGNsYXNzVG9Db29yZHMoc3F1YXJlc1tpXSksIHNxdWFyZXNbaV0pO1xuICAvLyAgICAgfSk7XG4gIC8vICAgfVxuICAvLyB9O1xuXG4gIC8vIGNvbnN0IGRpc2FibGVDbGljayA9IGZ1bmN0aW9uICgpIHtcbiAgLy8gICBsZXQgc3F1YXJlcyA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoXCJjb21wdXRlci1zcXVhcmVcIik7XG4gIC8vICAgZm9yIChsZXQgaSA9IDA7IGkgPCBzcXVhcmVzLmxlbmd0aDsgaSsrKSB7XG4gIC8vICAgICBzcXVhcmVzW2ldLmNsYXNzTGlzdC5hZGQoXCJkaXNhYmxlZFwiKTtcbiAgLy8gICB9XG4gIC8vIH07XG5cbiAgLy8gY29uc3QgZW5hYmxlQ2xpY2sgPSBmdW5jdGlvbiAoKSB7XG4gIC8vICAgbGV0IHNxdWFyZXMgPSBkb2N1bWVudC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKFwiY29tcHV0ZXItc3F1YXJlXCIpO1xuICAvLyAgIGZvciAobGV0IGkgPSAwOyBpIDwgc3F1YXJlcy5sZW5ndGg7IGkrKykge1xuICAvLyAgICAgc3F1YXJlc1tpXS5jbGFzc0xpc3QucmVtb3ZlKFwiZGlzYWJsZWRcIik7XG4gIC8vICAgfVxuICAvLyB9O1xuXG4gIGNvbnN0IGhvcml6b250YWwgPSBmdW5jdGlvbiAoc2hpcCwgc3RhcnRSb3dDb29yZHMsIHN0YXJ0Q29sdW1uQ29vcmRzKSB7XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBzaGlwLnNoaXBMZW5ndGg7IGkrKykge1xuICAgICAgbGV0IGN1cnJlbnRDb29yZCA9IFtzdGFydFJvd0Nvb3JkcywgaSArIHN0YXJ0Q29sdW1uQ29vcmRzXTtcbiAgICAgIHNoaXAuY29vcmRzLnB1c2goY3VycmVudENvb3JkKTtcbiAgICB9XG4gIH07XG5cbiAgY29uc3QgdmVydGljYWwgPSBmdW5jdGlvbiAoc2hpcCwgc3RhcnRSb3dDb29yZHMsIHN0YXJ0Q29sdW1uQ29vcmRzKSB7XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBzaGlwLnNoaXBMZW5ndGg7IGkrKykge1xuICAgICAgbGV0IGN1cnJlbnRDb29yZCA9IFtpICsgc3RhcnRSb3dDb29yZHMsIHN0YXJ0Q29sdW1uQ29vcmRzXTtcbiAgICAgIHNoaXAuY29vcmRzLnB1c2goY3VycmVudENvb3JkKTtcbiAgICB9XG4gIH07XG5cbiAgY29uc3QgcGxhY2VTaGlwID0gZnVuY3Rpb24gKHNoaXApIHtcbiAgICBzaGlwLmNvb3Jkcy5mb3JFYWNoKChjb29yZCkgPT4ge1xuICAgICAgbGV0IG91dGVyID0gY29vcmRbMF07XG4gICAgICBsZXQgaW5uZXIgPSBjb29yZFsxXTtcbiAgICAgIGJvYXJkW291dGVyXVtpbm5lcl0gPSBzaGlwO1xuICAgIH0pO1xuICB9O1xuXG4gIGNvbnN0IHNldFNoaXBQb3NpdGlvbiA9IGZ1bmN0aW9uIChzaGlwLCBzdGFydFJvd0Nvb3Jkcywgc3RhcnRDb2x1bW5Db29yZHMpIHtcbiAgICBpZiAoc2hpcFBsYWNlbWVudE1vZGUgPT0gXCJob3Jpem9udGFsXCIpIHtcbiAgICAgIGhvcml6b250YWwoc2hpcCwgc3RhcnRSb3dDb29yZHMsIHN0YXJ0Q29sdW1uQ29vcmRzKTtcbiAgICB9IGVsc2UgaWYgKHNoaXBQbGFjZW1lbnRNb2RlID09IFwidmVydGljYWxcIikge1xuICAgICAgdmVydGljYWwoc2hpcCwgc3RhcnRSb3dDb29yZHMsIHN0YXJ0Q29sdW1uQ29vcmRzKTtcbiAgICB9XG4gIH07XG5cbiAgY29uc3Qgc2hpcFN1bmsgPSBmdW5jdGlvbiAoc2hpcCkge1xuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgc2hpcC5jb29yZHMubGVuZ3RoOyBpKyspIHtcbiAgICAgIGxldCB4ID0gc2hpcC5jb29yZHNbaV1bMF07XG4gICAgICBsZXQgeSA9IHNoaXAuY29vcmRzW2ldWzFdO1xuICAgIH1cbiAgfTtcblxuICBjb25zdCBhbGxTdW5rID0gZnVuY3Rpb24gKCkge1xuICAgIGlmIChzdW5rU2hpcHMubGVuZ3RoID09IDUpIHtcbiAgICAgIGFsZXJ0KFwiRE9ORSFcIik7XG4gICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9IGVsc2Uge1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgfTtcblxuICBjb25zdCBkcmF3Qm9hcmQgPSBmdW5jdGlvbiAoKSB7XG4gICAgY29uc3QgY29udGFpbmVyID0gZG9jdW1lbnQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZShcImNvbnRhaW5lclwiKVswXTtcbiAgICBsZXQgYm9hcmRDb250YWluZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xuICAgIGJvYXJkQ29udGFpbmVyLmNsYXNzTGlzdC5hZGQoXCJib2FyZC1jb250YWluZXJcIik7XG4gICAgY29udGFpbmVyLmFwcGVuZENoaWxkKGJvYXJkQ29udGFpbmVyKTtcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IGJvYXJkLmxlbmd0aDsgaSsrKSB7XG4gICAgICBmb3IgKGxldCBhID0gMDsgYSA8IGJvYXJkLmxlbmd0aDsgYSsrKSB7XG4gICAgICAgIGxldCBpbmRpdmlkdWFsU3F1YXJlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcbiAgICAgICAgaW5kaXZpZHVhbFNxdWFyZS5jbGFzc0xpc3QuYWRkKFwiaW5kaXZpZHVhbC1zcXVhcmVcIik7XG4gICAgICAgIGluZGl2aWR1YWxTcXVhcmUuY2xhc3NMaXN0LmFkZChhKTsgLy8geFxuICAgICAgICBpbmRpdmlkdWFsU3F1YXJlLmNsYXNzTGlzdC5hZGQoaSk7IC8vIHlcbiAgICAgICAgYm9hcmRDb250YWluZXIuYXBwZW5kQ2hpbGQoaW5kaXZpZHVhbFNxdWFyZSk7XG4gICAgICAgIGlmIChib2FyZFtpXVthXSAhPSBcIiBcIikge1xuICAgICAgICAgIGluZGl2aWR1YWxTcXVhcmUuY2xhc3NMaXN0LmFkZChcInNoaXBcIik7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gIH07XG5cbiAgY29uc3QgZHJhd0NvbXB1dGVyQm9hcmQgPSBmdW5jdGlvbiAoKSB7XG4gICAgY29uc3QgY29udGFpbmVyID0gZG9jdW1lbnQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZShcImNvbnRhaW5lclwiKVswXTtcbiAgICBsZXQgYm9hcmRDb250YWluZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xuICAgIGJvYXJkQ29udGFpbmVyLmNsYXNzTGlzdC5hZGQoXCJib2FyZC1jb250YWluZXJcIik7XG4gICAgY29udGFpbmVyLmFwcGVuZENoaWxkKGJvYXJkQ29udGFpbmVyKTtcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IGJvYXJkLmxlbmd0aDsgaSsrKSB7XG4gICAgICBmb3IgKGxldCBhID0gMDsgYSA8IGJvYXJkLmxlbmd0aDsgYSsrKSB7XG4gICAgICAgIGxldCBpbmRpdmlkdWFsU3F1YXJlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcbiAgICAgICAgaW5kaXZpZHVhbFNxdWFyZS5jbGFzc0xpc3QuYWRkKFwiY29tcHV0ZXItc3F1YXJlXCIpO1xuICAgICAgICBpbmRpdmlkdWFsU3F1YXJlLmNsYXNzTGlzdC5hZGQoYSk7IC8vIHhcbiAgICAgICAgaW5kaXZpZHVhbFNxdWFyZS5jbGFzc0xpc3QuYWRkKGkpOyAvLyB5XG4gICAgICAgIGJvYXJkQ29udGFpbmVyLmFwcGVuZENoaWxkKGluZGl2aWR1YWxTcXVhcmUpO1xuICAgICAgfVxuICAgIH1cbiAgfTtcblxuICByZXR1cm4ge1xuICAgIGJvYXJkLFxuICAgIGhvcml6b250YWwsXG4gICAgdmVydGljYWwsXG4gICAgbWlzc2VkQ29vcmRzLFxuICAgIGN1cnJlbnRTaGlwcyxcbiAgICBhbGxTdW5rLFxuICAgIGdldFBvdGVudGlhbE1vdmVzLFxuICAgIHBvdGVudGlhbE1vdmVzLFxuICAgIGRyYXdCb2FyZCxcbiAgICBkcmF3Q29tcHV0ZXJCb2FyZCxcbiAgICBzdW5rU2hpcHMsXG4gIH07XG59O1xuXG5leHBvcnQgeyBHYW1lQm9hcmQgfTtcblxuLy8gY29uc3QgY2hlY2tOZXN0ZWRBcnJheSA9IGZ1bmN0aW9uIChhcnJheSwgY29vcmRzKSB7XG4vLyAgIGxldCBtYXRjaCA9IGZhbHNlO1xuLy8gICBmb3IgKGxldCBpID0gMDsgaSA8IGFycmF5Lmxlbmd0aDsgaSsrKSB7XG4vLyAgICAgaWYgKGFycmF5W2ldLmluY2x1ZGVzKGNvb3Jkc1swXSkgJiYgYXJyYXlbaV0uaW5jbHVkZXMoY29vcmRzWzFdKSkge1xuLy8gICAgICAgbWF0Y2ggPSB0cnVlO1xuLy8gICAgIH1cbi8vICAgfVxuLy8gICByZXR1cm4gbWF0Y2g7XG4vLyB9O1xuIiwiaW1wb3J0IHsgR2FtZUJvYXJkIH0gZnJvbSBcIi4vZ2FtZUJvYXJkXCI7XG5cbmNvbnN0IFBsYXllciA9IGZ1bmN0aW9uICgpIHtcbiAgY29uc3QgbmFtZSA9IFwiXCI7XG4gIGxldCBsZWdhbE1vdmVzID0gW107XG4gIC8vIGxldCBwcmV2aW91c01vdmVzID0gW107XG4gIC8vIGxldCBhdmFpbGFibGVNb3ZlcyA9IFtdO1xuXG4gIGNvbnN0IGdldExlZ2FsTW92ZXMgPSBmdW5jdGlvbiAob3Bwb25lbnRHYW1lYm9hcmQpIHtcbiAgICBsZWdhbE1vdmVzID0gW107XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBvcHBvbmVudEdhbWVib2FyZC5ib2FyZC5sZW5ndGg7IGkrKykge1xuICAgICAgZm9yIChsZXQgYSA9IDA7IGEgPCAxMDsgYSsrKSB7XG4gICAgICAgIGlmIChvcHBvbmVudEdhbWVib2FyZC5ib2FyZFtpXVthXSA9PSBcIiBcIikge1xuICAgICAgICAgIGxlZ2FsTW92ZXMucHVzaChbaSwgYV0pO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICB9O1xuXG4gIGNvbnN0IGNoZWNrTWlzc2VkQ29vcmRzRm9yTWF0Y2ggPSBmdW5jdGlvbiAoXG4gICAgY29vcmRzLFxuICAgIG9wcG9uZW50R2FtZWJvYXJkTWlzc2VkQ29vcmRzQXJyYXlcbiAgKSB7XG4gICAgbGV0IG1hdGNoID0gZmFsc2U7XG4gICAgYXZhaWxhYmxlTW92ZXMgPSBbXTtcblxuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgb3Bwb25lbnRHYW1lYm9hcmRNaXNzZWRDb29yZHNBcnJheS5sZW5ndGg7IGkrKykge1xuICAgICAgaWYgKFxuICAgICAgICBjb29yZHNbMF0gPT0gb3Bwb25lbnRHYW1lYm9hcmRNaXNzZWRDb29yZHNBcnJheVtpXVswXSAmJlxuICAgICAgICBjb29yZHNbMV0gPT0gb3Bwb25lbnRHYW1lYm9hcmRNaXNzZWRDb29yZHNBcnJheVtpXVsxXVxuICAgICAgKSB7XG4gICAgICAgIG1hdGNoID0gdHJ1ZTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGF2YWlsYWJsZU1vdmVzLnB1c2goW2Nvb3Jkc1swXSwgY29vcmRzWzFdXSk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgaWYgKG1hdGNoID09IHRydWUpIHtcbiAgICAgIHJldHVybiB0cnVlO1xuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICB9O1xuXG4gIGZ1bmN0aW9uIGdldFJhbmRvbUludChtYXgpIHtcbiAgICByZXR1cm4gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogbWF4KTtcbiAgfVxuXG4gIGNvbnN0IHJhbmRvbUF0dGFjayA9IGZ1bmN0aW9uIChvcHBvbmVudEdhbWVib2FyZCkge1xuICAgIGNvbnNvbGUubG9nKFwicmFuZG9tIGF0dGFja1wiKTtcbiAgICBsZXQgcmFuZG9tSW5kZXggPSBnZXRSYW5kb21JbnQob3Bwb25lbnRHYW1lYm9hcmQucG90ZW50aWFsTW92ZXMubGVuZ3RoIC0gMSk7XG4gICAgbGV0IHJhbmRvbU1vdmUgPSBvcHBvbmVudEdhbWVib2FyZC5wb3RlbnRpYWxNb3Zlc1tyYW5kb21JbmRleF07XG4gICAgcmV0dXJuIHJhbmRvbU1vdmU7XG4gIH07XG5cbiAgcmV0dXJuIHtcbiAgICBuYW1lLFxuICAgIHJhbmRvbUF0dGFjayxcbiAgICBnZXRMZWdhbE1vdmVzLFxuICAgIHJhbmRvbUF0dGFjayxcbiAgICBjaGVja01pc3NlZENvb3Jkc0Zvck1hdGNoLFxuICB9O1xufTtcblxuZXhwb3J0IHsgUGxheWVyIH07XG4iLCJpbXBvcnQgeyBTaGlwIH0gZnJvbSBcIi4vc2hpcFwiO1xuaW1wb3J0IHsgR2FtZUJvYXJkIH0gZnJvbSBcIi4vZ2FtZUJvYXJkXCI7XG5pbXBvcnQgeyBQbGF5ZXIgfSBmcm9tIFwiLi9wbGF5ZXJcIjtcblxuLy8gbmVlZCB0byBjaGFuZ2UgaWRzIG9uIGVhY2ggZ2FtZWJvYXJkXG4vLyBhZGQgaW4gc3dhcHNcbi8vIGRvbnQgYWxsb3cgYXR0YWNraW5nIG93biBnYW1lYm9hcmRcbi8vIG1ha2UgY29tcHV0ZXIgbWFrZSBtb3ZlIG9uIGl0cyBnb1xuLy9zZXQgdGltZW91dCB0byBkZWxheSBtb3ZlXG4vLyBkaXNwbGF5IGNoYW5nZVxuLy8gZW5kIGF0IHdpblxuXG5jb25zdCBHYW1lID0gZnVuY3Rpb24gKCkge1xuICBsZXQgcGxheWVyT25lID0gUGxheWVyKCk7XG4gIHBsYXllck9uZS5uYW1lID0gXCJwbGF5ZXJPbmVcIjtcbiAgbGV0IHBsYXllclR3byA9IFBsYXllcigpO1xuICBwbGF5ZXJUd28ubmFtZSA9IFwicGxheWVyVHdvXCI7XG4gIGxldCBwMUdhbWVib2FyZCA9IEdhbWVCb2FyZChwbGF5ZXJPbmUsIHBsYXllclR3byk7XG4gIGxldCBwMkdhbWVib2FyZCA9IEdhbWVCb2FyZChwbGF5ZXJPbmUsIHBsYXllclR3byk7XG4gIHAxR2FtZWJvYXJkLmdldFBvdGVudGlhbE1vdmVzKCk7XG4gIHAyR2FtZWJvYXJkLmdldFBvdGVudGlhbE1vdmVzKCk7XG4gIGxldCB3aW4gPSBmYWxzZTtcbiAgbGV0IGN1cnJlbnRQbGF5ZXIgPSBwbGF5ZXJPbmU7XG5cbiAgY29uc3Qgc2V0VXBQbGF5ZXJPbmVTaGlwcyA9IGZ1bmN0aW9uICgpIHtcbiAgICAvLyBwMUdhbWVib2FyZCA9IEdhbWVCb2FyZCgpO1xuICAgIGNvbnN0IHAxc2hpcDIgPSBTaGlwKDIpO1xuICAgIHAxc2hpcDIuY29vcmRzLnB1c2goWzAsIDBdKTtcbiAgICBwMXNoaXAyLmNvb3Jkcy5wdXNoKFswLCAxXSk7XG4gICAgcDFHYW1lYm9hcmQuYm9hcmRbMF1bMF0gPSBwMXNoaXAyO1xuICAgIHAxR2FtZWJvYXJkLmJvYXJkWzBdWzFdID0gcDFzaGlwMjtcbiAgICBjb25zdCBwMXNoaXAzYSA9IFNoaXAoMyk7XG4gICAgLy8gY29uc29sZS5sb2coYGFiYyR7cDFzaGlwM2EubGVuZ3RofWApO1xuXG4gICAgcDFzaGlwM2EuY29vcmRzLnB1c2goWzEsIDBdKTtcbiAgICBwMXNoaXAzYS5jb29yZHMucHVzaChbMSwgMV0pO1xuICAgIHAxc2hpcDNhLmNvb3Jkcy5wdXNoKFsxLCAyXSk7XG4gICAgcDFHYW1lYm9hcmQuYm9hcmRbMV1bMF0gPSBwMXNoaXAzYTtcbiAgICBwMUdhbWVib2FyZC5ib2FyZFsxXVsxXSA9IHAxc2hpcDNhO1xuICAgIHAxR2FtZWJvYXJkLmJvYXJkWzFdWzJdID0gcDFzaGlwM2E7XG4gICAgY29uc3QgcDFzaGlwM2IgPSBTaGlwKDMpO1xuICAgIHAxc2hpcDNiLmNvb3Jkcy5wdXNoKFsyLCAwXSk7XG4gICAgcDFzaGlwM2IuY29vcmRzLnB1c2goWzIsIDFdKTtcbiAgICBwMXNoaXAzYi5jb29yZHMucHVzaChbMiwgMl0pO1xuICAgIHAxR2FtZWJvYXJkLmJvYXJkWzJdWzBdID0gcDFzaGlwM2I7XG4gICAgcDFHYW1lYm9hcmQuYm9hcmRbMl1bMV0gPSBwMXNoaXAzYjtcbiAgICBwMUdhbWVib2FyZC5ib2FyZFsyXVsyXSA9IHAxc2hpcDNiO1xuICAgIGNvbnN0IHAxc2hpcDQgPSBTaGlwKDQpO1xuICAgIHAxc2hpcDQuY29vcmRzLnB1c2goWzMsIDBdKTtcbiAgICBwMXNoaXA0LmNvb3Jkcy5wdXNoKFszLCAxXSk7XG4gICAgcDFzaGlwNC5jb29yZHMucHVzaChbMywgMl0pO1xuICAgIHAxc2hpcDQuY29vcmRzLnB1c2goWzMsIDNdKTtcbiAgICBwMUdhbWVib2FyZC5ib2FyZFszXVswXSA9IHAxc2hpcDQ7XG4gICAgcDFHYW1lYm9hcmQuYm9hcmRbM11bMV0gPSBwMXNoaXA0O1xuICAgIHAxR2FtZWJvYXJkLmJvYXJkWzNdWzJdID0gcDFzaGlwNDtcbiAgICBwMUdhbWVib2FyZC5ib2FyZFszXVszXSA9IHAxc2hpcDQ7XG4gICAgY29uc3QgcDFzaGlwNSA9IFNoaXAoNSk7XG4gICAgcDFzaGlwNS5jb29yZHMucHVzaChbNCwgMF0pO1xuICAgIHAxc2hpcDUuY29vcmRzLnB1c2goWzQsIDFdKTtcbiAgICBwMXNoaXA1LmNvb3Jkcy5wdXNoKFs0LCAyXSk7XG4gICAgcDFzaGlwNS5jb29yZHMucHVzaChbNCwgM10pO1xuICAgIHAxc2hpcDUuY29vcmRzLnB1c2goWzQsIDRdKTtcbiAgICBwMUdhbWVib2FyZC5ib2FyZFs0XVswXSA9IHAxc2hpcDU7XG4gICAgcDFHYW1lYm9hcmQuYm9hcmRbNF1bMV0gPSBwMXNoaXA1O1xuICAgIHAxR2FtZWJvYXJkLmJvYXJkWzRdWzJdID0gcDFzaGlwNTtcbiAgICBwMUdhbWVib2FyZC5ib2FyZFs0XVszXSA9IHAxc2hpcDU7XG4gICAgcDFHYW1lYm9hcmQuYm9hcmRbNF1bNF0gPSBwMXNoaXA1O1xuICAgIHAxR2FtZWJvYXJkLmN1cnJlbnRTaGlwcy5wdXNoKHAxc2hpcDIpO1xuICAgIHAxR2FtZWJvYXJkLmN1cnJlbnRTaGlwcy5wdXNoKHAxc2hpcDNhKTtcbiAgICBwMUdhbWVib2FyZC5jdXJyZW50U2hpcHMucHVzaChwMXNoaXAzYik7XG4gICAgcDFHYW1lYm9hcmQuY3VycmVudFNoaXBzLnB1c2gocDFzaGlwNCk7XG4gICAgcDFHYW1lYm9hcmQuY3VycmVudFNoaXBzLnB1c2gocDFzaGlwNSk7XG4gIH07XG5cbiAgY29uc3Qgc2V0VXBQbGF5ZXJUd29TaGlwcyA9IGZ1bmN0aW9uICgpIHtcbiAgICBjb25zdCBwMnNoaXAyID0gU2hpcCgyKTtcbiAgICBwMnNoaXAyLmNvb3Jkcy5wdXNoKFswLCAwXSk7XG4gICAgcDJzaGlwMi5jb29yZHMucHVzaChbMCwgMV0pO1xuICAgIHAyR2FtZWJvYXJkLmJvYXJkWzBdWzBdID0gcDJzaGlwMjtcbiAgICBwMkdhbWVib2FyZC5ib2FyZFswXVsxXSA9IHAyc2hpcDI7XG4gICAgY29uc3QgcDJzaGlwM2EgPSBTaGlwKDMpO1xuICAgIHAyc2hpcDNhLmNvb3Jkcy5wdXNoKFsxLCAwXSk7XG4gICAgcDJzaGlwM2EuY29vcmRzLnB1c2goWzEsIDFdKTtcbiAgICBwMnNoaXAzYS5jb29yZHMucHVzaChbMSwgMl0pO1xuICAgIHAyR2FtZWJvYXJkLmJvYXJkWzFdWzBdID0gcDJzaGlwM2E7XG4gICAgcDJHYW1lYm9hcmQuYm9hcmRbMV1bMV0gPSBwMnNoaXAzYTtcbiAgICBwMkdhbWVib2FyZC5ib2FyZFsxXVsyXSA9IHAyc2hpcDNhO1xuICAgIGNvbnN0IHAyc2hpcDNiID0gU2hpcCgzKTtcbiAgICBwMnNoaXAzYi5jb29yZHMucHVzaChbMiwgMF0pO1xuICAgIHAyc2hpcDNiLmNvb3Jkcy5wdXNoKFsyLCAxXSk7XG4gICAgcDJzaGlwM2IuY29vcmRzLnB1c2goWzIsIDJdKTtcbiAgICBwMkdhbWVib2FyZC5ib2FyZFsyXVswXSA9IHAyc2hpcDNiO1xuICAgIHAyR2FtZWJvYXJkLmJvYXJkWzJdWzFdID0gcDJzaGlwM2I7XG4gICAgcDJHYW1lYm9hcmQuYm9hcmRbMl1bMl0gPSBwMnNoaXAzYjtcbiAgICBjb25zdCBwMnNoaXA0ID0gU2hpcCg0KTtcbiAgICBwMnNoaXA0LmNvb3Jkcy5wdXNoKFszLCAwXSk7XG4gICAgcDJzaGlwNC5jb29yZHMucHVzaChbMywgMV0pO1xuICAgIHAyc2hpcDQuY29vcmRzLnB1c2goWzMsIDJdKTtcbiAgICBwMnNoaXA0LmNvb3Jkcy5wdXNoKFszLCAzXSk7XG4gICAgcDJHYW1lYm9hcmQuYm9hcmRbM11bMF0gPSBwMnNoaXA0O1xuICAgIHAyR2FtZWJvYXJkLmJvYXJkWzNdWzFdID0gcDJzaGlwNDtcbiAgICBwMkdhbWVib2FyZC5ib2FyZFszXVsyXSA9IHAyc2hpcDQ7XG4gICAgcDJHYW1lYm9hcmQuYm9hcmRbM11bM10gPSBwMnNoaXA0O1xuICAgIGNvbnN0IHAyc2hpcDUgPSBTaGlwKDUpO1xuICAgIHAyc2hpcDUuY29vcmRzLnB1c2goWzQsIDBdKTtcbiAgICBwMnNoaXA1LmNvb3Jkcy5wdXNoKFs0LCAxXSk7XG4gICAgcDJzaGlwNS5jb29yZHMucHVzaChbNCwgMl0pO1xuICAgIHAyc2hpcDUuY29vcmRzLnB1c2goWzQsIDNdKTtcbiAgICBwMnNoaXA1LmNvb3Jkcy5wdXNoKFs0LCA0XSk7XG4gICAgcDJHYW1lYm9hcmQuYm9hcmRbNF1bMF0gPSBwMnNoaXA1O1xuICAgIHAyR2FtZWJvYXJkLmJvYXJkWzRdWzFdID0gcDJzaGlwNTtcbiAgICBwMkdhbWVib2FyZC5ib2FyZFs0XVsyXSA9IHAyc2hpcDU7XG4gICAgcDJHYW1lYm9hcmQuYm9hcmRbNF1bM10gPSBwMnNoaXA1O1xuICAgIHAyR2FtZWJvYXJkLmJvYXJkWzRdWzRdID0gcDJzaGlwNTtcblxuICAgIHAyR2FtZWJvYXJkLmN1cnJlbnRTaGlwcy5wdXNoKHAyc2hpcDIpO1xuICAgIHAyR2FtZWJvYXJkLmN1cnJlbnRTaGlwcy5wdXNoKHAyc2hpcDNhKTtcbiAgICBwMkdhbWVib2FyZC5jdXJyZW50U2hpcHMucHVzaChwMnNoaXAzYik7XG4gICAgcDJHYW1lYm9hcmQuY3VycmVudFNoaXBzLnB1c2gocDJzaGlwNCk7XG4gICAgcDJHYW1lYm9hcmQuY3VycmVudFNoaXBzLnB1c2gocDJzaGlwNSk7XG4gIH07XG5cbiAgY29uc3QgcmVjZWl2ZUF0dGFjayA9IGZ1bmN0aW9uIChjb29yZHMsIHNxdWFyZSwgYm9hcmQsIHBvdGVudGlhbE1vdmVzKSB7XG4gICAgbGV0IHNoaXAgPSBib2FyZFtjb29yZHNbMV1dW2Nvb3Jkc1swXV07IC8vIHggYW5kIHkgbXVzdCBiZSBzd2FwcGVkIGZvciBnYW1lIGJvYXJkXG5cbiAgICAvLyBpZiBub3QgYSBsZWdhbCBtb3ZlLCByZXRyeVxuICAgIGNvbnNvbGUubG9nKGBjb29yZHMgPSAke2Nvb3Jkc31gKTtcbiAgICBpZiAobWF0Y2hNb3ZlKHBvdGVudGlhbE1vdmVzLCBjb29yZHMpID09IGZhbHNlKSB7XG4gICAgICBjb25zb2xlLmxvZyhcIlJldHJ5IGJyb1wiKTtcbiAgICB9IGVsc2Uge1xuICAgICAgaWYgKHNoaXAgPT0gXCIgXCIpIHtcbiAgICAgICAgaWYgKGN1cnJlbnRQbGF5ZXIgPT0gcGxheWVyT25lKSB7XG4gICAgICAgICAgcDJHYW1lYm9hcmQubWlzc2VkQ29vcmRzLnB1c2goY29vcmRzKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBwMUdhbWVib2FyZC5taXNzZWRDb29yZHMucHVzaChjb29yZHMpO1xuICAgICAgICB9XG4gICAgICAgIGNvbnNvbGUubG9nKFwibWlzc1wiKTtcbiAgICAgICAgZGlzcGxheU1pc3Moc3F1YXJlKTtcbiAgICAgICAgc3dhcFBsYXllcigpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgbGV0IHN3YXBwZWRDb29yZHMgPSBbXTtcbiAgICAgICAgc3dhcHBlZENvb3Jkcy5wdXNoKGNvb3Jkc1sxXSk7XG4gICAgICAgIHN3YXBwZWRDb29yZHMucHVzaChjb29yZHNbMF0pO1xuICAgICAgICBpZiAobWF0Y2hNb3ZlKHNoaXAuY29vcmRzLCBzd2FwcGVkQ29vcmRzKSkge1xuICAgICAgICAgIHNoaXAuaGl0KCk7XG4gICAgICAgICAgZGlzcGxheUhpdChzcXVhcmUpO1xuICAgICAgICAgIHNoaXAuaXNTdW5rKCk7XG4gICAgICAgICAgaWYgKHNoaXAuaXNTdW5rKCkpIHtcbiAgICAgICAgICAgIHNoaXBTdW5rKHNoaXApO1xuICAgICAgICAgICAgc3Vua1NoaXBzLnB1c2goc2hpcCk7XG4gICAgICAgICAgfVxuICAgICAgICAgIC8vIGFsbFN1bmsoKTsgLy8gYWRkIGJhY2sgaW5cbiAgICAgICAgICBjb25zb2xlLmxvZyhcImhpdFwiKTtcbiAgICAgICAgICBzd2FwcGVkQ29vcmRzID0gW107XG4gICAgICAgICAgc3dhcFBsYXllcigpOyAvLyBzd2FwXG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIGlmIChtYXRjaE1vdmUocG90ZW50aWFsTW92ZXMsIGNvb3JkcykpIHtcbiAgICAgICAgcmVtb3ZlQWxsSW5zdGFuY2VzKHBvdGVudGlhbE1vdmVzLCBjb29yZHMpOyAvLyBuZWVkIHRvIGNvZGUgdGhpc1xuICAgICAgfVxuICAgIH1cbiAgfTtcblxuICBmdW5jdGlvbiByZW1vdmVBbGxJbnN0YW5jZXMoYXJyLCBpdGVtKSB7XG4gICAgZm9yIChsZXQgaSA9IGFyci5sZW5ndGg7IGktLTsgKSB7XG4gICAgICBpZiAoYXJyW2ldWzBdID09IGl0ZW1bMF0gJiYgYXJyW2ldWzFdID09IGl0ZW1bMV0pIGFyci5zcGxpY2UoaSwgMSk7XG4gICAgfVxuICB9XG5cbiAgY29uc3QgY29vcmRzVG9TcXVhcmUgPSBmdW5jdGlvbiAoY29vcmRzKSB7XG4gICAgbGV0IGNvWCA9IGNvb3Jkc1swXTtcbiAgICBsZXQgY29ZID0gY29vcmRzWzFdO1xuICAgIGxldCBzcXVhcmVzID0gZG9jdW1lbnQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZShcImluZGl2aWR1YWwtc3F1YXJlXCIpO1xuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgc3F1YXJlcy5sZW5ndGg7IGkrKykge1xuICAgICAgLy8gY29uc29sZS5sb2coc3F1YXJlc1tpXS5jbGFzc0xpc3QpO1xuICAgICAgbGV0IHJhbmRvbUF0dGFja0Nvb3JkcyA9IGNsYXNzVG9Db29yZHMoc3F1YXJlc1tpXSk7XG4gICAgICBpZiAoY29YID09IHJhbmRvbUF0dGFja0Nvb3Jkc1swXSAmJiBjb1kgPT0gcmFuZG9tQXR0YWNrQ29vcmRzWzFdKSB7XG4gICAgICAgIGxldCBzcXVhcmVUb0F0dGFjayA9IHNxdWFyZXNbaV07XG4gICAgICAgIGNvbnNvbGUubG9nKHNxdWFyZVRvQXR0YWNrKTtcbiAgICAgICAgcmV0dXJuIHNxdWFyZVRvQXR0YWNrO1xuICAgICAgfVxuICAgIH1cbiAgfTtcblxuICBjb25zdCBtYXRjaE1vdmUgPSBmdW5jdGlvbiAoYXJyYXlUb0ZpbmRNYXRjaCwgY29vcmRzKSB7XG4gICAgbGV0IG1hdGNoID0gZmFsc2U7XG4gICAgYXJyYXlUb0ZpbmRNYXRjaC5mb3JFYWNoKChtb3ZlKSA9PiB7XG4gICAgICBpZiAobW92ZVswXSA9PSBjb29yZHNbMF0gJiYgbW92ZVsxXSA9PSBjb29yZHNbMV0pIHtcbiAgICAgICAgLy8gY29uc29sZS5sb2coXCJ0cnVlXCIpO1xuICAgICAgICBtYXRjaCA9IHRydWU7XG4gICAgICB9XG4gICAgfSk7XG5cbiAgICBpZiAobWF0Y2ggPT0gdHJ1ZSkge1xuICAgICAgcmV0dXJuIHRydWU7XG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gIH07XG5cbiAgY29uc3Qgc2V0VXBDbGlja1RvSGl0ID0gZnVuY3Rpb24gKCkge1xuICAgIGxldCBzcXVhcmVzID0gZG9jdW1lbnQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZShcImNvbXB1dGVyLXNxdWFyZVwiKTtcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IHNxdWFyZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgIHNxdWFyZXNbaV0uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgICAgICAgcmVjZWl2ZUF0dGFjayhcbiAgICAgICAgICBjbGFzc1RvQ29vcmRzKHNxdWFyZXNbaV0pLFxuICAgICAgICAgIHNxdWFyZXNbaV0sXG4gICAgICAgICAgcDJHYW1lYm9hcmQuYm9hcmQsXG4gICAgICAgICAgcDJHYW1lYm9hcmQucG90ZW50aWFsTW92ZXNcbiAgICAgICAgKTtcbiAgICAgIH0pO1xuICAgIH1cbiAgfTtcblxuICBjb25zdCBkaXNwbGF5SGl0ID0gZnVuY3Rpb24gKHNxdWFyZSkge1xuICAgIHNxdWFyZS5jbGFzc0xpc3QuYWRkKFwiaGl0XCIpO1xuICB9O1xuXG4gIGNvbnN0IGRpc3BsYXlNaXNzID0gZnVuY3Rpb24gKHNxdWFyZSkge1xuICAgIHNxdWFyZS5jbGFzc0xpc3QuYWRkKFwibWlzc1wiKTtcbiAgfTtcblxuICBjb25zdCBkaXNhYmxlQ2xpY2sgPSBmdW5jdGlvbiAoKSB7XG4gICAgbGV0IHNxdWFyZXMgPSBkb2N1bWVudC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKFwiY29tcHV0ZXItc3F1YXJlXCIpO1xuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgc3F1YXJlcy5sZW5ndGg7IGkrKykge1xuICAgICAgc3F1YXJlc1tpXS5jbGFzc0xpc3QuYWRkKFwiZGlzYWJsZWRcIik7XG4gICAgfVxuICB9O1xuXG4gIGNvbnN0IGVuYWJsZUNsaWNrID0gZnVuY3Rpb24gKCkge1xuICAgIGxldCBzcXVhcmVzID0gZG9jdW1lbnQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZShcImNvbXB1dGVyLXNxdWFyZVwiKTtcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IHNxdWFyZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgIHNxdWFyZXNbaV0uY2xhc3NMaXN0LnJlbW92ZShcImRpc2FibGVkXCIpO1xuICAgIH1cbiAgfTtcblxuICBjb25zdCBzd2FwUGxheWVyID0gZnVuY3Rpb24gKCkge1xuICAgIGlmIChjdXJyZW50UGxheWVyID09IHBsYXllck9uZSkge1xuICAgICAgZGlzYWJsZUNsaWNrKCk7XG4gICAgICBjdXJyZW50UGxheWVyID0gcGxheWVyVHdvO1xuICAgICAgbGV0IHJhbmRvbUNvb3JkcyA9IGN1cnJlbnRQbGF5ZXIucmFuZG9tQXR0YWNrKHAxR2FtZWJvYXJkKTtcbiAgICAgIGxldCBzcXVhcmUgPSBjb29yZHNUb1NxdWFyZShyYW5kb21Db29yZHMpO1xuXG4gICAgICByZWNlaXZlQXR0YWNrKFxuICAgICAgICByYW5kb21Db29yZHMsXG4gICAgICAgIHNxdWFyZSxcbiAgICAgICAgcDFHYW1lYm9hcmQuYm9hcmQsXG4gICAgICAgIHAxR2FtZWJvYXJkLnBvdGVudGlhbE1vdmVzXG4gICAgICApO1xuICAgIH0gZWxzZSB7XG4gICAgICBlbmFibGVDbGljaygpO1xuICAgICAgY3VycmVudFBsYXllciA9IHBsYXllck9uZTtcbiAgICB9XG4gICAgY29uc29sZS5sb2coXCJzd2FwXCIpO1xuICAgIGNvbnNvbGUubG9nKGN1cnJlbnRQbGF5ZXIpO1xuICB9O1xuXG4gIGNvbnN0IGNsYXNzVG9Db29yZHMgPSBmdW5jdGlvbiAoaW5kaXZpZHVhbFNxdWFyZSkge1xuICAgIGxldCBjbGFzc2VzID0gaW5kaXZpZHVhbFNxdWFyZS5jbGFzc0xpc3Q7XG4gICAgbGV0IHggPSBjbGFzc2VzWzFdO1xuICAgIGxldCB5ID0gXCJvb3BzXCI7IC8vIHRvIHN0b3AgZXJyb3JzXG4gICAgbGV0IHRlbXAgPSBwYXJzZUludChjbGFzc2VzWzJdKTtcbiAgICBpZiAocGFyc2VJbnQoY2xhc3Nlc1syXSkgPj0gMCkge1xuICAgICAgeSA9IGNsYXNzZXNbMl07XG4gICAgfSBlbHNlIHtcbiAgICAgIHkgPSBjbGFzc2VzWzFdO1xuICAgIH1cbiAgICByZXR1cm4gW3gsIHldO1xuICB9O1xuXG4gIGNvbnN0IHNldFVwR2FtZSA9IGZ1bmN0aW9uICgpIHtcbiAgICBzZXRVcFBsYXllck9uZVNoaXBzKCk7XG4gICAgc2V0VXBQbGF5ZXJUd29TaGlwcygpO1xuICAgIHAxR2FtZWJvYXJkLmRyYXdCb2FyZCgpO1xuICAgIHAyR2FtZWJvYXJkLmRyYXdDb21wdXRlckJvYXJkKCk7XG4gICAgc2V0VXBDbGlja1RvSGl0KCk7XG4gIH07XG5cbiAgcmV0dXJuIHsgc2V0VXBHYW1lLCBwMUdhbWVib2FyZCwgcDJHYW1lYm9hcmQgfTtcbn07XG5cbmV4cG9ydCB7IEdhbWUgfTtcbiIsImltcG9ydCB7IFNoaXAgfSBmcm9tIFwiLi9zaGlwXCI7XG5pbXBvcnQgeyBHYW1lQm9hcmQgfSBmcm9tIFwiLi9nYW1lQm9hcmRcIjtcbmltcG9ydCB7IFBsYXllciB9IGZyb20gXCIuL3BsYXllclwiO1xuaW1wb3J0IHsgR2FtZSB9IGZyb20gXCIuL2dhbWVcIjtcblxuLy8gY29uc3QgZ2IxID0gR2FtZUJvYXJkKCk7XG4vLyBjb25zdCBnYjIgPSBHYW1lQm9hcmQoKTtcblxuLy8gLy8gY29uc3QgZ2FtZSA9IEdhbWUoKTtcbi8vIC8vIGNvbnN0IHBsYXllciA9IFBsYXllcigpO1xuLy8gLy8gY29uc3Qgc2hpcCA9IFNoaXAoKTtcbi8vIC8vIHNoaXAuY29vcmRzLnB1c2goWzAsIDFdKTtcbi8vIC8vIGdiLmdldFBvdGVudGlhbE1vdmVzKCk7XG4vLyAvLyBsZXQgbW92ZXMgPSBnYi5wb3RlbnRpYWxNb3Zlcztcbi8vIC8vIGNvbnNvbGUubG9nKGdiLnBvdGVudGlhbE1vdmVzLmxlbmd0aCkgO1xuLy8gLy8gZ2IucmVjZWl2ZUF0dGFjayhzaGlwLCBbMCwgM10pO1xuLy8gLy8gY29uc29sZS5sb2coZ2IucG90ZW50aWFsTW92ZXMubGVuZ3RoKTtcbi8vIGdiMS5kcmF3Qm9hcmQoKTtcbi8vIGdiMi5kcmF3Qm9hcmQoKTtcbmNvbnN0IGdhbWUgPSBHYW1lKCk7XG5nYW1lLnNldFVwR2FtZSgpO1xuXG4vLyBnYW1lLnAxR2FtZWJvYXJkLmRyYXdCb2FyZCgpO1xuLy8gZ2FtZS5wMkdhbWVib2FyZC5kcmF3Q29tcHV0ZXJCb2FyZCgpO1xuLy8gZ2FtZS5wMUdhbWVib2FyZC5zZXRVcENsaWNrVG9IaXQoKTtcbi8vIGdhbWUucDJHYW1lYm9hcmQuc2V0VXBDbGlja1RvSGl0KCk7XG4iXSwibmFtZXMiOlsiU2hpcCIsImxlbmd0aCIsIm51bWJlck9mSGl0cyIsInN1bmsiLCJzaGlwTGVuZ3RoIiwiaXNTdW5rIiwiaGl0IiwiY29vcmRzIiwiR2FtZUJvYXJkIiwicGxheWVyT25lIiwicGxheWVyVHdvIiwic3Vua1NoaXBzIiwicG90ZW50aWFsTW92ZXMiLCJib2FyZCIsImhvcml6b250YWwiLCJzaGlwIiwic3RhcnRSb3dDb29yZHMiLCJzdGFydENvbHVtbkNvb3JkcyIsImkiLCJjdXJyZW50Q29vcmQiLCJwdXNoIiwidmVydGljYWwiLCJtaXNzZWRDb29yZHMiLCJjdXJyZW50U2hpcHMiLCJhbGxTdW5rIiwiYWxlcnQiLCJnZXRQb3RlbnRpYWxNb3ZlcyIsImEiLCJkcmF3Qm9hcmQiLCJjb250YWluZXIiLCJkb2N1bWVudCIsImdldEVsZW1lbnRzQnlDbGFzc05hbWUiLCJib2FyZENvbnRhaW5lciIsImNyZWF0ZUVsZW1lbnQiLCJjbGFzc0xpc3QiLCJhZGQiLCJhcHBlbmRDaGlsZCIsImluZGl2aWR1YWxTcXVhcmUiLCJkcmF3Q29tcHV0ZXJCb2FyZCIsIlBsYXllciIsImxlZ2FsTW92ZXMiLCJyYW5kb21BdHRhY2siLCJvcHBvbmVudEdhbWVib2FyZCIsImNvbnNvbGUiLCJsb2ciLCJyYW5kb21JbmRleCIsIm1heCIsIk1hdGgiLCJmbG9vciIsInJhbmRvbSIsIm5hbWUiLCJnZXRMZWdhbE1vdmVzIiwiY2hlY2tNaXNzZWRDb29yZHNGb3JNYXRjaCIsIm9wcG9uZW50R2FtZWJvYXJkTWlzc2VkQ29vcmRzQXJyYXkiLCJtYXRjaCIsImF2YWlsYWJsZU1vdmVzIiwicDFHYW1lYm9hcmQiLCJwMkdhbWVib2FyZCIsImN1cnJlbnRQbGF5ZXIiLCJyZWNlaXZlQXR0YWNrIiwic3F1YXJlIiwibWF0Y2hNb3ZlIiwiZGlzcGxheU1pc3MiLCJzd2FwUGxheWVyIiwic3dhcHBlZENvb3JkcyIsImRpc3BsYXlIaXQiLCJzaGlwU3VuayIsImFyciIsIml0ZW0iLCJzcGxpY2UiLCJyZW1vdmVBbGxJbnN0YW5jZXMiLCJhcnJheVRvRmluZE1hdGNoIiwiZm9yRWFjaCIsIm1vdmUiLCJzcXVhcmVzIiwiZGlzYWJsZUNsaWNrIiwicmFuZG9tQ29vcmRzIiwiY29YIiwiY29ZIiwicmFuZG9tQXR0YWNrQ29vcmRzIiwiY2xhc3NUb0Nvb3JkcyIsInNxdWFyZVRvQXR0YWNrIiwiY29vcmRzVG9TcXVhcmUiLCJyZW1vdmUiLCJlbmFibGVDbGljayIsImNsYXNzZXMiLCJ4IiwieSIsInBhcnNlSW50Iiwic2V0VXBHYW1lIiwicDFzaGlwMiIsInAxc2hpcDNhIiwicDFzaGlwM2IiLCJwMXNoaXA0IiwicDFzaGlwNSIsInNldFVwUGxheWVyT25lU2hpcHMiLCJwMnNoaXAyIiwicDJzaGlwM2EiLCJwMnNoaXAzYiIsInAyc2hpcDQiLCJwMnNoaXA1Iiwic2V0VXBQbGF5ZXJUd29TaGlwcyIsImFkZEV2ZW50TGlzdGVuZXIiLCJzZXRVcENsaWNrVG9IaXQiLCJHYW1lIl0sInNvdXJjZVJvb3QiOiIifQ==