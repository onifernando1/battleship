(()=>{"use strict";const o=function(o){let s=0,t=!1;return{shipLength:o,numberOfHits:s,isSunk:function(){return s>=o&&(t=!0,!0)},hit:function(){s+=1},coords:[],length:o,sunk:t}},s=function(o,s){let t=[],e=[],r=[[[" "],[" "],[" "],[" "],[" "],[" "],[" "],[" "],[" "],[" "]],[[" "],[" "],[" "],[" "],[" "],[" "],[" "],[" "],[" "],[" "]],[[" "],[" "],[" "],[" "],[" "],[" "],[" "],[" "],[" "],[" "]],[[" "],[" "],[" "],[" "],[" "],[" "],[" "],[" "],[" "],[" "]],[[" "],[" "],[" "],[" "],[" "],[" "],[" "],[" "],[" "],[" "]],[[" "],[" "],[" "],[" "],[" "],[" "],[" "],[" "],[" "],[" "]],[[" "],[" "],[" "],[" "],[" "],[" "],[" "],[" "],[" "],[" "]],[[" "],[" "],[" "],[" "],[" "],[" "],[" "],[" "],[" "],[" "]],[[" "],[" "],[" "],[" "],[" "],[" "],[" "],[" "],[" "],[" "]],[[" "],[" "],[" "],[" "],[" "],[" "],[" "],[" "],[" "],[" "]]];return{board:r,horizontal:function(o,s,t){for(let e=0;e<o.shipLength;e++){let r=[s,e+t];o.coords.push(r)}},vertical:function(o,s,t){for(let e=0;e<o.shipLength;e++){let r=[e+s,t];o.coords.push(r)}},missedCoords:[],currentShips:[],allSunk:function(){return 5==t.length&&(alert("DONE!"),!0)},getPotentialMoves:function(){for(let o=0;o<10;o++)for(let s=0;s<10;s++)e.push([s,o])},potentialMoves:e,drawBoard:function(){const o=document.getElementsByClassName("container")[0];let s=document.createElement("div");s.classList.add("board-container"),o.appendChild(s);for(let o=0;o<r.length;o++)for(let t=0;t<r.length;t++){let e=document.createElement("div");e.classList.add("individual-square"),e.classList.add(t),e.classList.add(o),s.appendChild(e)," "!=r[o][t]&&e.classList.add("ship")}},drawComputerBoard:function(){const o=document.getElementsByClassName("container")[0];let s=document.createElement("div");s.classList.add("board-container"),o.appendChild(s);for(let o=0;o<r.length;o++)for(let t=0;t<r.length;t++){let e=document.createElement("div");e.classList.add("computer-square"),e.classList.add(t),e.classList.add(o),s.appendChild(e)}},sunkShips:t}},t=function(){let o=[];const s=function(o){console.log("random attack");let s=(t=o.potentialMoves.length-1,Math.floor(Math.random()*t));var t;return o.potentialMoves[s]};return{name:"",randomAttack:s,getLegalMoves:function(s){o=[];for(let t=0;t<s.board.length;t++)for(let e=0;e<10;e++)" "==s.board[t][e]&&o.push([t,e])},randomAttack:s,checkMissedCoordsForMatch:function(o,s){let t=!1;availableMoves=[];for(let e=0;e<s.length;e++)o[0]==s[e][0]&&o[1]==s[e][1]?t=!0:availableMoves.push([o[0],o[1]]);return 1==t}}};(function(){let e=t();e.name="playerOne";let r=t();r.name="playerTwo";let n=s(),d=s();n.getPotentialMoves(),d.getPotentialMoves();let a=e;const c=function(o,s,t,r){let c=t[o[1]][o[0]];if(console.log(`coords = ${o}`),0==i(r,o))console.log("Retry bro");else{if(" "==c)a==e?d.missedCoords.push(o):n.missedCoords.push(o),console.log("miss"),p(s),m();else{let t=[];t.push(o[1]),t.push(o[0]),i(c.coords,t)&&(c.hit(),h(s),c.isSunk(),c.isSunk()&&(u(c),a==e?d.sunkShips.push(c):n.sunkShips.push(c)),console.log("hit"),t=[],m())}i(r,o)&&function(o,s){for(let t=o.length;t--;)o[t][0]==s[0]&&o[t][1]==s[1]&&o.splice(t,1)}(r,o)}},u=function(o){for(let s=0;s<o.coords.length;s++){let t=o.coords[s][1],e=o.coords[s][0];l([t,e]).classList.add("sunk")}},l=function(o){let s=o[0],t=o[1],e="";e=a==r?document.getElementsByClassName("individual-square"):document.getElementsByClassName("computer-square");for(let o=0;o<e.length;o++){let r=f(e[o]);if(s==r[0]&&t==r[1]){let s=e[o];return console.log(s),s}}},i=function(o,s){let t=!1;return o.forEach((o=>{o[0]==s[0]&&o[1]==s[1]&&(t=!0)})),1==t},h=function(o){o.classList.add("hit")},p=function(o){o.classList.add("miss")},m=function(){if(a==e){!function(){let o=document.getElementsByClassName("computer-square");for(let s=0;s<o.length;s++)o[s].classList.add("disabled")}(),a=r;let o=a.randomAttack(n),s=l(o);c(o,s,n.board,n.potentialMoves)}else!function(){let o=document.getElementsByClassName("computer-square");for(let s=0;s<o.length;s++)o[s].classList.remove("disabled")}(),a=e;console.log("swap"),console.log(a)},f=function(o){let s=o.classList,t=s[1],e="oops";return parseInt(s[2]),e=parseInt(s[2])>=0?s[2]:s[1],[t,e]};return{setUpGame:function(){!function(){const s=o(2);s.coords.push([0,0]),s.coords.push([0,1]),n.board[0][0]=s,n.board[0][1]=s;const t=o(3);t.coords.push([1,0]),t.coords.push([1,1]),t.coords.push([1,2]),n.board[1][0]=t,n.board[1][1]=t,n.board[1][2]=t;const e=o(3);e.coords.push([2,0]),e.coords.push([2,1]),e.coords.push([2,2]),n.board[2][0]=e,n.board[2][1]=e,n.board[2][2]=e;const r=o(4);r.coords.push([3,0]),r.coords.push([3,1]),r.coords.push([3,2]),r.coords.push([3,3]),n.board[3][0]=r,n.board[3][1]=r,n.board[3][2]=r,n.board[3][3]=r;const d=o(5);d.coords.push([4,0]),d.coords.push([4,1]),d.coords.push([4,2]),d.coords.push([4,3]),d.coords.push([4,4]),n.board[4][0]=d,n.board[4][1]=d,n.board[4][2]=d,n.board[4][3]=d,n.board[4][4]=d,n.currentShips.push(s),n.currentShips.push(t),n.currentShips.push(e),n.currentShips.push(r),n.currentShips.push(d)}(),function(){const s=o(2);s.coords.push([0,0]),s.coords.push([0,1]),d.board[0][0]=s,d.board[0][1]=s;const t=o(3);t.coords.push([1,0]),t.coords.push([1,1]),t.coords.push([1,2]),d.board[1][0]=t,d.board[1][1]=t,d.board[1][2]=t;const e=o(3);e.coords.push([2,0]),e.coords.push([2,1]),e.coords.push([2,2]),d.board[2][0]=e,d.board[2][1]=e,d.board[2][2]=e;const r=o(4);r.coords.push([3,0]),r.coords.push([3,1]),r.coords.push([3,2]),r.coords.push([3,3]),d.board[3][0]=r,d.board[3][1]=r,d.board[3][2]=r,d.board[3][3]=r;const n=o(5);n.coords.push([4,0]),n.coords.push([4,1]),n.coords.push([4,2]),n.coords.push([4,3]),n.coords.push([4,4]),d.board[4][0]=n,d.board[4][1]=n,d.board[4][2]=n,d.board[4][3]=n,d.board[4][4]=n,d.currentShips.push(s),d.currentShips.push(t),d.currentShips.push(e),d.currentShips.push(r),d.currentShips.push(n)}(),n.drawBoard(),d.drawComputerBoard(),function(){let o=document.getElementsByClassName("computer-square");for(let s=0;s<o.length;s++)o[s].addEventListener("click",(()=>{c(f(o[s]),o[s],d.board,d.potentialMoves)}))}()},p1Gameboard:n,p2Gameboard:d}})().setUpGame()})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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Li9zcmMvc2hpcC5qcyIsIndlYnBhY2s6Ly9iYXR0bGVzaGlwLy4vc3JjL2dhbWVCb2FyZC5qcyIsIndlYnBhY2s6Ly9iYXR0bGVzaGlwLy4vc3JjL3BsYXllci5qcyIsIndlYnBhY2s6Ly9iYXR0bGVzaGlwLy4vc3JjL2dhbWUuanMiLCJ3ZWJwYWNrOi8vYmF0dGxlc2hpcC8uL3NyYy9pbmRleC5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCBTaGlwID0gZnVuY3Rpb24gKGxlbmd0aCkge1xuICBjb25zdCBzaGlwTGVuZ3RoID0gbGVuZ3RoO1xuICBsZXQgbnVtYmVyT2ZIaXRzID0gMDtcbiAgbGV0IHN1bmsgPSBmYWxzZTtcbiAgbGV0IGNvb3JkcyA9IFtdO1xuXG4gIGNvbnN0IGhpdCA9IGZ1bmN0aW9uICgpIHtcbiAgICBudW1iZXJPZkhpdHMgKz0gMTtcbiAgfTtcblxuICBjb25zdCBpc1N1bmsgPSBmdW5jdGlvbiAoKSB7XG4gICAgaWYgKG51bWJlck9mSGl0cyA+PSBsZW5ndGgpIHtcbiAgICAgIHN1bmsgPSB0cnVlO1xuICAgICAgcmV0dXJuIHRydWU7XG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gIH07XG5cbiAgcmV0dXJuIHsgc2hpcExlbmd0aCwgbnVtYmVyT2ZIaXRzLCBpc1N1bmssIGhpdCwgY29vcmRzLCBsZW5ndGgsIHN1bmsgfTtcbn07XG5cbmV4cG9ydCB7IFNoaXAgfTtcbiIsImNvbnN0IEdhbWVCb2FyZCA9IGZ1bmN0aW9uIChwbGF5ZXJPbmUsIHBsYXllclR3bykge1xuICBsZXQgc2hpcFBsYWNlbWVudE1vZGUgPSBcImhvcml6b250YWxcIjtcbiAgbGV0IGN1cnJlbnRTaGlwcyA9IFtdO1xuICBsZXQgc3Vua1NoaXBzID0gW107XG4gIGNvbnN0IG1pc3NlZENvb3JkcyA9IFtdO1xuICBsZXQgcG90ZW50aWFsTW92ZXMgPSBbXTtcbiAgbGV0IGN1cnJlbnRQbGF5ZXIgPSBwbGF5ZXJPbmU7XG5cbiAgbGV0IGJvYXJkID0gW1xuICAgIFtbXCIgXCJdLCBbXCIgXCJdLCBbXCIgXCJdLCBbXCIgXCJdLCBbXCIgXCJdLCBbXCIgXCJdLCBbXCIgXCJdLCBbXCIgXCJdLCBbXCIgXCJdLCBbXCIgXCJdXSxcbiAgICBbW1wiIFwiXSwgW1wiIFwiXSwgW1wiIFwiXSwgW1wiIFwiXSwgW1wiIFwiXSwgW1wiIFwiXSwgW1wiIFwiXSwgW1wiIFwiXSwgW1wiIFwiXSwgW1wiIFwiXV0sXG4gICAgW1tcIiBcIl0sIFtcIiBcIl0sIFtcIiBcIl0sIFtcIiBcIl0sIFtcIiBcIl0sIFtcIiBcIl0sIFtcIiBcIl0sIFtcIiBcIl0sIFtcIiBcIl0sIFtcIiBcIl1dLFxuICAgIFtbXCIgXCJdLCBbXCIgXCJdLCBbXCIgXCJdLCBbXCIgXCJdLCBbXCIgXCJdLCBbXCIgXCJdLCBbXCIgXCJdLCBbXCIgXCJdLCBbXCIgXCJdLCBbXCIgXCJdXSxcbiAgICBbW1wiIFwiXSwgW1wiIFwiXSwgW1wiIFwiXSwgW1wiIFwiXSwgW1wiIFwiXSwgW1wiIFwiXSwgW1wiIFwiXSwgW1wiIFwiXSwgW1wiIFwiXSwgW1wiIFwiXV0sXG4gICAgW1tcIiBcIl0sIFtcIiBcIl0sIFtcIiBcIl0sIFtcIiBcIl0sIFtcIiBcIl0sIFtcIiBcIl0sIFtcIiBcIl0sIFtcIiBcIl0sIFtcIiBcIl0sIFtcIiBcIl1dLFxuICAgIFtbXCIgXCJdLCBbXCIgXCJdLCBbXCIgXCJdLCBbXCIgXCJdLCBbXCIgXCJdLCBbXCIgXCJdLCBbXCIgXCJdLCBbXCIgXCJdLCBbXCIgXCJdLCBbXCIgXCJdXSxcbiAgICBbW1wiIFwiXSwgW1wiIFwiXSwgW1wiIFwiXSwgW1wiIFwiXSwgW1wiIFwiXSwgW1wiIFwiXSwgW1wiIFwiXSwgW1wiIFwiXSwgW1wiIFwiXSwgW1wiIFwiXV0sXG4gICAgW1tcIiBcIl0sIFtcIiBcIl0sIFtcIiBcIl0sIFtcIiBcIl0sIFtcIiBcIl0sIFtcIiBcIl0sIFtcIiBcIl0sIFtcIiBcIl0sIFtcIiBcIl0sIFtcIiBcIl1dLFxuICAgIFtbXCIgXCJdLCBbXCIgXCJdLCBbXCIgXCJdLCBbXCIgXCJdLCBbXCIgXCJdLCBbXCIgXCJdLCBbXCIgXCJdLCBbXCIgXCJdLCBbXCIgXCJdLCBbXCIgXCJdXSxcbiAgXTtcblxuICBjb25zdCBnZXRQb3RlbnRpYWxNb3ZlcyA9IGZ1bmN0aW9uICgpIHtcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IDEwOyBpKyspIHtcbiAgICAgIGZvciAobGV0IGEgPSAwOyBhIDwgMTA7IGErKykge1xuICAgICAgICBwb3RlbnRpYWxNb3Zlcy5wdXNoKFthLCBpXSk7XG4gICAgICB9XG4gICAgfVxuICB9O1xuXG4gIC8vIGNvbnN0IHNldFVwQ2xpY2tUb0hpdCA9IGZ1bmN0aW9uICgpIHtcbiAgLy8gICBsZXQgc3F1YXJlcyA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoXCJjb21wdXRlci1zcXVhcmVcIik7XG4gIC8vICAgZm9yIChsZXQgaSA9IDA7IGkgPCBzcXVhcmVzLmxlbmd0aDsgaSsrKSB7XG4gIC8vICAgICBzcXVhcmVzW2ldLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gIC8vICAgICAgIHJlY2VpdmVBdHRhY2soY2xhc3NUb0Nvb3JkcyhzcXVhcmVzW2ldKSwgc3F1YXJlc1tpXSk7XG4gIC8vICAgICB9KTtcbiAgLy8gICB9XG4gIC8vIH07XG5cbiAgLy8gY29uc3QgZGlzYWJsZUNsaWNrID0gZnVuY3Rpb24gKCkge1xuICAvLyAgIGxldCBzcXVhcmVzID0gZG9jdW1lbnQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZShcImNvbXB1dGVyLXNxdWFyZVwiKTtcbiAgLy8gICBmb3IgKGxldCBpID0gMDsgaSA8IHNxdWFyZXMubGVuZ3RoOyBpKyspIHtcbiAgLy8gICAgIHNxdWFyZXNbaV0uY2xhc3NMaXN0LmFkZChcImRpc2FibGVkXCIpO1xuICAvLyAgIH1cbiAgLy8gfTtcblxuICAvLyBjb25zdCBlbmFibGVDbGljayA9IGZ1bmN0aW9uICgpIHtcbiAgLy8gICBsZXQgc3F1YXJlcyA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoXCJjb21wdXRlci1zcXVhcmVcIik7XG4gIC8vICAgZm9yIChsZXQgaSA9IDA7IGkgPCBzcXVhcmVzLmxlbmd0aDsgaSsrKSB7XG4gIC8vICAgICBzcXVhcmVzW2ldLmNsYXNzTGlzdC5yZW1vdmUoXCJkaXNhYmxlZFwiKTtcbiAgLy8gICB9XG4gIC8vIH07XG5cbiAgY29uc3QgaG9yaXpvbnRhbCA9IGZ1bmN0aW9uIChzaGlwLCBzdGFydFJvd0Nvb3Jkcywgc3RhcnRDb2x1bW5Db29yZHMpIHtcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IHNoaXAuc2hpcExlbmd0aDsgaSsrKSB7XG4gICAgICBsZXQgY3VycmVudENvb3JkID0gW3N0YXJ0Um93Q29vcmRzLCBpICsgc3RhcnRDb2x1bW5Db29yZHNdO1xuICAgICAgc2hpcC5jb29yZHMucHVzaChjdXJyZW50Q29vcmQpO1xuICAgIH1cbiAgfTtcblxuICBjb25zdCB2ZXJ0aWNhbCA9IGZ1bmN0aW9uIChzaGlwLCBzdGFydFJvd0Nvb3Jkcywgc3RhcnRDb2x1bW5Db29yZHMpIHtcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IHNoaXAuc2hpcExlbmd0aDsgaSsrKSB7XG4gICAgICBsZXQgY3VycmVudENvb3JkID0gW2kgKyBzdGFydFJvd0Nvb3Jkcywgc3RhcnRDb2x1bW5Db29yZHNdO1xuICAgICAgc2hpcC5jb29yZHMucHVzaChjdXJyZW50Q29vcmQpO1xuICAgIH1cbiAgfTtcblxuICBjb25zdCBwbGFjZVNoaXAgPSBmdW5jdGlvbiAoc2hpcCkge1xuICAgIHNoaXAuY29vcmRzLmZvckVhY2goKGNvb3JkKSA9PiB7XG4gICAgICBsZXQgb3V0ZXIgPSBjb29yZFswXTtcbiAgICAgIGxldCBpbm5lciA9IGNvb3JkWzFdO1xuICAgICAgYm9hcmRbb3V0ZXJdW2lubmVyXSA9IHNoaXA7XG4gICAgfSk7XG4gIH07XG5cbiAgY29uc3Qgc2V0U2hpcFBvc2l0aW9uID0gZnVuY3Rpb24gKHNoaXAsIHN0YXJ0Um93Q29vcmRzLCBzdGFydENvbHVtbkNvb3Jkcykge1xuICAgIGlmIChzaGlwUGxhY2VtZW50TW9kZSA9PSBcImhvcml6b250YWxcIikge1xuICAgICAgaG9yaXpvbnRhbChzaGlwLCBzdGFydFJvd0Nvb3Jkcywgc3RhcnRDb2x1bW5Db29yZHMpO1xuICAgIH0gZWxzZSBpZiAoc2hpcFBsYWNlbWVudE1vZGUgPT0gXCJ2ZXJ0aWNhbFwiKSB7XG4gICAgICB2ZXJ0aWNhbChzaGlwLCBzdGFydFJvd0Nvb3Jkcywgc3RhcnRDb2x1bW5Db29yZHMpO1xuICAgIH1cbiAgfTtcblxuICBjb25zdCBzaGlwU3VuayA9IGZ1bmN0aW9uIChzaGlwKSB7XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBzaGlwLmNvb3Jkcy5sZW5ndGg7IGkrKykge1xuICAgICAgbGV0IHggPSBzaGlwLmNvb3Jkc1tpXVswXTtcbiAgICAgIGxldCB5ID0gc2hpcC5jb29yZHNbaV1bMV07XG4gICAgfVxuICB9O1xuXG4gIGNvbnN0IGFsbFN1bmsgPSBmdW5jdGlvbiAoKSB7XG4gICAgaWYgKHN1bmtTaGlwcy5sZW5ndGggPT0gNSkge1xuICAgICAgYWxlcnQoXCJET05FIVwiKTtcbiAgICAgIHJldHVybiB0cnVlO1xuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICB9O1xuXG4gIGNvbnN0IGRyYXdCb2FyZCA9IGZ1bmN0aW9uICgpIHtcbiAgICBjb25zdCBjb250YWluZXIgPSBkb2N1bWVudC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKFwiY29udGFpbmVyXCIpWzBdO1xuICAgIGxldCBib2FyZENvbnRhaW5lciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XG4gICAgYm9hcmRDb250YWluZXIuY2xhc3NMaXN0LmFkZChcImJvYXJkLWNvbnRhaW5lclwiKTtcbiAgICBjb250YWluZXIuYXBwZW5kQ2hpbGQoYm9hcmRDb250YWluZXIpO1xuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgYm9hcmQubGVuZ3RoOyBpKyspIHtcbiAgICAgIGZvciAobGV0IGEgPSAwOyBhIDwgYm9hcmQubGVuZ3RoOyBhKyspIHtcbiAgICAgICAgbGV0IGluZGl2aWR1YWxTcXVhcmUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xuICAgICAgICBpbmRpdmlkdWFsU3F1YXJlLmNsYXNzTGlzdC5hZGQoXCJpbmRpdmlkdWFsLXNxdWFyZVwiKTtcbiAgICAgICAgaW5kaXZpZHVhbFNxdWFyZS5jbGFzc0xpc3QuYWRkKGEpOyAvLyB4XG4gICAgICAgIGluZGl2aWR1YWxTcXVhcmUuY2xhc3NMaXN0LmFkZChpKTsgLy8geVxuICAgICAgICBib2FyZENvbnRhaW5lci5hcHBlbmRDaGlsZChpbmRpdmlkdWFsU3F1YXJlKTtcbiAgICAgICAgaWYgKGJvYXJkW2ldW2FdICE9IFwiIFwiKSB7XG4gICAgICAgICAgaW5kaXZpZHVhbFNxdWFyZS5jbGFzc0xpc3QuYWRkKFwic2hpcFwiKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgfTtcblxuICBjb25zdCBkcmF3Q29tcHV0ZXJCb2FyZCA9IGZ1bmN0aW9uICgpIHtcbiAgICBjb25zdCBjb250YWluZXIgPSBkb2N1bWVudC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKFwiY29udGFpbmVyXCIpWzBdO1xuICAgIGxldCBib2FyZENvbnRhaW5lciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XG4gICAgYm9hcmRDb250YWluZXIuY2xhc3NMaXN0LmFkZChcImJvYXJkLWNvbnRhaW5lclwiKTtcbiAgICBjb250YWluZXIuYXBwZW5kQ2hpbGQoYm9hcmRDb250YWluZXIpO1xuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgYm9hcmQubGVuZ3RoOyBpKyspIHtcbiAgICAgIGZvciAobGV0IGEgPSAwOyBhIDwgYm9hcmQubGVuZ3RoOyBhKyspIHtcbiAgICAgICAgbGV0IGluZGl2aWR1YWxTcXVhcmUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xuICAgICAgICBpbmRpdmlkdWFsU3F1YXJlLmNsYXNzTGlzdC5hZGQoXCJjb21wdXRlci1zcXVhcmVcIik7XG4gICAgICAgIGluZGl2aWR1YWxTcXVhcmUuY2xhc3NMaXN0LmFkZChhKTsgLy8geFxuICAgICAgICBpbmRpdmlkdWFsU3F1YXJlLmNsYXNzTGlzdC5hZGQoaSk7IC8vIHlcbiAgICAgICAgYm9hcmRDb250YWluZXIuYXBwZW5kQ2hpbGQoaW5kaXZpZHVhbFNxdWFyZSk7XG4gICAgICB9XG4gICAgfVxuICB9O1xuXG4gIHJldHVybiB7XG4gICAgYm9hcmQsXG4gICAgaG9yaXpvbnRhbCxcbiAgICB2ZXJ0aWNhbCxcbiAgICBtaXNzZWRDb29yZHMsXG4gICAgY3VycmVudFNoaXBzLFxuICAgIGFsbFN1bmssXG4gICAgZ2V0UG90ZW50aWFsTW92ZXMsXG4gICAgcG90ZW50aWFsTW92ZXMsXG4gICAgZHJhd0JvYXJkLFxuICAgIGRyYXdDb21wdXRlckJvYXJkLFxuICAgIHN1bmtTaGlwcyxcbiAgfTtcbn07XG5cbmV4cG9ydCB7IEdhbWVCb2FyZCB9O1xuXG4vLyBjb25zdCBjaGVja05lc3RlZEFycmF5ID0gZnVuY3Rpb24gKGFycmF5LCBjb29yZHMpIHtcbi8vICAgbGV0IG1hdGNoID0gZmFsc2U7XG4vLyAgIGZvciAobGV0IGkgPSAwOyBpIDwgYXJyYXkubGVuZ3RoOyBpKyspIHtcbi8vICAgICBpZiAoYXJyYXlbaV0uaW5jbHVkZXMoY29vcmRzWzBdKSAmJiBhcnJheVtpXS5pbmNsdWRlcyhjb29yZHNbMV0pKSB7XG4vLyAgICAgICBtYXRjaCA9IHRydWU7XG4vLyAgICAgfVxuLy8gICB9XG4vLyAgIHJldHVybiBtYXRjaDtcbi8vIH07XG4iLCJpbXBvcnQgeyBHYW1lQm9hcmQgfSBmcm9tIFwiLi9nYW1lQm9hcmRcIjtcblxuY29uc3QgUGxheWVyID0gZnVuY3Rpb24gKCkge1xuICBjb25zdCBuYW1lID0gXCJcIjtcbiAgbGV0IGxlZ2FsTW92ZXMgPSBbXTtcbiAgLy8gbGV0IHByZXZpb3VzTW92ZXMgPSBbXTtcbiAgLy8gbGV0IGF2YWlsYWJsZU1vdmVzID0gW107XG5cbiAgY29uc3QgZ2V0TGVnYWxNb3ZlcyA9IGZ1bmN0aW9uIChvcHBvbmVudEdhbWVib2FyZCkge1xuICAgIGxlZ2FsTW92ZXMgPSBbXTtcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IG9wcG9uZW50R2FtZWJvYXJkLmJvYXJkLmxlbmd0aDsgaSsrKSB7XG4gICAgICBmb3IgKGxldCBhID0gMDsgYSA8IDEwOyBhKyspIHtcbiAgICAgICAgaWYgKG9wcG9uZW50R2FtZWJvYXJkLmJvYXJkW2ldW2FdID09IFwiIFwiKSB7XG4gICAgICAgICAgbGVnYWxNb3Zlcy5wdXNoKFtpLCBhXSk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gIH07XG5cbiAgY29uc3QgY2hlY2tNaXNzZWRDb29yZHNGb3JNYXRjaCA9IGZ1bmN0aW9uIChcbiAgICBjb29yZHMsXG4gICAgb3Bwb25lbnRHYW1lYm9hcmRNaXNzZWRDb29yZHNBcnJheVxuICApIHtcbiAgICBsZXQgbWF0Y2ggPSBmYWxzZTtcbiAgICBhdmFpbGFibGVNb3ZlcyA9IFtdO1xuXG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBvcHBvbmVudEdhbWVib2FyZE1pc3NlZENvb3Jkc0FycmF5Lmxlbmd0aDsgaSsrKSB7XG4gICAgICBpZiAoXG4gICAgICAgIGNvb3Jkc1swXSA9PSBvcHBvbmVudEdhbWVib2FyZE1pc3NlZENvb3Jkc0FycmF5W2ldWzBdICYmXG4gICAgICAgIGNvb3Jkc1sxXSA9PSBvcHBvbmVudEdhbWVib2FyZE1pc3NlZENvb3Jkc0FycmF5W2ldWzFdXG4gICAgICApIHtcbiAgICAgICAgbWF0Y2ggPSB0cnVlO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgYXZhaWxhYmxlTW92ZXMucHVzaChbY29vcmRzWzBdLCBjb29yZHNbMV1dKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICBpZiAobWF0Y2ggPT0gdHJ1ZSkge1xuICAgICAgcmV0dXJuIHRydWU7XG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gIH07XG5cbiAgZnVuY3Rpb24gZ2V0UmFuZG9tSW50KG1heCkge1xuICAgIHJldHVybiBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiBtYXgpO1xuICB9XG5cbiAgY29uc3QgcmFuZG9tQXR0YWNrID0gZnVuY3Rpb24gKG9wcG9uZW50R2FtZWJvYXJkKSB7XG4gICAgY29uc29sZS5sb2coXCJyYW5kb20gYXR0YWNrXCIpO1xuICAgIGxldCByYW5kb21JbmRleCA9IGdldFJhbmRvbUludChvcHBvbmVudEdhbWVib2FyZC5wb3RlbnRpYWxNb3Zlcy5sZW5ndGggLSAxKTtcbiAgICBsZXQgcmFuZG9tTW92ZSA9IG9wcG9uZW50R2FtZWJvYXJkLnBvdGVudGlhbE1vdmVzW3JhbmRvbUluZGV4XTtcbiAgICByZXR1cm4gcmFuZG9tTW92ZTtcbiAgfTtcblxuICByZXR1cm4ge1xuICAgIG5hbWUsXG4gICAgcmFuZG9tQXR0YWNrLFxuICAgIGdldExlZ2FsTW92ZXMsXG4gICAgcmFuZG9tQXR0YWNrLFxuICAgIGNoZWNrTWlzc2VkQ29vcmRzRm9yTWF0Y2gsXG4gIH07XG59O1xuXG5leHBvcnQgeyBQbGF5ZXIgfTtcbiIsImltcG9ydCB7IFNoaXAgfSBmcm9tIFwiLi9zaGlwXCI7XG5pbXBvcnQgeyBHYW1lQm9hcmQgfSBmcm9tIFwiLi9nYW1lQm9hcmRcIjtcbmltcG9ydCB7IFBsYXllciB9IGZyb20gXCIuL3BsYXllclwiO1xuXG4vLyBuZWVkIHRvIGNoYW5nZSBpZHMgb24gZWFjaCBnYW1lYm9hcmRcbi8vIGFkZCBpbiBzd2Fwc1xuLy8gZG9udCBhbGxvdyBhdHRhY2tpbmcgb3duIGdhbWVib2FyZFxuLy8gbWFrZSBjb21wdXRlciBtYWtlIG1vdmUgb24gaXRzIGdvXG4vL3NldCB0aW1lb3V0IHRvIGRlbGF5IG1vdmVcbi8vIGRpc3BsYXkgY2hhbmdlXG4vLyBlbmQgYXQgd2luXG5cbmNvbnN0IEdhbWUgPSBmdW5jdGlvbiAoKSB7XG4gIGxldCBwbGF5ZXJPbmUgPSBQbGF5ZXIoKTtcbiAgcGxheWVyT25lLm5hbWUgPSBcInBsYXllck9uZVwiO1xuICBsZXQgcGxheWVyVHdvID0gUGxheWVyKCk7XG4gIHBsYXllclR3by5uYW1lID0gXCJwbGF5ZXJUd29cIjtcbiAgbGV0IHAxR2FtZWJvYXJkID0gR2FtZUJvYXJkKHBsYXllck9uZSwgcGxheWVyVHdvKTtcbiAgbGV0IHAyR2FtZWJvYXJkID0gR2FtZUJvYXJkKHBsYXllck9uZSwgcGxheWVyVHdvKTtcbiAgcDFHYW1lYm9hcmQuZ2V0UG90ZW50aWFsTW92ZXMoKTtcbiAgcDJHYW1lYm9hcmQuZ2V0UG90ZW50aWFsTW92ZXMoKTtcbiAgbGV0IHdpbiA9IGZhbHNlO1xuICBsZXQgY3VycmVudFBsYXllciA9IHBsYXllck9uZTtcblxuICBjb25zdCBzZXRVcFBsYXllck9uZVNoaXBzID0gZnVuY3Rpb24gKCkge1xuICAgIC8vIHAxR2FtZWJvYXJkID0gR2FtZUJvYXJkKCk7XG4gICAgY29uc3QgcDFzaGlwMiA9IFNoaXAoMik7XG4gICAgcDFzaGlwMi5jb29yZHMucHVzaChbMCwgMF0pO1xuICAgIHAxc2hpcDIuY29vcmRzLnB1c2goWzAsIDFdKTtcbiAgICBwMUdhbWVib2FyZC5ib2FyZFswXVswXSA9IHAxc2hpcDI7XG4gICAgcDFHYW1lYm9hcmQuYm9hcmRbMF1bMV0gPSBwMXNoaXAyO1xuICAgIGNvbnN0IHAxc2hpcDNhID0gU2hpcCgzKTtcbiAgICAvLyBjb25zb2xlLmxvZyhgYWJjJHtwMXNoaXAzYS5sZW5ndGh9YCk7XG5cbiAgICBwMXNoaXAzYS5jb29yZHMucHVzaChbMSwgMF0pO1xuICAgIHAxc2hpcDNhLmNvb3Jkcy5wdXNoKFsxLCAxXSk7XG4gICAgcDFzaGlwM2EuY29vcmRzLnB1c2goWzEsIDJdKTtcbiAgICBwMUdhbWVib2FyZC5ib2FyZFsxXVswXSA9IHAxc2hpcDNhO1xuICAgIHAxR2FtZWJvYXJkLmJvYXJkWzFdWzFdID0gcDFzaGlwM2E7XG4gICAgcDFHYW1lYm9hcmQuYm9hcmRbMV1bMl0gPSBwMXNoaXAzYTtcbiAgICBjb25zdCBwMXNoaXAzYiA9IFNoaXAoMyk7XG4gICAgcDFzaGlwM2IuY29vcmRzLnB1c2goWzIsIDBdKTtcbiAgICBwMXNoaXAzYi5jb29yZHMucHVzaChbMiwgMV0pO1xuICAgIHAxc2hpcDNiLmNvb3Jkcy5wdXNoKFsyLCAyXSk7XG4gICAgcDFHYW1lYm9hcmQuYm9hcmRbMl1bMF0gPSBwMXNoaXAzYjtcbiAgICBwMUdhbWVib2FyZC5ib2FyZFsyXVsxXSA9IHAxc2hpcDNiO1xuICAgIHAxR2FtZWJvYXJkLmJvYXJkWzJdWzJdID0gcDFzaGlwM2I7XG4gICAgY29uc3QgcDFzaGlwNCA9IFNoaXAoNCk7XG4gICAgcDFzaGlwNC5jb29yZHMucHVzaChbMywgMF0pO1xuICAgIHAxc2hpcDQuY29vcmRzLnB1c2goWzMsIDFdKTtcbiAgICBwMXNoaXA0LmNvb3Jkcy5wdXNoKFszLCAyXSk7XG4gICAgcDFzaGlwNC5jb29yZHMucHVzaChbMywgM10pO1xuICAgIHAxR2FtZWJvYXJkLmJvYXJkWzNdWzBdID0gcDFzaGlwNDtcbiAgICBwMUdhbWVib2FyZC5ib2FyZFszXVsxXSA9IHAxc2hpcDQ7XG4gICAgcDFHYW1lYm9hcmQuYm9hcmRbM11bMl0gPSBwMXNoaXA0O1xuICAgIHAxR2FtZWJvYXJkLmJvYXJkWzNdWzNdID0gcDFzaGlwNDtcbiAgICBjb25zdCBwMXNoaXA1ID0gU2hpcCg1KTtcbiAgICBwMXNoaXA1LmNvb3Jkcy5wdXNoKFs0LCAwXSk7XG4gICAgcDFzaGlwNS5jb29yZHMucHVzaChbNCwgMV0pO1xuICAgIHAxc2hpcDUuY29vcmRzLnB1c2goWzQsIDJdKTtcbiAgICBwMXNoaXA1LmNvb3Jkcy5wdXNoKFs0LCAzXSk7XG4gICAgcDFzaGlwNS5jb29yZHMucHVzaChbNCwgNF0pO1xuICAgIHAxR2FtZWJvYXJkLmJvYXJkWzRdWzBdID0gcDFzaGlwNTtcbiAgICBwMUdhbWVib2FyZC5ib2FyZFs0XVsxXSA9IHAxc2hpcDU7XG4gICAgcDFHYW1lYm9hcmQuYm9hcmRbNF1bMl0gPSBwMXNoaXA1O1xuICAgIHAxR2FtZWJvYXJkLmJvYXJkWzRdWzNdID0gcDFzaGlwNTtcbiAgICBwMUdhbWVib2FyZC5ib2FyZFs0XVs0XSA9IHAxc2hpcDU7XG4gICAgcDFHYW1lYm9hcmQuY3VycmVudFNoaXBzLnB1c2gocDFzaGlwMik7XG4gICAgcDFHYW1lYm9hcmQuY3VycmVudFNoaXBzLnB1c2gocDFzaGlwM2EpO1xuICAgIHAxR2FtZWJvYXJkLmN1cnJlbnRTaGlwcy5wdXNoKHAxc2hpcDNiKTtcbiAgICBwMUdhbWVib2FyZC5jdXJyZW50U2hpcHMucHVzaChwMXNoaXA0KTtcbiAgICBwMUdhbWVib2FyZC5jdXJyZW50U2hpcHMucHVzaChwMXNoaXA1KTtcbiAgfTtcblxuICBjb25zdCBzZXRVcFBsYXllclR3b1NoaXBzID0gZnVuY3Rpb24gKCkge1xuICAgIGNvbnN0IHAyc2hpcDIgPSBTaGlwKDIpO1xuICAgIHAyc2hpcDIuY29vcmRzLnB1c2goWzAsIDBdKTtcbiAgICBwMnNoaXAyLmNvb3Jkcy5wdXNoKFswLCAxXSk7XG4gICAgcDJHYW1lYm9hcmQuYm9hcmRbMF1bMF0gPSBwMnNoaXAyO1xuICAgIHAyR2FtZWJvYXJkLmJvYXJkWzBdWzFdID0gcDJzaGlwMjtcbiAgICBjb25zdCBwMnNoaXAzYSA9IFNoaXAoMyk7XG4gICAgcDJzaGlwM2EuY29vcmRzLnB1c2goWzEsIDBdKTtcbiAgICBwMnNoaXAzYS5jb29yZHMucHVzaChbMSwgMV0pO1xuICAgIHAyc2hpcDNhLmNvb3Jkcy5wdXNoKFsxLCAyXSk7XG4gICAgcDJHYW1lYm9hcmQuYm9hcmRbMV1bMF0gPSBwMnNoaXAzYTtcbiAgICBwMkdhbWVib2FyZC5ib2FyZFsxXVsxXSA9IHAyc2hpcDNhO1xuICAgIHAyR2FtZWJvYXJkLmJvYXJkWzFdWzJdID0gcDJzaGlwM2E7XG4gICAgY29uc3QgcDJzaGlwM2IgPSBTaGlwKDMpO1xuICAgIHAyc2hpcDNiLmNvb3Jkcy5wdXNoKFsyLCAwXSk7XG4gICAgcDJzaGlwM2IuY29vcmRzLnB1c2goWzIsIDFdKTtcbiAgICBwMnNoaXAzYi5jb29yZHMucHVzaChbMiwgMl0pO1xuICAgIHAyR2FtZWJvYXJkLmJvYXJkWzJdWzBdID0gcDJzaGlwM2I7XG4gICAgcDJHYW1lYm9hcmQuYm9hcmRbMl1bMV0gPSBwMnNoaXAzYjtcbiAgICBwMkdhbWVib2FyZC5ib2FyZFsyXVsyXSA9IHAyc2hpcDNiO1xuICAgIGNvbnN0IHAyc2hpcDQgPSBTaGlwKDQpO1xuICAgIHAyc2hpcDQuY29vcmRzLnB1c2goWzMsIDBdKTtcbiAgICBwMnNoaXA0LmNvb3Jkcy5wdXNoKFszLCAxXSk7XG4gICAgcDJzaGlwNC5jb29yZHMucHVzaChbMywgMl0pO1xuICAgIHAyc2hpcDQuY29vcmRzLnB1c2goWzMsIDNdKTtcbiAgICBwMkdhbWVib2FyZC5ib2FyZFszXVswXSA9IHAyc2hpcDQ7XG4gICAgcDJHYW1lYm9hcmQuYm9hcmRbM11bMV0gPSBwMnNoaXA0O1xuICAgIHAyR2FtZWJvYXJkLmJvYXJkWzNdWzJdID0gcDJzaGlwNDtcbiAgICBwMkdhbWVib2FyZC5ib2FyZFszXVszXSA9IHAyc2hpcDQ7XG4gICAgY29uc3QgcDJzaGlwNSA9IFNoaXAoNSk7XG4gICAgcDJzaGlwNS5jb29yZHMucHVzaChbNCwgMF0pO1xuICAgIHAyc2hpcDUuY29vcmRzLnB1c2goWzQsIDFdKTtcbiAgICBwMnNoaXA1LmNvb3Jkcy5wdXNoKFs0LCAyXSk7XG4gICAgcDJzaGlwNS5jb29yZHMucHVzaChbNCwgM10pO1xuICAgIHAyc2hpcDUuY29vcmRzLnB1c2goWzQsIDRdKTtcbiAgICBwMkdhbWVib2FyZC5ib2FyZFs0XVswXSA9IHAyc2hpcDU7XG4gICAgcDJHYW1lYm9hcmQuYm9hcmRbNF1bMV0gPSBwMnNoaXA1O1xuICAgIHAyR2FtZWJvYXJkLmJvYXJkWzRdWzJdID0gcDJzaGlwNTtcbiAgICBwMkdhbWVib2FyZC5ib2FyZFs0XVszXSA9IHAyc2hpcDU7XG4gICAgcDJHYW1lYm9hcmQuYm9hcmRbNF1bNF0gPSBwMnNoaXA1O1xuXG4gICAgcDJHYW1lYm9hcmQuY3VycmVudFNoaXBzLnB1c2gocDJzaGlwMik7XG4gICAgcDJHYW1lYm9hcmQuY3VycmVudFNoaXBzLnB1c2gocDJzaGlwM2EpO1xuICAgIHAyR2FtZWJvYXJkLmN1cnJlbnRTaGlwcy5wdXNoKHAyc2hpcDNiKTtcbiAgICBwMkdhbWVib2FyZC5jdXJyZW50U2hpcHMucHVzaChwMnNoaXA0KTtcbiAgICBwMkdhbWVib2FyZC5jdXJyZW50U2hpcHMucHVzaChwMnNoaXA1KTtcbiAgfTtcblxuICBjb25zdCByZWNlaXZlQXR0YWNrID0gZnVuY3Rpb24gKGNvb3Jkcywgc3F1YXJlLCBib2FyZCwgcG90ZW50aWFsTW92ZXMpIHtcbiAgICBsZXQgc2hpcCA9IGJvYXJkW2Nvb3Jkc1sxXV1bY29vcmRzWzBdXTsgLy8geCBhbmQgeSBtdXN0IGJlIHN3YXBwZWQgZm9yIGdhbWUgYm9hcmRcblxuICAgIC8vIGlmIG5vdCBhIGxlZ2FsIG1vdmUsIHJldHJ5XG4gICAgY29uc29sZS5sb2coYGNvb3JkcyA9ICR7Y29vcmRzfWApO1xuICAgIGlmIChtYXRjaE1vdmUocG90ZW50aWFsTW92ZXMsIGNvb3JkcykgPT0gZmFsc2UpIHtcbiAgICAgIGNvbnNvbGUubG9nKFwiUmV0cnkgYnJvXCIpO1xuICAgIH0gZWxzZSB7XG4gICAgICBpZiAoc2hpcCA9PSBcIiBcIikge1xuICAgICAgICBpZiAoY3VycmVudFBsYXllciA9PSBwbGF5ZXJPbmUpIHtcbiAgICAgICAgICBwMkdhbWVib2FyZC5taXNzZWRDb29yZHMucHVzaChjb29yZHMpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHAxR2FtZWJvYXJkLm1pc3NlZENvb3Jkcy5wdXNoKGNvb3Jkcyk7XG4gICAgICAgIH1cbiAgICAgICAgY29uc29sZS5sb2coXCJtaXNzXCIpO1xuICAgICAgICBkaXNwbGF5TWlzcyhzcXVhcmUpO1xuICAgICAgICBzd2FwUGxheWVyKCk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBsZXQgc3dhcHBlZENvb3JkcyA9IFtdO1xuICAgICAgICBzd2FwcGVkQ29vcmRzLnB1c2goY29vcmRzWzFdKTtcbiAgICAgICAgc3dhcHBlZENvb3Jkcy5wdXNoKGNvb3Jkc1swXSk7XG4gICAgICAgIGlmIChtYXRjaE1vdmUoc2hpcC5jb29yZHMsIHN3YXBwZWRDb29yZHMpKSB7XG4gICAgICAgICAgc2hpcC5oaXQoKTtcbiAgICAgICAgICBkaXNwbGF5SGl0KHNxdWFyZSk7XG4gICAgICAgICAgc2hpcC5pc1N1bmsoKTtcbiAgICAgICAgICBpZiAoc2hpcC5pc1N1bmsoKSkge1xuICAgICAgICAgICAgc2hpcFN1bmsoc2hpcCk7XG4gICAgICAgICAgICBpZiAoY3VycmVudFBsYXllciA9PSBwbGF5ZXJPbmUpIHtcbiAgICAgICAgICAgICAgcDJHYW1lYm9hcmQuc3Vua1NoaXBzLnB1c2goc2hpcCk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICBwMUdhbWVib2FyZC5zdW5rU2hpcHMucHVzaChzaGlwKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgICAgLy8gYWxsU3VuaygpOyAvLyBhZGQgYmFjayBpblxuICAgICAgICAgIGNvbnNvbGUubG9nKFwiaGl0XCIpO1xuICAgICAgICAgIHN3YXBwZWRDb29yZHMgPSBbXTtcbiAgICAgICAgICBzd2FwUGxheWVyKCk7IC8vIHN3YXBcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgaWYgKG1hdGNoTW92ZShwb3RlbnRpYWxNb3ZlcywgY29vcmRzKSkge1xuICAgICAgICByZW1vdmVBbGxJbnN0YW5jZXMocG90ZW50aWFsTW92ZXMsIGNvb3Jkcyk7IC8vIG5lZWQgdG8gY29kZSB0aGlzXG4gICAgICB9XG4gICAgfVxuICB9O1xuXG4gIGZ1bmN0aW9uIHJlbW92ZUFsbEluc3RhbmNlcyhhcnIsIGl0ZW0pIHtcbiAgICBmb3IgKGxldCBpID0gYXJyLmxlbmd0aDsgaS0tOyApIHtcbiAgICAgIGlmIChhcnJbaV1bMF0gPT0gaXRlbVswXSAmJiBhcnJbaV1bMV0gPT0gaXRlbVsxXSkgYXJyLnNwbGljZShpLCAxKTtcbiAgICB9XG4gIH1cblxuICBjb25zdCBzaGlwU3VuayA9IGZ1bmN0aW9uIChzaGlwKSB7XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBzaGlwLmNvb3Jkcy5sZW5ndGg7IGkrKykge1xuICAgICAgbGV0IHggPSBzaGlwLmNvb3Jkc1tpXVsxXTtcbiAgICAgIGxldCB5ID0gc2hpcC5jb29yZHNbaV1bMF07XG4gICAgICBsZXQgc3F1YXJlID0gY29vcmRzVG9TcXVhcmUoW3gsIHldKTtcbiAgICAgIHNxdWFyZS5jbGFzc0xpc3QuYWRkKFwic3Vua1wiKTtcbiAgICB9XG4gIH07XG5cbiAgY29uc3QgY29vcmRzVG9TcXVhcmUgPSBmdW5jdGlvbiAoY29vcmRzKSB7XG4gICAgbGV0IGNvWCA9IGNvb3Jkc1swXTtcbiAgICBsZXQgY29ZID0gY29vcmRzWzFdO1xuICAgIGxldCBzcXVhcmVzID0gXCJcIjtcbiAgICBpZiAoY3VycmVudFBsYXllciA9PSBwbGF5ZXJUd28pIHtcbiAgICAgIHNxdWFyZXMgPSBkb2N1bWVudC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKFwiaW5kaXZpZHVhbC1zcXVhcmVcIik7XG4gICAgfSBlbHNlIHtcbiAgICAgIHNxdWFyZXMgPSBkb2N1bWVudC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKFwiY29tcHV0ZXItc3F1YXJlXCIpO1xuICAgIH1cbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IHNxdWFyZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgIGxldCByYW5kb21BdHRhY2tDb29yZHMgPSBjbGFzc1RvQ29vcmRzKHNxdWFyZXNbaV0pO1xuICAgICAgaWYgKGNvWCA9PSByYW5kb21BdHRhY2tDb29yZHNbMF0gJiYgY29ZID09IHJhbmRvbUF0dGFja0Nvb3Jkc1sxXSkge1xuICAgICAgICBsZXQgc3F1YXJlVG9BdHRhY2sgPSBzcXVhcmVzW2ldO1xuICAgICAgICBjb25zb2xlLmxvZyhzcXVhcmVUb0F0dGFjayk7XG4gICAgICAgIHJldHVybiBzcXVhcmVUb0F0dGFjaztcbiAgICAgIH1cbiAgICB9XG4gIH07XG5cbiAgY29uc3QgbWF0Y2hNb3ZlID0gZnVuY3Rpb24gKGFycmF5VG9GaW5kTWF0Y2gsIGNvb3Jkcykge1xuICAgIGxldCBtYXRjaCA9IGZhbHNlO1xuICAgIGFycmF5VG9GaW5kTWF0Y2guZm9yRWFjaCgobW92ZSkgPT4ge1xuICAgICAgaWYgKG1vdmVbMF0gPT0gY29vcmRzWzBdICYmIG1vdmVbMV0gPT0gY29vcmRzWzFdKSB7XG4gICAgICAgIC8vIGNvbnNvbGUubG9nKFwidHJ1ZVwiKTtcbiAgICAgICAgbWF0Y2ggPSB0cnVlO1xuICAgICAgfVxuICAgIH0pO1xuXG4gICAgaWYgKG1hdGNoID09IHRydWUpIHtcbiAgICAgIHJldHVybiB0cnVlO1xuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICB9O1xuXG4gIGNvbnN0IHNldFVwQ2xpY2tUb0hpdCA9IGZ1bmN0aW9uICgpIHtcbiAgICBsZXQgc3F1YXJlcyA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoXCJjb21wdXRlci1zcXVhcmVcIik7XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBzcXVhcmVzLmxlbmd0aDsgaSsrKSB7XG4gICAgICBzcXVhcmVzW2ldLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gICAgICAgIHJlY2VpdmVBdHRhY2soXG4gICAgICAgICAgY2xhc3NUb0Nvb3JkcyhzcXVhcmVzW2ldKSxcbiAgICAgICAgICBzcXVhcmVzW2ldLFxuICAgICAgICAgIHAyR2FtZWJvYXJkLmJvYXJkLFxuICAgICAgICAgIHAyR2FtZWJvYXJkLnBvdGVudGlhbE1vdmVzXG4gICAgICAgICk7XG4gICAgICB9KTtcbiAgICB9XG4gIH07XG5cbiAgY29uc3QgZGlzcGxheUhpdCA9IGZ1bmN0aW9uIChzcXVhcmUpIHtcbiAgICBzcXVhcmUuY2xhc3NMaXN0LmFkZChcImhpdFwiKTtcbiAgfTtcblxuICBjb25zdCBkaXNwbGF5TWlzcyA9IGZ1bmN0aW9uIChzcXVhcmUpIHtcbiAgICBzcXVhcmUuY2xhc3NMaXN0LmFkZChcIm1pc3NcIik7XG4gIH07XG5cbiAgY29uc3QgZGlzYWJsZUNsaWNrID0gZnVuY3Rpb24gKCkge1xuICAgIGxldCBzcXVhcmVzID0gZG9jdW1lbnQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZShcImNvbXB1dGVyLXNxdWFyZVwiKTtcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IHNxdWFyZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgIHNxdWFyZXNbaV0uY2xhc3NMaXN0LmFkZChcImRpc2FibGVkXCIpO1xuICAgIH1cbiAgfTtcblxuICBjb25zdCBlbmFibGVDbGljayA9IGZ1bmN0aW9uICgpIHtcbiAgICBsZXQgc3F1YXJlcyA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoXCJjb21wdXRlci1zcXVhcmVcIik7XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBzcXVhcmVzLmxlbmd0aDsgaSsrKSB7XG4gICAgICBzcXVhcmVzW2ldLmNsYXNzTGlzdC5yZW1vdmUoXCJkaXNhYmxlZFwiKTtcbiAgICB9XG4gIH07XG5cbiAgY29uc3Qgc3dhcFBsYXllciA9IGZ1bmN0aW9uICgpIHtcbiAgICBpZiAoY3VycmVudFBsYXllciA9PSBwbGF5ZXJPbmUpIHtcbiAgICAgIGRpc2FibGVDbGljaygpO1xuICAgICAgY3VycmVudFBsYXllciA9IHBsYXllclR3bztcbiAgICAgIGxldCByYW5kb21Db29yZHMgPSBjdXJyZW50UGxheWVyLnJhbmRvbUF0dGFjayhwMUdhbWVib2FyZCk7XG4gICAgICBsZXQgc3F1YXJlID0gY29vcmRzVG9TcXVhcmUocmFuZG9tQ29vcmRzKTtcblxuICAgICAgcmVjZWl2ZUF0dGFjayhcbiAgICAgICAgcmFuZG9tQ29vcmRzLFxuICAgICAgICBzcXVhcmUsXG4gICAgICAgIHAxR2FtZWJvYXJkLmJvYXJkLFxuICAgICAgICBwMUdhbWVib2FyZC5wb3RlbnRpYWxNb3Zlc1xuICAgICAgKTtcbiAgICB9IGVsc2Uge1xuICAgICAgZW5hYmxlQ2xpY2soKTtcbiAgICAgIGN1cnJlbnRQbGF5ZXIgPSBwbGF5ZXJPbmU7XG4gICAgfVxuICAgIGNvbnNvbGUubG9nKFwic3dhcFwiKTtcbiAgICBjb25zb2xlLmxvZyhjdXJyZW50UGxheWVyKTtcbiAgfTtcblxuICBjb25zdCBjbGFzc1RvQ29vcmRzID0gZnVuY3Rpb24gKGluZGl2aWR1YWxTcXVhcmUpIHtcbiAgICBsZXQgY2xhc3NlcyA9IGluZGl2aWR1YWxTcXVhcmUuY2xhc3NMaXN0O1xuICAgIGxldCB4ID0gY2xhc3Nlc1sxXTtcbiAgICBsZXQgeSA9IFwib29wc1wiOyAvLyB0byBzdG9wIGVycm9yc1xuICAgIGxldCB0ZW1wID0gcGFyc2VJbnQoY2xhc3Nlc1syXSk7XG4gICAgaWYgKHBhcnNlSW50KGNsYXNzZXNbMl0pID49IDApIHtcbiAgICAgIHkgPSBjbGFzc2VzWzJdO1xuICAgIH0gZWxzZSB7XG4gICAgICB5ID0gY2xhc3Nlc1sxXTtcbiAgICB9XG4gICAgcmV0dXJuIFt4LCB5XTtcbiAgfTtcblxuICBjb25zdCBzZXRVcEdhbWUgPSBmdW5jdGlvbiAoKSB7XG4gICAgc2V0VXBQbGF5ZXJPbmVTaGlwcygpO1xuICAgIHNldFVwUGxheWVyVHdvU2hpcHMoKTtcbiAgICBwMUdhbWVib2FyZC5kcmF3Qm9hcmQoKTtcbiAgICBwMkdhbWVib2FyZC5kcmF3Q29tcHV0ZXJCb2FyZCgpO1xuICAgIHNldFVwQ2xpY2tUb0hpdCgpO1xuICB9O1xuXG4gIHJldHVybiB7IHNldFVwR2FtZSwgcDFHYW1lYm9hcmQsIHAyR2FtZWJvYXJkIH07XG59O1xuXG5leHBvcnQgeyBHYW1lIH07XG4iLCJpbXBvcnQgeyBTaGlwIH0gZnJvbSBcIi4vc2hpcFwiO1xuaW1wb3J0IHsgR2FtZUJvYXJkIH0gZnJvbSBcIi4vZ2FtZUJvYXJkXCI7XG5pbXBvcnQgeyBQbGF5ZXIgfSBmcm9tIFwiLi9wbGF5ZXJcIjtcbmltcG9ydCB7IEdhbWUgfSBmcm9tIFwiLi9nYW1lXCI7XG5cbi8vIGNvbnN0IGdiMSA9IEdhbWVCb2FyZCgpO1xuLy8gY29uc3QgZ2IyID0gR2FtZUJvYXJkKCk7XG5cbi8vIC8vIGNvbnN0IGdhbWUgPSBHYW1lKCk7XG4vLyAvLyBjb25zdCBwbGF5ZXIgPSBQbGF5ZXIoKTtcbi8vIC8vIGNvbnN0IHNoaXAgPSBTaGlwKCk7XG4vLyAvLyBzaGlwLmNvb3Jkcy5wdXNoKFswLCAxXSk7XG4vLyAvLyBnYi5nZXRQb3RlbnRpYWxNb3ZlcygpO1xuLy8gLy8gbGV0IG1vdmVzID0gZ2IucG90ZW50aWFsTW92ZXM7XG4vLyAvLyBjb25zb2xlLmxvZyhnYi5wb3RlbnRpYWxNb3Zlcy5sZW5ndGgpIDtcbi8vIC8vIGdiLnJlY2VpdmVBdHRhY2soc2hpcCwgWzAsIDNdKTtcbi8vIC8vIGNvbnNvbGUubG9nKGdiLnBvdGVudGlhbE1vdmVzLmxlbmd0aCk7XG4vLyBnYjEuZHJhd0JvYXJkKCk7XG4vLyBnYjIuZHJhd0JvYXJkKCk7XG5jb25zdCBnYW1lID0gR2FtZSgpO1xuZ2FtZS5zZXRVcEdhbWUoKTtcblxuLy8gZ2FtZS5wMUdhbWVib2FyZC5kcmF3Qm9hcmQoKTtcbi8vIGdhbWUucDJHYW1lYm9hcmQuZHJhd0NvbXB1dGVyQm9hcmQoKTtcbi8vIGdhbWUucDFHYW1lYm9hcmQuc2V0VXBDbGlja1RvSGl0KCk7XG4vLyBnYW1lLnAyR2FtZWJvYXJkLnNldFVwQ2xpY2tUb0hpdCgpO1xuIl0sIm5hbWVzIjpbIlNoaXAiLCJsZW5ndGgiLCJudW1iZXJPZkhpdHMiLCJzdW5rIiwic2hpcExlbmd0aCIsImlzU3VuayIsImhpdCIsImNvb3JkcyIsIkdhbWVCb2FyZCIsInBsYXllck9uZSIsInBsYXllclR3byIsInN1bmtTaGlwcyIsInBvdGVudGlhbE1vdmVzIiwiYm9hcmQiLCJob3Jpem9udGFsIiwic2hpcCIsInN0YXJ0Um93Q29vcmRzIiwic3RhcnRDb2x1bW5Db29yZHMiLCJpIiwiY3VycmVudENvb3JkIiwicHVzaCIsInZlcnRpY2FsIiwibWlzc2VkQ29vcmRzIiwiY3VycmVudFNoaXBzIiwiYWxsU3VuayIsImFsZXJ0IiwiZ2V0UG90ZW50aWFsTW92ZXMiLCJhIiwiZHJhd0JvYXJkIiwiY29udGFpbmVyIiwiZG9jdW1lbnQiLCJnZXRFbGVtZW50c0J5Q2xhc3NOYW1lIiwiYm9hcmRDb250YWluZXIiLCJjcmVhdGVFbGVtZW50IiwiY2xhc3NMaXN0IiwiYWRkIiwiYXBwZW5kQ2hpbGQiLCJpbmRpdmlkdWFsU3F1YXJlIiwiZHJhd0NvbXB1dGVyQm9hcmQiLCJQbGF5ZXIiLCJsZWdhbE1vdmVzIiwicmFuZG9tQXR0YWNrIiwib3Bwb25lbnRHYW1lYm9hcmQiLCJjb25zb2xlIiwibG9nIiwicmFuZG9tSW5kZXgiLCJtYXgiLCJNYXRoIiwiZmxvb3IiLCJyYW5kb20iLCJuYW1lIiwiZ2V0TGVnYWxNb3ZlcyIsImNoZWNrTWlzc2VkQ29vcmRzRm9yTWF0Y2giLCJvcHBvbmVudEdhbWVib2FyZE1pc3NlZENvb3Jkc0FycmF5IiwibWF0Y2giLCJhdmFpbGFibGVNb3ZlcyIsInAxR2FtZWJvYXJkIiwicDJHYW1lYm9hcmQiLCJjdXJyZW50UGxheWVyIiwicmVjZWl2ZUF0dGFjayIsInNxdWFyZSIsIm1hdGNoTW92ZSIsImRpc3BsYXlNaXNzIiwic3dhcFBsYXllciIsInN3YXBwZWRDb29yZHMiLCJkaXNwbGF5SGl0Iiwic2hpcFN1bmsiLCJhcnIiLCJpdGVtIiwic3BsaWNlIiwicmVtb3ZlQWxsSW5zdGFuY2VzIiwieCIsInkiLCJjb29yZHNUb1NxdWFyZSIsImNvWCIsImNvWSIsInNxdWFyZXMiLCJyYW5kb21BdHRhY2tDb29yZHMiLCJjbGFzc1RvQ29vcmRzIiwic3F1YXJlVG9BdHRhY2siLCJhcnJheVRvRmluZE1hdGNoIiwiZm9yRWFjaCIsIm1vdmUiLCJkaXNhYmxlQ2xpY2siLCJyYW5kb21Db29yZHMiLCJyZW1vdmUiLCJlbmFibGVDbGljayIsImNsYXNzZXMiLCJwYXJzZUludCIsInNldFVwR2FtZSIsInAxc2hpcDIiLCJwMXNoaXAzYSIsInAxc2hpcDNiIiwicDFzaGlwNCIsInAxc2hpcDUiLCJzZXRVcFBsYXllck9uZVNoaXBzIiwicDJzaGlwMiIsInAyc2hpcDNhIiwicDJzaGlwM2IiLCJwMnNoaXA0IiwicDJzaGlwNSIsInNldFVwUGxheWVyVHdvU2hpcHMiLCJhZGRFdmVudExpc3RlbmVyIiwic2V0VXBDbGlja1RvSGl0IiwiR2FtZSJdLCJzb3VyY2VSb290IjoiIn0=